; generated by ARM C/C++ Compiler, 4.1 [Build 791]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\Output\bsp_sd.o --asm_dir=.\Listing\ --list_dir=.\Listing\ --depend=.\Output\bsp_sd.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\BSP -I..\BSP\UCOS-II -I..\BSP\STM32F2xx\inc -I..\BSP\CMSIS -I..\BSP\CMSIS\Device_Support -I..\BSP\UCOS-II -I..\..\uC-CPU -I..\..\uC-CPU\ARM-Cortex-M3 -I..\..\uC-LIB -I..\..\uC-LIB\Ports\ARM-Cortex-M3 -I..\..\uCOS-II\Source -I..\..\uCOS-II\Ports\ARM-Cortex-M3 -I..\App -I..\Prj -ID:\Keil\ARM\CMSIS\Include -ID:\Keil\ARM\INC\ST\STM32F2xx -DUSE_STDPERIPH_DRIVER -DDEBUG -DLJB_CPU_MAIN -DUSE_CPU_F205RC --omf_browse=.\Output\bsp_sd.crf ..\BSP\bsp_sd.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  SD_DeInit PROC
;;;388      */
;;;389    void SD_DeInit(void)
000000  b510              PUSH     {r4,lr}
;;;390    { 
;;;391      SD_LowLevel_DeInit();
000002  f7fffffe          BL       SD_LowLevel_DeInit
;;;392    }
000006  bd10              POP      {r4,pc}
;;;393    
                          ENDP

                  CmdResp1Error PROC
;;;2016     */
;;;2017   /*static*/ SD_Error CmdResp1Error(uint8_t cmd)
000008  4601              MOV      r1,r0
;;;2018   {
;;;2019     while (!(SDIO->STA & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
00000a  bf00              NOP      
                  |L1.12|
00000c  48fc              LDR      r0,|L1.1024|
00000e  6800              LDR      r0,[r0,#0]
000010  f0100f45          TST      r0,#0x45
000014  d0fa              BEQ      |L1.12|
;;;2020     {
;;;2021     }
;;;2022   
;;;2023     SDIO->ICR = SDIO_STATIC_FLAGS;
000016  f24050ff          MOV      r0,#0x5ff
00001a  4afa              LDR      r2,|L1.1028|
00001c  6010              STR      r0,[r2,#0]
;;;2024   
;;;2025     return (SD_Error)(SDIO->RESP1 &  SD_OCR_ERRORBITS);
00001e  48fa              LDR      r0,|L1.1032|
000020  6800              LDR      r0,[r0,#0]
000022  f04f0208          MOV      r2,#8
000026  ea000002          AND      r0,r0,r2
00002a  b2c0              UXTB     r0,r0
;;;2026   }
00002c  4770              BX       lr
;;;2027   
                          ENDP

                  FindSCR PROC
;;;2440     */
;;;2441   static SD_Error FindSCR(uint16_t rca, uint32_t *pscr)
00002e  e92d41fc          PUSH     {r2-r8,lr}
;;;2442   {
000032  4607              MOV      r7,r0
000034  460d              MOV      r5,r1
;;;2443     uint32_t index = 0;
000036  f04f0600          MOV      r6,#0
;;;2444     SD_Error errorstatus = SD_OK;
00003a  4634              MOV      r4,r6
;;;2445     uint32_t tempscr[2] = {0, 0};
00003c  4620              MOV      r0,r4
00003e  9000              STR      r0,[sp,#0]
000040  9001              STR      r0,[sp,#4]
;;;2446   
;;;2447     /*!< Set Block Size To 8 Bytes */
;;;2448     /*!< Send CMD55 APP_CMD with argument as card's RCA */
;;;2449     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)8;
000042  f04f0008          MOV      r0,#8
000046  49f1              LDR      r1,|L1.1036|
000048  6008              STR      r0,[r1,#0]  ; SDIO_CmdInitStructure
;;;2450     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
00004a  f04f0010          MOV      r0,#0x10
00004e  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;2451     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
000050  f04f0040          MOV      r0,#0x40
000054  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;2452     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
000056  f04f0000          MOV      r0,#0
00005a  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;2453     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
00005c  f44f6080          MOV      r0,#0x400
000060  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;2454     SDIO_SendCommand(&SDIO_CmdInitStructure);
000062  4608              MOV      r0,r1
000064  f7fffffe          BL       SDIO_SendCommand
;;;2455   
;;;2456     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
000068  2010              MOVS     r0,#0x10
00006a  f7fffffe          BL       CmdResp1Error
00006e  4604              MOV      r4,r0
;;;2457   
;;;2458     if (errorstatus != SD_OK)
000070  b114              CBZ      r4,|L1.120|
;;;2459     {
;;;2460       return(errorstatus);
000072  4620              MOV      r0,r4
                  |L1.116|
;;;2461     }
;;;2462   
;;;2463     /*!< Send CMD55 APP_CMD with argument as card's RCA */
;;;2464     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
;;;2465     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;2466     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2467     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2468     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2469     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2470   
;;;2471     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;2472   
;;;2473     if (errorstatus != SD_OK)
;;;2474     {
;;;2475       return(errorstatus);
;;;2476     }
;;;2477     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
;;;2478     SDIO_DataInitStructure.SDIO_DataLength = 8;
;;;2479     SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_8b;
;;;2480     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
;;;2481     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
;;;2482     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
;;;2483     SDIO_DataConfig(&SDIO_DataInitStructure);
;;;2484   
;;;2485   
;;;2486     /*!< Send ACMD51 SD_APP_SEND_SCR with argument as 0 */
;;;2487     SDIO_CmdInitStructure.SDIO_Argument = 0x0;
;;;2488     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_SEND_SCR;
;;;2489     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2490     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2491     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2492     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2493   
;;;2494     errorstatus = CmdResp1Error(SD_CMD_SD_APP_SEND_SCR);
;;;2495   
;;;2496     if (errorstatus != SD_OK)
;;;2497     {
;;;2498       return(errorstatus);
;;;2499     }
;;;2500   
;;;2501     while (!(SDIO->STA & (SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCKEND | SDIO_FLAG_STBITERR)))
;;;2502     {
;;;2503       if (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
;;;2504       {
;;;2505         *(tempscr + index) = SDIO_ReadData();
;;;2506         index++;
;;;2507       }
;;;2508     }
;;;2509   
;;;2510     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
;;;2511     {
;;;2512       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
;;;2513       errorstatus = SD_DATA_TIMEOUT;
;;;2514       return(errorstatus);
;;;2515     }
;;;2516     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
;;;2517     {
;;;2518       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
;;;2519       errorstatus = SD_DATA_CRC_FAIL;
;;;2520       return(errorstatus);
;;;2521     }
;;;2522     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
;;;2523     {
;;;2524       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
;;;2525       errorstatus = SD_RX_OVERRUN;
;;;2526       return(errorstatus);
;;;2527     }
;;;2528     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
;;;2529     {
;;;2530       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
;;;2531       errorstatus = SD_START_BIT_ERR;
;;;2532       return(errorstatus);
;;;2533     }
;;;2534   
;;;2535     /*!< Clear all the static flags */
;;;2536     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;2537   
;;;2538     *(pscr + 1) = ((tempscr[0] & SD_0TO7BITS) << 24) | ((tempscr[0] & SD_8TO15BITS) << 8) | ((tempscr[0] & SD_16TO23BITS) >> 8) | ((tempscr[0] & SD_24TO31BITS) >> 24);
;;;2539   
;;;2540     *(pscr) = ((tempscr[1] & SD_0TO7BITS) << 24) | ((tempscr[1] & SD_8TO15BITS) << 8) | ((tempscr[1] & SD_16TO23BITS) >> 8) | ((tempscr[1] & SD_24TO31BITS) >> 24);
;;;2541   
;;;2542     return(errorstatus);
;;;2543   }
000074  e8bd81fc          POP      {r2-r8,pc}
                  |L1.120|
000078  48e5              LDR      r0,|L1.1040|
00007a  6800              LDR      r0,[r0,#0]            ;2464  ; RCA
00007c  ea4f4000          LSL      r0,r0,#16             ;2464
000080  49e2              LDR      r1,|L1.1036|
000082  6008              STR      r0,[r1,#0]            ;2464  ; SDIO_CmdInitStructure
000084  f04f0037          MOV      r0,#0x37              ;2465
000088  6048              STR      r0,[r1,#4]            ;2465  ; SDIO_CmdInitStructure
00008a  f04f0040          MOV      r0,#0x40              ;2466
00008e  6088              STR      r0,[r1,#8]            ;2466  ; SDIO_CmdInitStructure
000090  f04f0000          MOV      r0,#0                 ;2467
000094  60c8              STR      r0,[r1,#0xc]          ;2467  ; SDIO_CmdInitStructure
000096  f44f6080          MOV      r0,#0x400             ;2468
00009a  6108              STR      r0,[r1,#0x10]         ;2468  ; SDIO_CmdInitStructure
00009c  4608              MOV      r0,r1                 ;2469
00009e  f7fffffe          BL       SDIO_SendCommand
0000a2  2037              MOVS     r0,#0x37              ;2471
0000a4  f7fffffe          BL       CmdResp1Error
0000a8  4604              MOV      r4,r0                 ;2471
0000aa  b10c              CBZ      r4,|L1.176|
0000ac  4620              MOV      r0,r4                 ;2475
0000ae  e7e1              B        |L1.116|
                  |L1.176|
0000b0  f04f30ff          MOV      r0,#0xffffffff        ;2477
0000b4  49d7              LDR      r1,|L1.1044|
0000b6  6008              STR      r0,[r1,#0]            ;2477  ; SDIO_DataInitStructure
0000b8  f04f0008          MOV      r0,#8                 ;2478
0000bc  6048              STR      r0,[r1,#4]            ;2478  ; SDIO_DataInitStructure
0000be  f04f0030          MOV      r0,#0x30              ;2479
0000c2  6088              STR      r0,[r1,#8]            ;2479  ; SDIO_DataInitStructure
0000c4  f04f0002          MOV      r0,#2                 ;2480
0000c8  60c8              STR      r0,[r1,#0xc]          ;2480  ; SDIO_DataInitStructure
0000ca  f04f0000          MOV      r0,#0                 ;2481
0000ce  6108              STR      r0,[r1,#0x10]         ;2481  ; SDIO_DataInitStructure
0000d0  f04f0001          MOV      r0,#1                 ;2482
0000d4  6148              STR      r0,[r1,#0x14]         ;2482  ; SDIO_DataInitStructure
0000d6  4608              MOV      r0,r1                 ;2483
0000d8  f7fffffe          BL       SDIO_DataConfig
0000dc  f04f0000          MOV      r0,#0                 ;2487
0000e0  49ca              LDR      r1,|L1.1036|
0000e2  6008              STR      r0,[r1,#0]            ;2487  ; SDIO_CmdInitStructure
0000e4  f04f0033          MOV      r0,#0x33              ;2488
0000e8  6048              STR      r0,[r1,#4]            ;2488  ; SDIO_CmdInitStructure
0000ea  f04f0040          MOV      r0,#0x40              ;2489
0000ee  6088              STR      r0,[r1,#8]            ;2489  ; SDIO_CmdInitStructure
0000f0  f04f0000          MOV      r0,#0                 ;2490
0000f4  60c8              STR      r0,[r1,#0xc]          ;2490  ; SDIO_CmdInitStructure
0000f6  f44f6080          MOV      r0,#0x400             ;2491
0000fa  6108              STR      r0,[r1,#0x10]         ;2491  ; SDIO_CmdInitStructure
0000fc  4608              MOV      r0,r1                 ;2492
0000fe  f7fffffe          BL       SDIO_SendCommand
000102  2033              MOVS     r0,#0x33              ;2494
000104  f7fffffe          BL       CmdResp1Error
000108  4604              MOV      r4,r0                 ;2494
00010a  b10c              CBZ      r4,|L1.272|
00010c  4620              MOV      r0,r4                 ;2498
00010e  e7b1              B        |L1.116|
                  |L1.272|
000110  e00a              B        |L1.296|
                  |L1.274|
000112  f44f1000          MOV      r0,#0x200000          ;2503
000116  f7fffffe          BL       SDIO_GetFlagStatus
00011a  b128              CBZ      r0,|L1.296|
00011c  f7fffffe          BL       SDIO_ReadData
000120  f84d0026          STR      r0,[sp,r6,LSL #2]     ;2505
000124  f1060601          ADD      r6,r6,#1              ;2506
                  |L1.296|
000128  48b5              LDR      r0,|L1.1024|
00012a  6800              LDR      r0,[r0,#0]            ;2501
00012c  f240612a          MOV      r1,#0x62a             ;2501
000130  4208              TST      r0,r1                 ;2501
000132  d0ee              BEQ      |L1.274|
000134  2008              MOVS     r0,#8                 ;2510
000136  f7fffffe          BL       SDIO_GetFlagStatus
00013a  b130              CBZ      r0,|L1.330|
00013c  2008              MOVS     r0,#8                 ;2512
00013e  f7fffffe          BL       SDIO_ClearFlag
000142  f04f0404          MOV      r4,#4                 ;2513
000146  4620              MOV      r0,r4                 ;2514
000148  e794              B        |L1.116|
                  |L1.330|
00014a  2002              MOVS     r0,#2                 ;2516
00014c  f7fffffe          BL       SDIO_GetFlagStatus
000150  b130              CBZ      r0,|L1.352|
000152  2002              MOVS     r0,#2                 ;2518
000154  f7fffffe          BL       SDIO_ClearFlag
000158  f04f0402          MOV      r4,#2                 ;2519
00015c  4620              MOV      r0,r4                 ;2520
00015e  e789              B        |L1.116|
                  |L1.352|
000160  2020              MOVS     r0,#0x20              ;2522
000162  f7fffffe          BL       SDIO_GetFlagStatus
000166  b130              CBZ      r0,|L1.374|
000168  2020              MOVS     r0,#0x20              ;2524
00016a  f7fffffe          BL       SDIO_ClearFlag
00016e  f04f0406          MOV      r4,#6                 ;2525
000172  4620              MOV      r0,r4                 ;2526
000174  e77e              B        |L1.116|
                  |L1.374|
000176  f44f7000          MOV      r0,#0x200             ;2528
00017a  f7fffffe          BL       SDIO_GetFlagStatus
00017e  b138              CBZ      r0,|L1.400|
000180  f44f7000          MOV      r0,#0x200             ;2530
000184  f7fffffe          BL       SDIO_ClearFlag
000188  f04f0407          MOV      r4,#7                 ;2531
00018c  4620              MOV      r0,r4                 ;2532
00018e  e771              B        |L1.116|
                  |L1.400|
000190  f24050ff          MOV      r0,#0x5ff             ;2536
000194  f7fffffe          BL       SDIO_ClearFlag
000198  9800              LDR      r0,[sp,#0]            ;2538
00019a  ea4f6000          LSL      r0,r0,#24             ;2538
00019e  9900              LDR      r1,[sp,#0]            ;2538
0001a0  f401417f          AND      r1,r1,#0xff00         ;2538
0001a4  ea402001          ORR      r0,r0,r1,LSL #8       ;2538
0001a8  9900              LDR      r1,[sp,#0]            ;2538
0001aa  f401017f          AND      r1,r1,#0xff0000       ;2538
0001ae  ea402011          ORR      r0,r0,r1,LSR #8       ;2538
0001b2  9900              LDR      r1,[sp,#0]            ;2538
0001b4  ea406011          ORR      r0,r0,r1,LSR #24      ;2538
0001b8  6068              STR      r0,[r5,#4]            ;2538
0001ba  9801              LDR      r0,[sp,#4]            ;2540
0001bc  ea4f6000          LSL      r0,r0,#24             ;2540
0001c0  9901              LDR      r1,[sp,#4]            ;2540
0001c2  f401417f          AND      r1,r1,#0xff00         ;2540
0001c6  ea402001          ORR      r0,r0,r1,LSL #8       ;2540
0001ca  9901              LDR      r1,[sp,#4]            ;2540
0001cc  f401017f          AND      r1,r1,#0xff0000       ;2540
0001d0  ea402011          ORR      r0,r0,r1,LSR #8       ;2540
0001d4  9901              LDR      r1,[sp,#4]            ;2540
0001d6  ea406011          ORR      r0,r0,r1,LSR #24      ;2540
0001da  6028              STR      r0,[r5,#0]            ;2540
0001dc  4620              MOV      r0,r4                 ;2542
0001de  e749              B        |L1.116|
;;;2544   
                          ENDP

                  SDEnWideBus PROC
;;;2167     */
;;;2168   static SD_Error SDEnWideBus(FunctionalState NewState)
0001e0  b57c              PUSH     {r2-r6,lr}
;;;2169   {
0001e2  4605              MOV      r5,r0
;;;2170     SD_Error errorstatus = SD_OK;
0001e4  f04f0400          MOV      r4,#0
;;;2171   
;;;2172     uint32_t scr[2] = {0, 0};
0001e8  4620              MOV      r0,r4
0001ea  9000              STR      r0,[sp,#0]
0001ec  9001              STR      r0,[sp,#4]
;;;2173   
;;;2174     if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
0001ee  f7fffffe          BL       SDIO_GetResponse
0001f2  f0107f00          TST      r0,#0x2000000
0001f6  d003              BEQ      |L1.512|
;;;2175     {
;;;2176       errorstatus = SD_LOCK_UNLOCK_FAILED;
0001f8  f04f040e          MOV      r4,#0xe
;;;2177       return(errorstatus);
0001fc  4620              MOV      r0,r4
                  |L1.510|
;;;2178     }
;;;2179   
;;;2180     /*!< Get SCR Register */
;;;2181     errorstatus = FindSCR(RCA, scr);
;;;2182   
;;;2183     if (errorstatus != SD_OK)
;;;2184     {
;;;2185       return(errorstatus);
;;;2186     }
;;;2187   
;;;2188     /*!< If wide bus operation to be enabled */
;;;2189     if (NewState == ENABLE)
;;;2190     {
;;;2191       /*!< If requested card supports wide bus operation */
;;;2192       if ((scr[1] & SD_WIDE_BUS_SUPPORT) != SD_ALLZERO)
;;;2193       {
;;;2194         /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
;;;2195         SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
;;;2196         SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;2197         SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2198         SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2199         SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2200         SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2201   
;;;2202         errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;2203   
;;;2204         if (errorstatus != SD_OK)
;;;2205         {
;;;2206           return(errorstatus);
;;;2207         }
;;;2208   
;;;2209         /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
;;;2210         SDIO_CmdInitStructure.SDIO_Argument = 0x2;
;;;2211         SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
;;;2212         SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2213         SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2214         SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2215         SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2216   
;;;2217         errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
;;;2218   
;;;2219         if (errorstatus != SD_OK)
;;;2220         {
;;;2221           return(errorstatus);
;;;2222         }
;;;2223         return(errorstatus);
;;;2224       }
;;;2225       else
;;;2226       {
;;;2227         errorstatus = SD_REQUEST_NOT_APPLICABLE;
;;;2228         return(errorstatus);
;;;2229       }
;;;2230     }   /*!< If wide bus operation to be disabled */
;;;2231     else
;;;2232     {
;;;2233       /*!< If requested card supports 1 bit mode operation */
;;;2234       if ((scr[1] & SD_SINGLE_BUS_SUPPORT) != SD_ALLZERO)
;;;2235       {
;;;2236         /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
;;;2237         SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
;;;2238         SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;2239         SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2240         SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2241         SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2242         SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2243   
;;;2244   
;;;2245         errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;2246   
;;;2247         if (errorstatus != SD_OK)
;;;2248         {
;;;2249           return(errorstatus);
;;;2250         }
;;;2251   
;;;2252         /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
;;;2253         SDIO_CmdInitStructure.SDIO_Argument = 0x00;
;;;2254         SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
;;;2255         SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;2256         SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;2257         SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;2258         SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;2259   
;;;2260         errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
;;;2261   
;;;2262         if (errorstatus != SD_OK)
;;;2263         {
;;;2264           return(errorstatus);
;;;2265         }
;;;2266   
;;;2267         return(errorstatus);
;;;2268       }
;;;2269       else
;;;2270       {
;;;2271         errorstatus = SD_REQUEST_NOT_APPLICABLE;
;;;2272         return(errorstatus);
;;;2273       }
;;;2274     }
;;;2275   }
0001fe  bd7c              POP      {r2-r6,pc}
                  |L1.512|
000200  4669              MOV      r1,sp                 ;2181
000202  4883              LDR      r0,|L1.1040|
000204  6800              LDR      r0,[r0,#0]            ;2181  ; RCA
000206  b280              UXTH     r0,r0                 ;2181
000208  f7fffffe          BL       FindSCR
00020c  4604              MOV      r4,r0                 ;2181
00020e  b10c              CBZ      r4,|L1.532|
000210  4620              MOV      r0,r4                 ;2185
000212  e7f4              B        |L1.510|
                  |L1.532|
000214  2d01              CMP      r5,#1                 ;2189
000216  d13f              BNE      |L1.664|
000218  9801              LDR      r0,[sp,#4]            ;2192
00021a  f4102f80          TST      r0,#0x40000           ;2192
00021e  d037              BEQ      |L1.656|
000220  487b              LDR      r0,|L1.1040|
000222  6800              LDR      r0,[r0,#0]            ;2195  ; RCA
000224  ea4f4000          LSL      r0,r0,#16             ;2195
000228  4978              LDR      r1,|L1.1036|
00022a  6008              STR      r0,[r1,#0]            ;2195  ; SDIO_CmdInitStructure
00022c  f04f0037          MOV      r0,#0x37              ;2196
000230  6048              STR      r0,[r1,#4]            ;2196  ; SDIO_CmdInitStructure
000232  f04f0040          MOV      r0,#0x40              ;2197
000236  6088              STR      r0,[r1,#8]            ;2197  ; SDIO_CmdInitStructure
000238  f04f0000          MOV      r0,#0                 ;2198
00023c  60c8              STR      r0,[r1,#0xc]          ;2198  ; SDIO_CmdInitStructure
00023e  f44f6080          MOV      r0,#0x400             ;2199
000242  6108              STR      r0,[r1,#0x10]         ;2199  ; SDIO_CmdInitStructure
000244  4608              MOV      r0,r1                 ;2200
000246  f7fffffe          BL       SDIO_SendCommand
00024a  2037              MOVS     r0,#0x37              ;2202
00024c  f7fffffe          BL       CmdResp1Error
000250  4604              MOV      r4,r0                 ;2202
000252  b10c              CBZ      r4,|L1.600|
000254  4620              MOV      r0,r4                 ;2206
000256  e7d2              B        |L1.510|
                  |L1.600|
000258  f04f0002          MOV      r0,#2                 ;2210
00025c  496b              LDR      r1,|L1.1036|
00025e  6008              STR      r0,[r1,#0]            ;2210  ; SDIO_CmdInitStructure
000260  f04f0006          MOV      r0,#6                 ;2211
000264  6048              STR      r0,[r1,#4]            ;2211  ; SDIO_CmdInitStructure
000266  f04f0040          MOV      r0,#0x40              ;2212
00026a  6088              STR      r0,[r1,#8]            ;2212  ; SDIO_CmdInitStructure
00026c  f04f0000          MOV      r0,#0                 ;2213
000270  60c8              STR      r0,[r1,#0xc]          ;2213  ; SDIO_CmdInitStructure
000272  f44f6080          MOV      r0,#0x400             ;2214
000276  6108              STR      r0,[r1,#0x10]         ;2214  ; SDIO_CmdInitStructure
000278  4608              MOV      r0,r1                 ;2215
00027a  f7fffffe          BL       SDIO_SendCommand
00027e  2006              MOVS     r0,#6                 ;2217
000280  f7fffffe          BL       CmdResp1Error
000284  4604              MOV      r4,r0                 ;2217
000286  b10c              CBZ      r4,|L1.652|
000288  4620              MOV      r0,r4                 ;2221
00028a  e7b8              B        |L1.510|
                  |L1.652|
00028c  4620              MOV      r0,r4                 ;2223
00028e  e7b6              B        |L1.510|
                  |L1.656|
000290  f04f0425          MOV      r4,#0x25              ;2227
000294  4620              MOV      r0,r4                 ;2228
000296  e7b2              B        |L1.510|
                  |L1.664|
000298  9801              LDR      r0,[sp,#4]            ;2234
00029a  f4103f80          TST      r0,#0x10000           ;2234
00029e  d037              BEQ      |L1.784|
0002a0  485b              LDR      r0,|L1.1040|
0002a2  6800              LDR      r0,[r0,#0]            ;2237  ; RCA
0002a4  ea4f4000          LSL      r0,r0,#16             ;2237
0002a8  4958              LDR      r1,|L1.1036|
0002aa  6008              STR      r0,[r1,#0]            ;2237  ; SDIO_CmdInitStructure
0002ac  f04f0037          MOV      r0,#0x37              ;2238
0002b0  6048              STR      r0,[r1,#4]            ;2238  ; SDIO_CmdInitStructure
0002b2  f04f0040          MOV      r0,#0x40              ;2239
0002b6  6088              STR      r0,[r1,#8]            ;2239  ; SDIO_CmdInitStructure
0002b8  f04f0000          MOV      r0,#0                 ;2240
0002bc  60c8              STR      r0,[r1,#0xc]          ;2240  ; SDIO_CmdInitStructure
0002be  f44f6080          MOV      r0,#0x400             ;2241
0002c2  6108              STR      r0,[r1,#0x10]         ;2241  ; SDIO_CmdInitStructure
0002c4  4608              MOV      r0,r1                 ;2242
0002c6  f7fffffe          BL       SDIO_SendCommand
0002ca  2037              MOVS     r0,#0x37              ;2245
0002cc  f7fffffe          BL       CmdResp1Error
0002d0  4604              MOV      r4,r0                 ;2245
0002d2  b10c              CBZ      r4,|L1.728|
0002d4  4620              MOV      r0,r4                 ;2249
0002d6  e792              B        |L1.510|
                  |L1.728|
0002d8  f04f0000          MOV      r0,#0                 ;2253
0002dc  494b              LDR      r1,|L1.1036|
0002de  6008              STR      r0,[r1,#0]            ;2253  ; SDIO_CmdInitStructure
0002e0  f04f0006          MOV      r0,#6                 ;2254
0002e4  6048              STR      r0,[r1,#4]            ;2254  ; SDIO_CmdInitStructure
0002e6  f04f0040          MOV      r0,#0x40              ;2255
0002ea  6088              STR      r0,[r1,#8]            ;2255  ; SDIO_CmdInitStructure
0002ec  f04f0000          MOV      r0,#0                 ;2256
0002f0  60c8              STR      r0,[r1,#0xc]          ;2256  ; SDIO_CmdInitStructure
0002f2  f44f6080          MOV      r0,#0x400             ;2257
0002f6  6108              STR      r0,[r1,#0x10]         ;2257  ; SDIO_CmdInitStructure
0002f8  4608              MOV      r0,r1                 ;2258
0002fa  f7fffffe          BL       SDIO_SendCommand
0002fe  2006              MOVS     r0,#6                 ;2260
000300  f7fffffe          BL       CmdResp1Error
000304  4604              MOV      r4,r0                 ;2260
000306  b10c              CBZ      r4,|L1.780|
000308  4620              MOV      r0,r4                 ;2264
00030a  e778              B        |L1.510|
                  |L1.780|
00030c  4620              MOV      r0,r4                 ;2267
00030e  e776              B        |L1.510|
                  |L1.784|
000310  f04f0425          MOV      r4,#0x25              ;2271
000314  4620              MOV      r0,r4                 ;2272
000316  e772              B        |L1.510|
;;;2276   
                          ENDP

                  SD_EnableWideBusOperation PROC
;;;1078     */
;;;1079   SD_Error SD_EnableWideBusOperation(uint32_t WideMode)
000318  b570              PUSH     {r4-r6,lr}
;;;1080   {
00031a  4604              MOV      r4,r0
;;;1081     SD_Error errorstatus = SD_OK;
00031c  f04f0500          MOV      r5,#0
;;;1082   
;;;1083     /*!< MMC Card doesn't support this feature */
;;;1084     if (SDIO_MULTIMEDIA_CARD == CardType)
000320  483d              LDR      r0,|L1.1048|
000322  6800              LDR      r0,[r0,#0]  ; CardType
000324  2803              CMP      r0,#3
000326  d103              BNE      |L1.816|
;;;1085     {
;;;1086       errorstatus = SD_UNSUPPORTED_FEATURE;
000328  f04f0527          MOV      r5,#0x27
;;;1087       return(errorstatus);
00032c  4628              MOV      r0,r5
                  |L1.814|
;;;1088     }
;;;1089     else if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
;;;1090     {
;;;1091       if (SDIO_BusWide_8b == WideMode)
;;;1092       {
;;;1093         errorstatus = SD_UNSUPPORTED_FEATURE;
;;;1094         return(errorstatus);
;;;1095       }
;;;1096       else if (SDIO_BusWide_4b == WideMode)
;;;1097       {
;;;1098         errorstatus = SDEnWideBus(ENABLE);
;;;1099   
;;;1100         if (SD_OK == errorstatus)
;;;1101         {
;;;1102           /*!< Configure the SDIO peripheral */
;;;1103           SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
;;;1104           SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
;;;1105   		  
;;;1106   		///对高速卡，采用 48M 时钟：
;;;1107   #if SD_ENABLE_50M_SPEED
;;;1108   		if (SDCardInfo.SD_csd.MaxBusClkFrec == 0x5A)
;;;1109   			SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Enable;
;;;1110   		else
;;;1111   #endif
;;;1112   			SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
;;;1113   		
;;;1114           SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
;;;1115           SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_4b;
;;;1116           SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
;;;1117           SDIO_Init(&SDIO_InitStructure);
;;;1118         }
;;;1119       }
;;;1120       else
;;;1121       {
;;;1122         errorstatus = SDEnWideBus(DISABLE);
;;;1123   
;;;1124         if (SD_OK == errorstatus)
;;;1125         {
;;;1126           /*!< Configure the SDIO peripheral */
;;;1127           SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
;;;1128           SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
;;;1129           SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
;;;1130           SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
;;;1131           SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
;;;1132           SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
;;;1133           SDIO_Init(&SDIO_InitStructure);
;;;1134         }
;;;1135       }
;;;1136     }
;;;1137   
;;;1138     return(errorstatus);
;;;1139   }
00032e  bd70              POP      {r4-r6,pc}
                  |L1.816|
000330  4839              LDR      r0,|L1.1048|
000332  6800              LDR      r0,[r0,#0]            ;1089  ; CardType
000334  b138              CBZ      r0,|L1.838|
000336  4838              LDR      r0,|L1.1048|
000338  6800              LDR      r0,[r0,#0]            ;1089  ; CardType
00033a  2801              CMP      r0,#1                 ;1089
00033c  d003              BEQ      |L1.838|
00033e  4836              LDR      r0,|L1.1048|
000340  6800              LDR      r0,[r0,#0]            ;1089  ; CardType
000342  2802              CMP      r0,#2                 ;1089
000344  d13d              BNE      |L1.962|
                  |L1.838|
000346  f5b45f80          CMP      r4,#0x1000            ;1091
00034a  d103              BNE      |L1.852|
00034c  f04f0527          MOV      r5,#0x27              ;1093
000350  4628              MOV      r0,r5                 ;1094
000352  e7ec              B        |L1.814|
                  |L1.852|
000354  f5b46f00          CMP      r4,#0x800             ;1096
000358  d122              BNE      |L1.928|
00035a  2001              MOVS     r0,#1                 ;1098
00035c  f7fffffe          BL       SDEnWideBus
000360  4605              MOV      r5,r0                 ;1098
000362  2d00              CMP      r5,#0                 ;1100
000364  d12d              BNE      |L1.962|
000366  492d              LDR      r1,|L1.1052|
000368  7508              STRB     r0,[r1,#0x14]         ;1103
00036a  6008              STR      r0,[r1,#0]            ;1104  ; SDIO_InitStructure
00036c  482c              LDR      r0,|L1.1056|
00036e  7940              LDRB     r0,[r0,#5]            ;1108  ; SDCardInfo
000370  285a              CMP      r0,#0x5a              ;1108
000372  d103              BNE      |L1.892|
000374  f44f6080          MOV      r0,#0x400             ;1109
000378  6048              STR      r0,[r1,#4]            ;1109  ; SDIO_InitStructure
00037a  e003              B        |L1.900|
                  |L1.892|
00037c  f04f0000          MOV      r0,#0                 ;1112
000380  4926              LDR      r1,|L1.1052|
000382  6048              STR      r0,[r1,#4]            ;1112  ; SDIO_InitStructure
                  |L1.900|
000384  f04f0000          MOV      r0,#0                 ;1114
000388  4924              LDR      r1,|L1.1052|
00038a  6088              STR      r0,[r1,#8]            ;1114  ; SDIO_InitStructure
00038c  f44f6000          MOV      r0,#0x800             ;1115
000390  60c8              STR      r0,[r1,#0xc]          ;1115  ; SDIO_InitStructure
000392  f04f0000          MOV      r0,#0                 ;1116
000396  6108              STR      r0,[r1,#0x10]         ;1116  ; SDIO_InitStructure
000398  4608              MOV      r0,r1                 ;1117
00039a  f7fffffe          BL       SDIO_Init
00039e  e010              B        |L1.962|
                  |L1.928|
0003a0  2000              MOVS     r0,#0                 ;1122
0003a2  f7fffffe          BL       SDEnWideBus
0003a6  4605              MOV      r5,r0                 ;1122
0003a8  b95d              CBNZ     r5,|L1.962|
0003aa  f04f0000          MOV      r0,#0                 ;1127
0003ae  491b              LDR      r1,|L1.1052|
0003b0  7508              STRB     r0,[r1,#0x14]         ;1127
0003b2  6008              STR      r0,[r1,#0]            ;1128  ; SDIO_InitStructure
0003b4  6048              STR      r0,[r1,#4]            ;1129  ; SDIO_InitStructure
0003b6  6088              STR      r0,[r1,#8]            ;1130  ; SDIO_InitStructure
0003b8  60c8              STR      r0,[r1,#0xc]          ;1131  ; SDIO_InitStructure
0003ba  6108              STR      r0,[r1,#0x10]         ;1132  ; SDIO_InitStructure
0003bc  4608              MOV      r0,r1                 ;1133
0003be  f7fffffe          BL       SDIO_Init
                  |L1.962|
0003c2  4628              MOV      r0,r5                 ;1138
0003c4  e7b3              B        |L1.814|
;;;1140   
                          ENDP

                  SD_SelectDeselect PROC
;;;1145     */
;;;1146   SD_Error SD_SelectDeselect(uint32_t addr)
0003c6  b570              PUSH     {r4-r6,lr}
;;;1147   {
0003c8  4604              MOV      r4,r0
;;;1148     SD_Error errorstatus = SD_OK;
0003ca  f04f0500          MOV      r5,#0
;;;1149   
;;;1150     /*!< Send CMD7 SDIO_SEL_DESEL_CARD */
;;;1151     SDIO_CmdInitStructure.SDIO_Argument =  addr;
0003ce  480f              LDR      r0,|L1.1036|
0003d0  6004              STR      r4,[r0,#0]  ; SDIO_CmdInitStructure
;;;1152     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEL_DESEL_CARD;
0003d2  f04f0007          MOV      r0,#7
0003d6  490d              LDR      r1,|L1.1036|
0003d8  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;1153     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
0003da  f04f0040          MOV      r0,#0x40
0003de  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;1154     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
0003e0  f04f0000          MOV      r0,#0
0003e4  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;1155     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
0003e6  f44f6080          MOV      r0,#0x400
0003ea  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;1156     SDIO_SendCommand(&SDIO_CmdInitStructure);
0003ec  4608              MOV      r0,r1
0003ee  f7fffffe          BL       SDIO_SendCommand
;;;1157   
;;;1158     errorstatus = CmdResp1Error(SD_CMD_SEL_DESEL_CARD);
0003f2  2007              MOVS     r0,#7
0003f4  f7fffffe          BL       CmdResp1Error
0003f8  4605              MOV      r5,r0
;;;1159   
;;;1160     return(errorstatus);
0003fa  4628              MOV      r0,r5
;;;1161   }
0003fc  bd70              POP      {r4-r6,pc}
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      0x40012c34
                  |L1.1028|
                          DCD      0x40012c38
                  |L1.1032|
                          DCD      0x40012c14
                  |L1.1036|
                          DCD      SDIO_CmdInitStructure
                  |L1.1040|
                          DCD      ||RCA||
                  |L1.1044|
                          DCD      SDIO_DataInitStructure
                  |L1.1048|
                          DCD      CardType
                  |L1.1052|
                          DCD      SDIO_InitStructure
                  |L1.1056|
                          DCD      SDCardInfo
                          ENDP

                  SD_GetCardInfo PROC
;;;778      */
;;;779    SD_Error SD_GetCardInfo(SD_CardInfo *cardinfo)
000424  b530              PUSH     {r4,r5,lr}
;;;780    {
000426  4601              MOV      r1,r0
;;;781      SD_Error errorstatus = SD_OK;
000428  f04f0000          MOV      r0,#0
;;;782      uint8_t tmp = 0;
00042c  4602              MOV      r2,r0
;;;783    
;;;784      cardinfo->CardType = (uint8_t)CardType;
00042e  4bfd              LDR      r3,|L1.2084|
000430  681b              LDR      r3,[r3,#0]  ; CardType
000432  f881304e          STRB     r3,[r1,#0x4e]
;;;785      cardinfo->RCA = (uint16_t)RCA;
000436  4bfc              LDR      r3,|L1.2088|
000438  681b              LDR      r3,[r3,#0]  ; RCA
00043a  f8a1304c          STRH     r3,[r1,#0x4c]
;;;786    
;;;787      /*!< Byte 0 */
;;;788      tmp = (uint8_t)((CSD_Tab[0] & 0xFF000000) >> 24);
00043e  4bfb              LDR      r3,|L1.2092|
000440  681b              LDR      r3,[r3,#0]  ; CSD_Tab
000442  ea4f6213          LSR      r2,r3,#24
;;;789      cardinfo->SD_csd.CSDStruct = (tmp & 0xC0) >> 6;
000446  ea4f1392          LSR      r3,r2,#6
00044a  700b              STRB     r3,[r1,#0]
;;;790      cardinfo->SD_csd.SysSpecVersion = (tmp & 0x3C) >> 2;
00044c  f3c20383          UBFX     r3,r2,#2,#4
000450  704b              STRB     r3,[r1,#1]
;;;791      cardinfo->SD_csd.Reserved1 = tmp & 0x03;
000452  f0020303          AND      r3,r2,#3
000456  708b              STRB     r3,[r1,#2]
;;;792    
;;;793      /*!< Byte 1 */
;;;794      tmp = (uint8_t)((CSD_Tab[0] & 0x00FF0000) >> 16);
000458  4bf4              LDR      r3,|L1.2092|
00045a  681b              LDR      r3,[r3,#0]  ; CSD_Tab
00045c  f3c34207          UBFX     r2,r3,#16,#8
;;;795      cardinfo->SD_csd.TAAC = tmp;
000460  70ca              STRB     r2,[r1,#3]
;;;796    
;;;797      /*!< Byte 2 */
;;;798      tmp = (uint8_t)((CSD_Tab[0] & 0x0000FF00) >> 8);
000462  4bf2              LDR      r3,|L1.2092|
000464  681b              LDR      r3,[r3,#0]  ; CSD_Tab
000466  f3c32207          UBFX     r2,r3,#8,#8
;;;799      cardinfo->SD_csd.NSAC = tmp;
00046a  710a              STRB     r2,[r1,#4]
;;;800    
;;;801      /*!< Byte 3 */
;;;802      tmp = (uint8_t)(CSD_Tab[0] & 0x000000FF);
00046c  4bef              LDR      r3,|L1.2092|
00046e  681b              LDR      r3,[r3,#0]  ; CSD_Tab
000470  b2da              UXTB     r2,r3
;;;803      cardinfo->SD_csd.MaxBusClkFrec = tmp;
000472  714a              STRB     r2,[r1,#5]
;;;804    
;;;805      /*!< Byte 4 */
;;;806      tmp = (uint8_t)((CSD_Tab[1] & 0xFF000000) >> 24);
000474  4bed              LDR      r3,|L1.2092|
000476  685b              LDR      r3,[r3,#4]  ; CSD_Tab
000478  ea4f6213          LSR      r2,r3,#24
;;;807      cardinfo->SD_csd.CardComdClasses = tmp << 4;
00047c  ea4f1302          LSL      r3,r2,#4
000480  80cb              STRH     r3,[r1,#6]
;;;808    
;;;809      /*!< Byte 5 */
;;;810      tmp = (uint8_t)((CSD_Tab[1] & 0x00FF0000) >> 16);
000482  4bea              LDR      r3,|L1.2092|
000484  685b              LDR      r3,[r3,#4]  ; CSD_Tab
000486  f3c34207          UBFX     r2,r3,#16,#8
;;;811      cardinfo->SD_csd.CardComdClasses |= (tmp & 0xF0) >> 4;
00048a  88cb              LDRH     r3,[r1,#6]
00048c  ea431312          ORR      r3,r3,r2,LSR #4
000490  80cb              STRH     r3,[r1,#6]
;;;812      cardinfo->SD_csd.RdBlockLen = tmp & 0x0F;
000492  f002030f          AND      r3,r2,#0xf
000496  720b              STRB     r3,[r1,#8]
;;;813    
;;;814      /*!< Byte 6 */
;;;815      tmp = (uint8_t)((CSD_Tab[1] & 0x0000FF00) >> 8);
000498  4be4              LDR      r3,|L1.2092|
00049a  685b              LDR      r3,[r3,#4]  ; CSD_Tab
00049c  f3c32207          UBFX     r2,r3,#8,#8
;;;816      cardinfo->SD_csd.PartBlockRead = (tmp & 0x80) >> 7;
0004a0  ea4f13d2          LSR      r3,r2,#7
0004a4  724b              STRB     r3,[r1,#9]
;;;817      cardinfo->SD_csd.WrBlockMisalign = (tmp & 0x40) >> 6;
0004a6  f3c21380          UBFX     r3,r2,#6,#1
0004aa  728b              STRB     r3,[r1,#0xa]
;;;818      cardinfo->SD_csd.RdBlockMisalign = (tmp & 0x20) >> 5;
0004ac  f3c21340          UBFX     r3,r2,#5,#1
0004b0  72cb              STRB     r3,[r1,#0xb]
;;;819      cardinfo->SD_csd.DSRImpl = (tmp & 0x10) >> 4;
0004b2  f3c21300          UBFX     r3,r2,#4,#1
0004b6  730b              STRB     r3,[r1,#0xc]
;;;820      cardinfo->SD_csd.Reserved2 = 0; /*!< Reserved */
0004b8  4603              MOV      r3,r0
0004ba  734b              STRB     r3,[r1,#0xd]
;;;821    
;;;822      if ((CardType == SDIO_STD_CAPACITY_SD_CARD_V1_1) || (CardType == SDIO_STD_CAPACITY_SD_CARD_V2_0))
0004bc  4bd9              LDR      r3,|L1.2084|
0004be  681b              LDR      r3,[r3,#0]  ; CardType
0004c0  b11b              CBZ      r3,|L1.1226|
0004c2  4bd8              LDR      r3,|L1.2084|
0004c4  681b              LDR      r3,[r3,#0]  ; CardType
0004c6  2b01              CMP      r3,#1
0004c8  d146              BNE      |L1.1368|
                  |L1.1226|
;;;823      {
;;;824        cardinfo->SD_csd.DeviceSize = (tmp & 0x03) << 10;
0004ca  ea4f7382          LSL      r3,r2,#30
0004ce  ea4f5313          LSR      r3,r3,#20
0004d2  610b              STR      r3,[r1,#0x10]
;;;825    
;;;826        /*!< Byte 7 */
;;;827        tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
0004d4  4bd5              LDR      r3,|L1.2092|
0004d6  685b              LDR      r3,[r3,#4]  ; CSD_Tab
0004d8  b2da              UXTB     r2,r3
;;;828        cardinfo->SD_csd.DeviceSize |= (tmp) << 2;
0004da  690b              LDR      r3,[r1,#0x10]
0004dc  ea430382          ORR      r3,r3,r2,LSL #2
0004e0  610b              STR      r3,[r1,#0x10]
;;;829    
;;;830        /*!< Byte 8 */
;;;831        tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
0004e2  4bd2              LDR      r3,|L1.2092|
0004e4  689b              LDR      r3,[r3,#8]  ; CSD_Tab
0004e6  ea4f6213          LSR      r2,r3,#24
;;;832        cardinfo->SD_csd.DeviceSize |= (tmp & 0xC0) >> 6;
0004ea  690b              LDR      r3,[r1,#0x10]
0004ec  ea431392          ORR      r3,r3,r2,LSR #6
0004f0  610b              STR      r3,[r1,#0x10]
;;;833    
;;;834        cardinfo->SD_csd.MaxRdCurrentVDDMin = (tmp & 0x38) >> 3;
0004f2  f3c203c2          UBFX     r3,r2,#3,#3
0004f6  750b              STRB     r3,[r1,#0x14]
;;;835        cardinfo->SD_csd.MaxRdCurrentVDDMax = (tmp & 0x07);
0004f8  f0020307          AND      r3,r2,#7
0004fc  754b              STRB     r3,[r1,#0x15]
;;;836    
;;;837        /*!< Byte 9 */
;;;838        tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
0004fe  4bcb              LDR      r3,|L1.2092|
000500  689b              LDR      r3,[r3,#8]  ; CSD_Tab
000502  f3c34207          UBFX     r2,r3,#16,#8
;;;839        cardinfo->SD_csd.MaxWrCurrentVDDMin = (tmp & 0xE0) >> 5;
000506  ea4f1352          LSR      r3,r2,#5
00050a  758b              STRB     r3,[r1,#0x16]
;;;840        cardinfo->SD_csd.MaxWrCurrentVDDMax = (tmp & 0x1C) >> 2;
00050c  f3c20382          UBFX     r3,r2,#2,#3
000510  75cb              STRB     r3,[r1,#0x17]
;;;841        cardinfo->SD_csd.DeviceSizeMul = (tmp & 0x03) << 1;
000512  ea4f7382          LSL      r3,r2,#30
000516  ea4f7353          LSR      r3,r3,#29
00051a  760b              STRB     r3,[r1,#0x18]
;;;842        /*!< Byte 10 */
;;;843        tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
00051c  4bc3              LDR      r3,|L1.2092|
00051e  689b              LDR      r3,[r3,#8]  ; CSD_Tab
000520  f3c32207          UBFX     r2,r3,#8,#8
;;;844        cardinfo->SD_csd.DeviceSizeMul |= (tmp & 0x80) >> 7;
000524  7e0b              LDRB     r3,[r1,#0x18]
000526  ea4313d2          ORR      r3,r3,r2,LSR #7
00052a  760b              STRB     r3,[r1,#0x18]
;;;845        
;;;846        cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) ;
00052c  690b              LDR      r3,[r1,#0x10]
00052e  f1030301          ADD      r3,r3,#1
000532  644b              STR      r3,[r1,#0x44]
;;;847        cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
000534  7e0c              LDRB     r4,[r1,#0x18]
000536  6c4b              LDR      r3,[r1,#0x44]
000538  f1040402          ADD      r4,r4,#2
00053c  f04f0501          MOV      r5,#1
000540  fa05f504          LSL      r5,r5,r4
000544  fb03f305          MUL      r3,r3,r5
000548  644b              STR      r3,[r1,#0x44]
;;;848        cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
00054a  7a0c              LDRB     r4,[r1,#8]
00054c  f04f0301          MOV      r3,#1
000550  fa03f304          LSL      r3,r3,r4
000554  648b              STR      r3,[r1,#0x48]
000556  e028              B        |L1.1450|
                  |L1.1368|
;;;849    	///为保持兼容，标准容量卡的容量也用扇区数表示：
;;;850        ///cardinfo->CardCapacity *= cardinfo->CardBlockSize;
;;;851      }
;;;852      else if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
000558  4bb2              LDR      r3,|L1.2084|
00055a  681b              LDR      r3,[r3,#0]  ; CardType
00055c  2b02              CMP      r3,#2
00055e  d124              BNE      |L1.1450|
;;;853      {
;;;854        /*!< Byte 7 */
;;;855        tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
000560  4bb2              LDR      r3,|L1.2092|
000562  685b              LDR      r3,[r3,#4]  ; CSD_Tab
000564  b2da              UXTB     r2,r3
;;;856        cardinfo->SD_csd.DeviceSize = (tmp & 0x3F) << 16;
000566  ea4f6382          LSL      r3,r2,#26
00056a  ea4f2393          LSR      r3,r3,#10
00056e  610b              STR      r3,[r1,#0x10]
;;;857    
;;;858        /*!< Byte 8 */
;;;859        tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
000570  4bae              LDR      r3,|L1.2092|
000572  689b              LDR      r3,[r3,#8]  ; CSD_Tab
000574  ea4f6213          LSR      r2,r3,#24
;;;860    
;;;861        cardinfo->SD_csd.DeviceSize |= (tmp << 8);
000578  690b              LDR      r3,[r1,#0x10]
00057a  ea432302          ORR      r3,r3,r2,LSL #8
00057e  610b              STR      r3,[r1,#0x10]
;;;862    
;;;863        /*!< Byte 9 */
;;;864        tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
000580  4baa              LDR      r3,|L1.2092|
000582  689b              LDR      r3,[r3,#8]  ; CSD_Tab
000584  f3c34207          UBFX     r2,r3,#16,#8
;;;865    
;;;866        cardinfo->SD_csd.DeviceSize |= (tmp);
000588  690b              LDR      r3,[r1,#0x10]
00058a  ea430302          ORR      r3,r3,r2
00058e  610b              STR      r3,[r1,#0x10]
;;;867    
;;;868        /*!< Byte 10 */
;;;869        tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
000590  4ba6              LDR      r3,|L1.2092|
000592  689b              LDR      r3,[r3,#8]  ; CSD_Tab
000594  f3c32207          UBFX     r2,r3,#8,#8
;;;870        
;;;871    		///对 HD 卡，容量最大达到 32G，超出表示范围。因此，此处转义表示其 Sector 数量：
;;;872    		///cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) * 512 * 1024;
;;;873    		cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) * 1024;
000598  690b              LDR      r3,[r1,#0x10]
00059a  f1030301          ADD      r3,r3,#1
00059e  ea4f2383          LSL      r3,r3,#10
0005a2  644b              STR      r3,[r1,#0x44]
;;;874        cardinfo->CardBlockSize = 512;    
0005a4  f44f7300          MOV      r3,#0x200
0005a8  648b              STR      r3,[r1,#0x48]
                  |L1.1450|
;;;875      }
;;;876    
;;;877    
;;;878      cardinfo->SD_csd.EraseGrSize = (tmp & 0x40) >> 6;
0005aa  f3c21380          UBFX     r3,r2,#6,#1
0005ae  f8013f19          STRB     r3,[r1,#0x19]!
;;;879      cardinfo->SD_csd.EraseGrMul = (tmp & 0x3F) << 1;
0005b2  ea4f6382          LSL      r3,r2,#26
0005b6  ea4f6353          LSR      r3,r3,#25
0005ba  704b              STRB     r3,[r1,#1]
;;;880    
;;;881      /*!< Byte 11 */
;;;882      tmp = (uint8_t)(CSD_Tab[2] & 0x000000FF);
0005bc  4b9b              LDR      r3,|L1.2092|
0005be  689b              LDR      r3,[r3,#8]  ; CSD_Tab
0005c0  b2da              UXTB     r2,r3
;;;883      cardinfo->SD_csd.EraseGrMul |= (tmp & 0x80) >> 7;
0005c2  784b              LDRB     r3,[r1,#1]
0005c4  ea4313d2          ORR      r3,r3,r2,LSR #7
0005c8  704b              STRB     r3,[r1,#1]
;;;884      cardinfo->SD_csd.WrProtectGrSize = (tmp & 0x7F);
0005ca  f002037f          AND      r3,r2,#0x7f
0005ce  708b              STRB     r3,[r1,#2]
;;;885    
;;;886      /*!< Byte 12 */
;;;887      tmp = (uint8_t)((CSD_Tab[3] & 0xFF000000) >> 24);
0005d0  4b96              LDR      r3,|L1.2092|
0005d2  68db              LDR      r3,[r3,#0xc]  ; CSD_Tab
0005d4  ea4f6213          LSR      r2,r3,#24
;;;888      cardinfo->SD_csd.WrProtectGrEnable = (tmp & 0x80) >> 7;
0005d8  ea4f13d2          LSR      r3,r2,#7
0005dc  70cb              STRB     r3,[r1,#3]
;;;889      cardinfo->SD_csd.ManDeflECC = (tmp & 0x60) >> 5;
0005de  f3c21341          UBFX     r3,r2,#5,#2
0005e2  710b              STRB     r3,[r1,#4]
;;;890      cardinfo->SD_csd.WrSpeedFact = (tmp & 0x1C) >> 2;
0005e4  f3c20382          UBFX     r3,r2,#2,#3
0005e8  714b              STRB     r3,[r1,#5]
;;;891      cardinfo->SD_csd.MaxWrBlockLen = (tmp & 0x03) << 2;
0005ea  ea4f7382          LSL      r3,r2,#30
0005ee  ea4f7313          LSR      r3,r3,#28
0005f2  718b              STRB     r3,[r1,#6]
;;;892    
;;;893      /*!< Byte 13 */
;;;894      tmp = (uint8_t)((CSD_Tab[3] & 0x00FF0000) >> 16);
0005f4  4b8d              LDR      r3,|L1.2092|
0005f6  68db              LDR      r3,[r3,#0xc]  ; CSD_Tab
0005f8  f3c34207          UBFX     r2,r3,#16,#8
;;;895      cardinfo->SD_csd.MaxWrBlockLen |= (tmp & 0xC0) >> 6;
0005fc  798b              LDRB     r3,[r1,#6]
0005fe  ea431392          ORR      r3,r3,r2,LSR #6
000602  718b              STRB     r3,[r1,#6]
;;;896      cardinfo->SD_csd.WriteBlockPaPartial = (tmp & 0x20) >> 5;
000604  f3c21340          UBFX     r3,r2,#5,#1
000608  71cb              STRB     r3,[r1,#7]
;;;897      cardinfo->SD_csd.Reserved3 = 0;
00060a  f04f0300          MOV      r3,#0
00060e  720b              STRB     r3,[r1,#8]
;;;898      cardinfo->SD_csd.ContentProtectAppli = (tmp & 0x01);
000610  f0020301          AND      r3,r2,#1
000614  724b              STRB     r3,[r1,#9]
;;;899    
;;;900      /*!< Byte 14 */
;;;901      tmp = (uint8_t)((CSD_Tab[3] & 0x0000FF00) >> 8);
000616  4b85              LDR      r3,|L1.2092|
000618  68db              LDR      r3,[r3,#0xc]  ; CSD_Tab
00061a  f3c32207          UBFX     r2,r3,#8,#8
;;;902      cardinfo->SD_csd.FileFormatGrouop = (tmp & 0x80) >> 7;
00061e  ea4f13d2          LSR      r3,r2,#7
000622  728b              STRB     r3,[r1,#0xa]
;;;903      cardinfo->SD_csd.CopyFlag = (tmp & 0x40) >> 6;
000624  f3c21380          UBFX     r3,r2,#6,#1
000628  72cb              STRB     r3,[r1,#0xb]
;;;904      cardinfo->SD_csd.PermWrProtect = (tmp & 0x20) >> 5;
00062a  f3c21340          UBFX     r3,r2,#5,#1
00062e  730b              STRB     r3,[r1,#0xc]
;;;905      cardinfo->SD_csd.TempWrProtect = (tmp & 0x10) >> 4;
000630  f3c21300          UBFX     r3,r2,#4,#1
000634  734b              STRB     r3,[r1,#0xd]
;;;906      cardinfo->SD_csd.FileFormat = (tmp & 0x0C) >> 2;
000636  f3c20381          UBFX     r3,r2,#2,#2
00063a  738b              STRB     r3,[r1,#0xe]
;;;907      cardinfo->SD_csd.ECC = (tmp & 0x03);
00063c  f0020303          AND      r3,r2,#3
000640  73cb              STRB     r3,[r1,#0xf]
;;;908    
;;;909      /*!< Byte 15 */
;;;910      tmp = (uint8_t)(CSD_Tab[3] & 0x000000FF);
000642  4b7a              LDR      r3,|L1.2092|
000644  68db              LDR      r3,[r3,#0xc]  ; CSD_Tab
000646  b2da              UXTB     r2,r3
;;;911      cardinfo->SD_csd.CSD_CRC = (tmp & 0xFE) >> 1;
000648  ea4f0352          LSR      r3,r2,#1
00064c  740b              STRB     r3,[r1,#0x10]
;;;912      cardinfo->SD_csd.Reserved4 = 1;
00064e  f04f0301          MOV      r3,#1
000652  744b              STRB     r3,[r1,#0x11]
;;;913    
;;;914    
;;;915      /*!< Byte 0 */
;;;916      tmp = (uint8_t)((CID_Tab[0] & 0xFF000000) >> 24);
000654  4b76              LDR      r3,|L1.2096|
000656  681b              LDR      r3,[r3,#0]  ; CID_Tab
000658  ea4f6213          LSR      r2,r3,#24
;;;917      cardinfo->SD_cid.ManufacturerID = tmp;
00065c  74ca              STRB     r2,[r1,#0x13]
00065e  f1a10119          SUB      r1,r1,#0x19
;;;918    
;;;919      /*!< Byte 1 */
;;;920      tmp = (uint8_t)((CID_Tab[0] & 0x00FF0000) >> 16);
000662  4b73              LDR      r3,|L1.2096|
000664  681b              LDR      r3,[r3,#0]  ; CID_Tab
000666  f3c34207          UBFX     r2,r3,#16,#8
;;;921      cardinfo->SD_cid.OEM_AppliID = tmp << 8;
00066a  ea4f2402          LSL      r4,r2,#8
00066e  85cc              STRH     r4,[r1,#0x2e]
;;;922    
;;;923      /*!< Byte 2 */
;;;924      tmp = (uint8_t)((CID_Tab[0] & 0x000000FF00) >> 8);
000670  4b6f              LDR      r3,|L1.2096|
000672  681b              LDR      r3,[r3,#0]  ; CID_Tab
000674  f3c32207          UBFX     r2,r3,#8,#8
;;;925      cardinfo->SD_cid.OEM_AppliID |= tmp;
000678  8dcb              LDRH     r3,[r1,#0x2e]
00067a  ea430302          ORR      r3,r3,r2
00067e  85cb              STRH     r3,[r1,#0x2e]
;;;926    
;;;927      /*!< Byte 3 */
;;;928      tmp = (uint8_t)(CID_Tab[0] & 0x000000FF);
000680  4b6b              LDR      r3,|L1.2096|
000682  681b              LDR      r3,[r3,#0]  ; CID_Tab
000684  b2da              UXTB     r2,r3
;;;929      cardinfo->SD_cid.ProdName1 = tmp << 24;
000686  ea4f6402          LSL      r4,r2,#24
00068a  630c              STR      r4,[r1,#0x30]
;;;930    
;;;931      /*!< Byte 4 */
;;;932      tmp = (uint8_t)((CID_Tab[1] & 0xFF000000) >> 24);
00068c  4b68              LDR      r3,|L1.2096|
00068e  685b              LDR      r3,[r3,#4]  ; CID_Tab
000690  ea4f6213          LSR      r2,r3,#24
;;;933      cardinfo->SD_cid.ProdName1 |= tmp << 16;
000694  6b0b              LDR      r3,[r1,#0x30]
000696  ea434402          ORR      r4,r3,r2,LSL #16
00069a  630c              STR      r4,[r1,#0x30]
;;;934    
;;;935      /*!< Byte 5 */
;;;936      tmp = (uint8_t)((CID_Tab[1] & 0x00FF0000) >> 16);
00069c  4b64              LDR      r3,|L1.2096|
00069e  685b              LDR      r3,[r3,#4]  ; CID_Tab
0006a0  f3c34207          UBFX     r2,r3,#16,#8
;;;937      cardinfo->SD_cid.ProdName1 |= tmp << 8;
0006a4  6b0b              LDR      r3,[r1,#0x30]
0006a6  ea432402          ORR      r4,r3,r2,LSL #8
0006aa  630c              STR      r4,[r1,#0x30]
;;;938    
;;;939      /*!< Byte 6 */
;;;940      tmp = (uint8_t)((CID_Tab[1] & 0x0000FF00) >> 8);
0006ac  4b60              LDR      r3,|L1.2096|
0006ae  685b              LDR      r3,[r3,#4]  ; CID_Tab
0006b0  f3c32207          UBFX     r2,r3,#8,#8
;;;941      cardinfo->SD_cid.ProdName1 |= tmp;
0006b4  6b0b              LDR      r3,[r1,#0x30]
0006b6  ea430302          ORR      r3,r3,r2
0006ba  630b              STR      r3,[r1,#0x30]
;;;942    
;;;943      /*!< Byte 7 */
;;;944      tmp = (uint8_t)(CID_Tab[1] & 0x000000FF);
0006bc  4b5c              LDR      r3,|L1.2096|
0006be  685b              LDR      r3,[r3,#4]  ; CID_Tab
0006c0  b2da              UXTB     r2,r3
;;;945      cardinfo->SD_cid.ProdName2 = tmp;
0006c2  f04f0334          MOV      r3,#0x34
0006c6  545a              STRB     r2,[r3,r1]
;;;946    
;;;947      /*!< Byte 8 */
;;;948      tmp = (uint8_t)((CID_Tab[2] & 0xFF000000) >> 24);
0006c8  4b59              LDR      r3,|L1.2096|
0006ca  689b              LDR      r3,[r3,#8]  ; CID_Tab
0006cc  ea4f6213          LSR      r2,r3,#24
;;;949      cardinfo->SD_cid.ProdRev = tmp;
0006d0  f04f0335          MOV      r3,#0x35
0006d4  545a              STRB     r2,[r3,r1]
;;;950    
;;;951      /*!< Byte 9 */
;;;952      tmp = (uint8_t)((CID_Tab[2] & 0x00FF0000) >> 16);
0006d6  4b56              LDR      r3,|L1.2096|
0006d8  689b              LDR      r3,[r3,#8]  ; CID_Tab
0006da  f3c34207          UBFX     r2,r3,#16,#8
;;;953      cardinfo->SD_cid.ProdSN = tmp << 24;
0006de  ea4f6402          LSL      r4,r2,#24
0006e2  638c              STR      r4,[r1,#0x38]
;;;954    
;;;955      /*!< Byte 10 */
;;;956      tmp = (uint8_t)((CID_Tab[2] & 0x0000FF00) >> 8);
0006e4  4b52              LDR      r3,|L1.2096|
0006e6  689b              LDR      r3,[r3,#8]  ; CID_Tab
0006e8  f3c32207          UBFX     r2,r3,#8,#8
;;;957      cardinfo->SD_cid.ProdSN |= tmp << 16;
0006ec  6b8b              LDR      r3,[r1,#0x38]
0006ee  ea434402          ORR      r4,r3,r2,LSL #16
0006f2  638c              STR      r4,[r1,#0x38]
;;;958    
;;;959      /*!< Byte 11 */
;;;960      tmp = (uint8_t)(CID_Tab[2] & 0x000000FF);
0006f4  4b4e              LDR      r3,|L1.2096|
0006f6  689b              LDR      r3,[r3,#8]  ; CID_Tab
0006f8  b2da              UXTB     r2,r3
;;;961      cardinfo->SD_cid.ProdSN |= tmp << 8;
0006fa  6b8b              LDR      r3,[r1,#0x38]
0006fc  ea432402          ORR      r4,r3,r2,LSL #8
000700  638c              STR      r4,[r1,#0x38]
;;;962    
;;;963      /*!< Byte 12 */
;;;964      tmp = (uint8_t)((CID_Tab[3] & 0xFF000000) >> 24);
000702  4b4b              LDR      r3,|L1.2096|
000704  68db              LDR      r3,[r3,#0xc]  ; CID_Tab
000706  ea4f6213          LSR      r2,r3,#24
;;;965      cardinfo->SD_cid.ProdSN |= tmp;
00070a  6b8b              LDR      r3,[r1,#0x38]
00070c  ea430302          ORR      r3,r3,r2
000710  638b              STR      r3,[r1,#0x38]
;;;966    
;;;967      /*!< Byte 13 */
;;;968      tmp = (uint8_t)((CID_Tab[3] & 0x00FF0000) >> 16);
000712  4b47              LDR      r3,|L1.2096|
000714  68db              LDR      r3,[r3,#0xc]  ; CID_Tab
000716  f3c34207          UBFX     r2,r3,#16,#8
;;;969      cardinfo->SD_cid.Reserved1 |= (tmp & 0xF0) >> 4;
00071a  f04f033c          MOV      r3,#0x3c
00071e  5c5b              LDRB     r3,[r3,r1]
000720  ea431412          ORR      r4,r3,r2,LSR #4
000724  f04f033c          MOV      r3,#0x3c
000728  545c              STRB     r4,[r3,r1]
;;;970      cardinfo->SD_cid.ManufactDate = (tmp & 0x0F) << 8;
00072a  ea4f7302          LSL      r3,r2,#28
00072e  ea4f5413          LSR      r4,r3,#20
000732  87cc              STRH     r4,[r1,#0x3e]
;;;971    
;;;972      /*!< Byte 14 */
;;;973      tmp = (uint8_t)((CID_Tab[3] & 0x0000FF00) >> 8);
000734  4b3e              LDR      r3,|L1.2096|
000736  68db              LDR      r3,[r3,#0xc]  ; CID_Tab
000738  f3c32207          UBFX     r2,r3,#8,#8
;;;974      cardinfo->SD_cid.ManufactDate |= tmp;
00073c  8fcb              LDRH     r3,[r1,#0x3e]
00073e  ea430302          ORR      r3,r3,r2
000742  87cb              STRH     r3,[r1,#0x3e]
;;;975    
;;;976      /*!< Byte 15 */
;;;977      tmp = (uint8_t)(CID_Tab[3] & 0x000000FF);
000744  4b3a              LDR      r3,|L1.2096|
000746  68db              LDR      r3,[r3,#0xc]  ; CID_Tab
000748  b2da              UXTB     r2,r3
;;;978      cardinfo->SD_cid.CID_CRC = (tmp & 0xFE) >> 1;
00074a  ea4f0452          LSR      r4,r2,#1
00074e  f04f0340          MOV      r3,#0x40
000752  545c              STRB     r4,[r3,r1]
;;;979      cardinfo->SD_cid.Reserved2 = 1;
000754  f04f0401          MOV      r4,#1
000758  f04f0341          MOV      r3,#0x41
00075c  545c              STRB     r4,[r3,r1]
;;;980      
;;;981      return(errorstatus);
;;;982    }
00075e  bd30              POP      {r4,r5,pc}
;;;983    
                          ENDP

                  CmdResp2Error PROC
;;;2060     */
;;;2061   static SD_Error CmdResp2Error(void)
000760  b570              PUSH     {r4-r6,lr}
;;;2062   {
;;;2063     SD_Error errorstatus = SD_OK;
000762  f04f0500          MOV      r5,#0
;;;2064     uint32_t status;
;;;2065   
;;;2066     status = SDIO->STA;
000766  4833              LDR      r0,|L1.2100|
000768  6804              LDR      r4,[r0,#0]
;;;2067   
;;;2068     while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
00076a  e001              B        |L1.1904|
                  |L1.1900|
;;;2069     {
;;;2070       status = SDIO->STA;
00076c  4831              LDR      r0,|L1.2100|
00076e  6804              LDR      r4,[r0,#0]
                  |L1.1904|
000770  f0140f45          TST      r4,#0x45              ;2068
000774  d0fa              BEQ      |L1.1900|
;;;2071     }
;;;2072   
;;;2073     if (status & SDIO_FLAG_CTIMEOUT)
000776  f0140f04          TST      r4,#4
00077a  d007              BEQ      |L1.1932|
;;;2074     {
;;;2075       errorstatus = SD_CMD_RSP_TIMEOUT;
00077c  f04f0503          MOV      r5,#3
;;;2076       SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
000780  f04f0004          MOV      r0,#4
000784  f7fffffe          BL       SDIO_ClearFlag
;;;2077       return(errorstatus);
000788  4628              MOV      r0,r5
                  |L1.1930|
;;;2078     }
;;;2079     else if (status & SDIO_FLAG_CCRCFAIL)
;;;2080     {
;;;2081       errorstatus = SD_CMD_CRC_FAIL;
;;;2082       SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
;;;2083       return(errorstatus);
;;;2084     }
;;;2085   
;;;2086     /*!< Clear all the static flags */
;;;2087     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;2088   
;;;2089     return(errorstatus);
;;;2090   }
00078a  bd70              POP      {r4-r6,pc}
                  |L1.1932|
00078c  f0140f01          TST      r4,#1                 ;2079
000790  d006              BEQ      |L1.1952|
000792  f04f0501          MOV      r5,#1                 ;2081
000796  4628              MOV      r0,r5                 ;2082
000798  f7fffffe          BL       SDIO_ClearFlag
00079c  4628              MOV      r0,r5                 ;2083
00079e  e7f4              B        |L1.1930|
                  |L1.1952|
0007a0  f24050ff          MOV      r0,#0x5ff             ;2087
0007a4  f7fffffe          BL       SDIO_ClearFlag
0007a8  4628              MOV      r0,r5                 ;2089
0007aa  e7ee              B        |L1.1930|
;;;2091   
                          ENDP

                  CmdResp6Error PROC
;;;2098     */
;;;2099   static SD_Error CmdResp6Error(uint8_t cmd, uint16_t *prca)
0007ac  e92d41f0          PUSH     {r4-r8,lr}
;;;2100   {
0007b0  4606              MOV      r6,r0
0007b2  460f              MOV      r7,r1
;;;2101     SD_Error errorstatus = SD_OK;
0007b4  f04f0800          MOV      r8,#0
;;;2102     uint32_t status;
;;;2103     uint32_t response_r1;
;;;2104   
;;;2105     status = SDIO->STA;
0007b8  481e              LDR      r0,|L1.2100|
0007ba  6805              LDR      r5,[r0,#0]
;;;2106   
;;;2107     while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
0007bc  e001              B        |L1.1986|
                  |L1.1982|
;;;2108     {
;;;2109       status = SDIO->STA;
0007be  481d              LDR      r0,|L1.2100|
0007c0  6805              LDR      r5,[r0,#0]
                  |L1.1986|
0007c2  f0150f45          TST      r5,#0x45              ;2107
0007c6  d0fa              BEQ      |L1.1982|
;;;2110     }
;;;2111   
;;;2112     if (status & SDIO_FLAG_CTIMEOUT)
0007c8  f0150f04          TST      r5,#4
0007cc  d008              BEQ      |L1.2016|
;;;2113     {
;;;2114       errorstatus = SD_CMD_RSP_TIMEOUT;
0007ce  f04f0803          MOV      r8,#3
;;;2115       SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
0007d2  f04f0004          MOV      r0,#4
0007d6  f7fffffe          BL       SDIO_ClearFlag
;;;2116       return(errorstatus);
0007da  4640              MOV      r0,r8
                  |L1.2012|
;;;2117     }
;;;2118     else if (status & SDIO_FLAG_CCRCFAIL)
;;;2119     {
;;;2120       errorstatus = SD_CMD_CRC_FAIL;
;;;2121       SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
;;;2122       return(errorstatus);
;;;2123     }
;;;2124   
;;;2125     /*!< Check response received is of desired command */
;;;2126     if (SDIO_GetCommandResponse() != cmd)
;;;2127     {
;;;2128       errorstatus = SD_ILLEGAL_CMD;
;;;2129       return(errorstatus);
;;;2130     }
;;;2131   
;;;2132     /*!< Clear all the static flags */
;;;2133     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;2134   
;;;2135     /*!< We have received response, retrieve it.  */
;;;2136     response_r1 = SDIO_GetResponse(SDIO_RESP1);
;;;2137   
;;;2138     if (SD_ALLZERO == (response_r1 & (SD_R6_GENERAL_UNKNOWN_ERROR | SD_R6_ILLEGAL_CMD | SD_R6_COM_CRC_FAILED)))
;;;2139     {
;;;2140       *prca = (uint16_t) (response_r1 >> 16);
;;;2141       return(errorstatus);
;;;2142     }
;;;2143   
;;;2144     if (response_r1 & SD_R6_GENERAL_UNKNOWN_ERROR)
;;;2145     {
;;;2146       return(SD_GENERAL_UNKNOWN_ERROR);
;;;2147     }
;;;2148   
;;;2149     if (response_r1 & SD_R6_ILLEGAL_CMD)
;;;2150     {
;;;2151       return(SD_ILLEGAL_CMD);
;;;2152     }
;;;2153   
;;;2154     if (response_r1 & SD_R6_COM_CRC_FAILED)
;;;2155     {
;;;2156       return(SD_COM_CRC_FAILED);
;;;2157     }
;;;2158   
;;;2159     return(errorstatus);
;;;2160   }
0007dc  e8bd81f0          POP      {r4-r8,pc}
                  |L1.2016|
0007e0  f0150f01          TST      r5,#1                 ;2118
0007e4  d006              BEQ      |L1.2036|
0007e6  f04f0801          MOV      r8,#1                 ;2120
0007ea  4640              MOV      r0,r8                 ;2121
0007ec  f7fffffe          BL       SDIO_ClearFlag
0007f0  4640              MOV      r0,r8                 ;2122
0007f2  e7f3              B        |L1.2012|
                  |L1.2036|
0007f4  f7fffffe          BL       SDIO_GetCommandResponse
0007f8  42b0              CMP      r0,r6                 ;2126
0007fa  d003              BEQ      |L1.2052|
0007fc  f04f0810          MOV      r8,#0x10              ;2128
000800  4640              MOV      r0,r8                 ;2129
000802  e7eb              B        |L1.2012|
                  |L1.2052|
000804  f24050ff          MOV      r0,#0x5ff             ;2133
000808  f7fffffe          BL       SDIO_ClearFlag
00080c  2000              MOVS     r0,#0                 ;2136
00080e  f7fffffe          BL       SDIO_GetResponse
000812  4604              MOV      r4,r0                 ;2136
000814  f4144f60          TST      r4,#0xe000            ;2138
000818  d10e              BNE      |L1.2104|
00081a  ea4f4014          LSR      r0,r4,#16             ;2140
00081e  8038              STRH     r0,[r7,#0]            ;2140
000820  4640              MOV      r0,r8                 ;2141
000822  e7db              B        |L1.2012|
                  |L1.2084|
                          DCD      CardType
                  |L1.2088|
                          DCD      ||RCA||
                  |L1.2092|
                          DCD      CSD_Tab
                  |L1.2096|
                          DCD      CID_Tab
                  |L1.2100|
                          DCD      0x40012c34
                  |L1.2104|
000838  f4145f00          TST      r4,#0x2000            ;2144
00083c  d001              BEQ      |L1.2114|
00083e  2013              MOVS     r0,#0x13              ;2146
000840  e7cc              B        |L1.2012|
                  |L1.2114|
000842  f4144f80          TST      r4,#0x4000            ;2149
000846  d001              BEQ      |L1.2124|
000848  2010              MOVS     r0,#0x10              ;2151
00084a  e7c7              B        |L1.2012|
                  |L1.2124|
00084c  f4144f00          TST      r4,#0x8000            ;2154
000850  d001              BEQ      |L1.2134|
000852  200f              MOVS     r0,#0xf               ;2156
000854  e7c2              B        |L1.2012|
                  |L1.2134|
000856  4640              MOV      r0,r8                 ;2159
000858  e7c0              B        |L1.2012|
;;;2161   
                          ENDP

                  SD_InitializeCards PROC
;;;689      */
;;;690    SD_Error SD_InitializeCards(void)
00085a  b538              PUSH     {r3-r5,lr}
;;;691    {
;;;692      SD_Error errorstatus = SD_OK;
00085c  f04f0400          MOV      r4,#0
;;;693      uint16_t rca = 0x01;
000860  f04f0001          MOV      r0,#1
000864  9000              STR      r0,[sp,#0]
;;;694    
;;;695      if (SDIO_GetPowerState() == SDIO_PowerState_OFF)
000866  f7fffffe          BL       SDIO_GetPowerState
00086a  b918              CBNZ     r0,|L1.2164|
;;;696      {
;;;697        errorstatus = SD_REQUEST_NOT_APPLICABLE;
00086c  f04f0425          MOV      r4,#0x25
;;;698        return(errorstatus);
000870  4620              MOV      r0,r4
                  |L1.2162|
;;;699      }
;;;700    
;;;701      if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
;;;702      {
;;;703        /*!< Send CMD2 ALL_SEND_CID */
;;;704        SDIO_CmdInitStructure.SDIO_Argument = 0x0;
;;;705        SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ALL_SEND_CID;
;;;706        SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
;;;707        SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;708        SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;709        SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;710    
;;;711        errorstatus = CmdResp2Error();
;;;712    
;;;713        if (SD_OK != errorstatus)
;;;714        {
;;;715          return(errorstatus);
;;;716        }
;;;717    
;;;718        CID_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
;;;719        CID_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
;;;720        CID_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
;;;721        CID_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
;;;722      }
;;;723      if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) ||  (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) ||  (SDIO_SECURE_DIGITAL_IO_COMBO_CARD == CardType)
;;;724          ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
;;;725      {
;;;726        /*!< Send CMD3 SET_REL_ADDR with argument 0 */
;;;727        /*!< SD Card publishes its RCA. */
;;;728        SDIO_CmdInitStructure.SDIO_Argument = 0x00;
;;;729        SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_REL_ADDR;
;;;730        SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;731        SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;732        SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;733        SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;734    
;;;735        errorstatus = CmdResp6Error(SD_CMD_SET_REL_ADDR, &rca);
;;;736    
;;;737        if (SD_OK != errorstatus)
;;;738        {
;;;739          return(errorstatus);
;;;740        }
;;;741      }
;;;742    
;;;743      if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
;;;744      {
;;;745        RCA = rca;
;;;746    
;;;747        /*!< Send CMD9 SEND_CSD with argument as card's RCA */
;;;748        SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)(rca << 16);
;;;749        SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_CSD;
;;;750        SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
;;;751        SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;752        SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;753        SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;754    
;;;755        errorstatus = CmdResp2Error();
;;;756    
;;;757        if (SD_OK != errorstatus)
;;;758        {
;;;759          return(errorstatus);
;;;760        }
;;;761    
;;;762        CSD_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
;;;763        CSD_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
;;;764        CSD_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
;;;765        CSD_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
;;;766      }
;;;767    
;;;768      errorstatus = SD_OK; /*!< All cards get intialized */
;;;769    
;;;770      return(errorstatus);
;;;771    }
000872  bd38              POP      {r3-r5,pc}
                  |L1.2164|
000874  48fe              LDR      r0,|L1.3184|
000876  6800              LDR      r0,[r0,#0]            ;701  ; CardType
000878  2804              CMP      r0,#4                 ;701
00087a  d02c              BEQ      |L1.2262|
00087c  f04f0000          MOV      r0,#0                 ;704
000880  49fc              LDR      r1,|L1.3188|
000882  6008              STR      r0,[r1,#0]            ;704  ; SDIO_CmdInitStructure
000884  f04f0002          MOV      r0,#2                 ;705
000888  6048              STR      r0,[r1,#4]            ;705  ; SDIO_CmdInitStructure
00088a  f04f00c0          MOV      r0,#0xc0              ;706
00088e  6088              STR      r0,[r1,#8]            ;706  ; SDIO_CmdInitStructure
000890  f04f0000          MOV      r0,#0                 ;707
000894  60c8              STR      r0,[r1,#0xc]          ;707  ; SDIO_CmdInitStructure
000896  f44f6080          MOV      r0,#0x400             ;708
00089a  6108              STR      r0,[r1,#0x10]         ;708  ; SDIO_CmdInitStructure
00089c  4608              MOV      r0,r1                 ;709
00089e  f7fffffe          BL       SDIO_SendCommand
0008a2  f7fffffe          BL       CmdResp2Error
0008a6  4604              MOV      r4,r0                 ;711
0008a8  b10c              CBZ      r4,|L1.2222|
0008aa  4620              MOV      r0,r4                 ;715
0008ac  e7e1              B        |L1.2162|
                  |L1.2222|
0008ae  2000              MOVS     r0,#0                 ;718
0008b0  f7fffffe          BL       SDIO_GetResponse
0008b4  49f0              LDR      r1,|L1.3192|
0008b6  6008              STR      r0,[r1,#0]            ;718  ; CID_Tab
0008b8  2004              MOVS     r0,#4                 ;719
0008ba  f7fffffe          BL       SDIO_GetResponse
0008be  49ee              LDR      r1,|L1.3192|
0008c0  6048              STR      r0,[r1,#4]            ;719  ; CID_Tab
0008c2  2008              MOVS     r0,#8                 ;720
0008c4  f7fffffe          BL       SDIO_GetResponse
0008c8  49eb              LDR      r1,|L1.3192|
0008ca  6088              STR      r0,[r1,#8]            ;720  ; CID_Tab
0008cc  200c              MOVS     r0,#0xc               ;721
0008ce  f7fffffe          BL       SDIO_GetResponse
0008d2  49e9              LDR      r1,|L1.3192|
0008d4  60c8              STR      r0,[r1,#0xc]          ;721  ; CID_Tab
                  |L1.2262|
0008d6  48e6              LDR      r0,|L1.3184|
0008d8  6800              LDR      r0,[r0,#0]            ;723  ; CardType
0008da  b158              CBZ      r0,|L1.2292|
0008dc  48e4              LDR      r0,|L1.3184|
0008de  6800              LDR      r0,[r0,#0]            ;723  ; CardType
0008e0  2801              CMP      r0,#1                 ;723
0008e2  d007              BEQ      |L1.2292|
0008e4  48e2              LDR      r0,|L1.3184|
0008e6  6800              LDR      r0,[r0,#0]            ;723  ; CardType
0008e8  2806              CMP      r0,#6                 ;723
0008ea  d003              BEQ      |L1.2292|
0008ec  48e0              LDR      r0,|L1.3184|
0008ee  6800              LDR      r0,[r0,#0]            ;724  ; CardType
0008f0  2802              CMP      r0,#2                 ;724
0008f2  d11a              BNE      |L1.2346|
                  |L1.2292|
0008f4  f04f0000          MOV      r0,#0                 ;728
0008f8  49de              LDR      r1,|L1.3188|
0008fa  6008              STR      r0,[r1,#0]            ;728  ; SDIO_CmdInitStructure
0008fc  f04f0003          MOV      r0,#3                 ;729
000900  6048              STR      r0,[r1,#4]            ;729  ; SDIO_CmdInitStructure
000902  f04f0040          MOV      r0,#0x40              ;730
000906  6088              STR      r0,[r1,#8]            ;730  ; SDIO_CmdInitStructure
000908  f04f0000          MOV      r0,#0                 ;731
00090c  60c8              STR      r0,[r1,#0xc]          ;731  ; SDIO_CmdInitStructure
00090e  f44f6080          MOV      r0,#0x400             ;732
000912  6108              STR      r0,[r1,#0x10]         ;732  ; SDIO_CmdInitStructure
000914  4608              MOV      r0,r1                 ;733
000916  f7fffffe          BL       SDIO_SendCommand
00091a  4669              MOV      r1,sp                 ;735
00091c  2003              MOVS     r0,#3                 ;735
00091e  f7fffffe          BL       CmdResp6Error
000922  4604              MOV      r4,r0                 ;735
000924  b10c              CBZ      r4,|L1.2346|
000926  4620              MOV      r0,r4                 ;739
000928  e7a3              B        |L1.2162|
                  |L1.2346|
00092a  48d1              LDR      r0,|L1.3184|
00092c  6800              LDR      r0,[r0,#0]            ;743  ; CardType
00092e  2804              CMP      r0,#4                 ;743
000930  d032              BEQ      |L1.2456|
000932  f8bd0000          LDRH     r0,[sp,#0]            ;745
000936  49d1              LDR      r1,|L1.3196|
000938  6008              STR      r0,[r1,#0]            ;745  ; RCA
00093a  f8bd0000          LDRH     r0,[sp,#0]            ;748
00093e  ea4f4000          LSL      r0,r0,#16             ;748
000942  49cc              LDR      r1,|L1.3188|
000944  6008              STR      r0,[r1,#0]            ;748  ; SDIO_CmdInitStructure
000946  f04f0009          MOV      r0,#9                 ;749
00094a  6048              STR      r0,[r1,#4]            ;749  ; SDIO_CmdInitStructure
00094c  f04f00c0          MOV      r0,#0xc0              ;750
000950  6088              STR      r0,[r1,#8]            ;750  ; SDIO_CmdInitStructure
000952  f04f0000          MOV      r0,#0                 ;751
000956  60c8              STR      r0,[r1,#0xc]          ;751  ; SDIO_CmdInitStructure
000958  f44f6080          MOV      r0,#0x400             ;752
00095c  6108              STR      r0,[r1,#0x10]         ;752  ; SDIO_CmdInitStructure
00095e  4608              MOV      r0,r1                 ;753
000960  f7fffffe          BL       SDIO_SendCommand
000964  f7fffffe          BL       CmdResp2Error
000968  4604              MOV      r4,r0                 ;755
00096a  b10c              CBZ      r4,|L1.2416|
00096c  4620              MOV      r0,r4                 ;759
00096e  e780              B        |L1.2162|
                  |L1.2416|
000970  2000              MOVS     r0,#0                 ;762
000972  f7fffffe          BL       SDIO_GetResponse
000976  49c2              LDR      r1,|L1.3200|
000978  6008              STR      r0,[r1,#0]            ;762  ; CSD_Tab
00097a  2004              MOVS     r0,#4                 ;763
00097c  f7fffffe          BL       SDIO_GetResponse
000980  49bf              LDR      r1,|L1.3200|
000982  6048              STR      r0,[r1,#4]            ;763  ; CSD_Tab
000984  2008              MOVS     r0,#8                 ;764
000986  f7fffffe          BL       SDIO_GetResponse
00098a  49bd              LDR      r1,|L1.3200|
00098c  6088              STR      r0,[r1,#8]            ;764  ; CSD_Tab
00098e  200c              MOVS     r0,#0xc               ;765
000990  f7fffffe          BL       SDIO_GetResponse
000994  49ba              LDR      r1,|L1.3200|
000996  60c8              STR      r0,[r1,#0xc]          ;765  ; CSD_Tab
                  |L1.2456|
000998  f04f0400          MOV      r4,#0                 ;768
00099c  4620              MOV      r0,r4                 ;770
00099e  e768              B        |L1.2162|
;;;772    
                          ENDP

                  CmdResp3Error PROC
;;;2032     */
;;;2033   static SD_Error CmdResp3Error(void)
0009a0  b570              PUSH     {r4-r6,lr}
;;;2034   {
;;;2035     SD_Error errorstatus = SD_OK;
0009a2  f04f0500          MOV      r5,#0
;;;2036     uint32_t status;
;;;2037   
;;;2038     status = SDIO->STA;
0009a6  48b7              LDR      r0,|L1.3204|
0009a8  6804              LDR      r4,[r0,#0]
;;;2039   
;;;2040     while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
0009aa  e001              B        |L1.2480|
                  |L1.2476|
;;;2041     {
;;;2042       status = SDIO->STA;
0009ac  48b5              LDR      r0,|L1.3204|
0009ae  6804              LDR      r4,[r0,#0]
                  |L1.2480|
0009b0  f0140f45          TST      r4,#0x45              ;2040
0009b4  d0fa              BEQ      |L1.2476|
;;;2043     }
;;;2044   
;;;2045     if (status & SDIO_FLAG_CTIMEOUT)
0009b6  f0140f04          TST      r4,#4
0009ba  d007              BEQ      |L1.2508|
;;;2046     {
;;;2047       errorstatus = SD_CMD_RSP_TIMEOUT;
0009bc  f04f0503          MOV      r5,#3
;;;2048       SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
0009c0  f04f0004          MOV      r0,#4
0009c4  f7fffffe          BL       SDIO_ClearFlag
;;;2049       return(errorstatus);
0009c8  4628              MOV      r0,r5
                  |L1.2506|
;;;2050     }
;;;2051     /*!< Clear all the static flags */
;;;2052     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;2053     return(errorstatus);
;;;2054   }
0009ca  bd70              POP      {r4-r6,pc}
                  |L1.2508|
0009cc  f24050ff          MOV      r0,#0x5ff             ;2052
0009d0  f7fffffe          BL       SDIO_ClearFlag
0009d4  4628              MOV      r0,r5                 ;2053
0009d6  e7f8              B        |L1.2506|
;;;2055   
                          ENDP

                  CmdResp7Error PROC
;;;1979     */
;;;1980   static SD_Error CmdResp7Error(void)
0009d8  b570              PUSH     {r4-r6,lr}
;;;1981   {
;;;1982     SD_Error errorstatus = SD_OK;
0009da  f04f0600          MOV      r6,#0
;;;1983     uint32_t status;
;;;1984     uint32_t timeout = SDIO_CMD0TIMEOUT;
0009de  f44f3580          MOV      r5,#0x10000
;;;1985   
;;;1986     status = SDIO->STA;
0009e2  48a8              LDR      r0,|L1.3204|
0009e4  6804              LDR      r4,[r0,#0]
;;;1987   
;;;1988     while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)) && (timeout > 0))
0009e6  e003              B        |L1.2544|
                  |L1.2536|
;;;1989     {
;;;1990       timeout--;
0009e8  f1a50501          SUB      r5,r5,#1
;;;1991       status = SDIO->STA;
0009ec  48a5              LDR      r0,|L1.3204|
0009ee  6804              LDR      r4,[r0,#0]
                  |L1.2544|
0009f0  f0140f45          TST      r4,#0x45              ;1988
0009f4  d101              BNE      |L1.2554|
0009f6  2d00              CMP      r5,#0                 ;1988
0009f8  d1f6              BNE      |L1.2536|
                  |L1.2554|
;;;1992     }
;;;1993   
;;;1994     if ((timeout == 0) || (status & SDIO_FLAG_CTIMEOUT))
0009fa  b115              CBZ      r5,|L1.2562|
0009fc  f0140f04          TST      r4,#4
000a00  d007              BEQ      |L1.2578|
                  |L1.2562|
;;;1995     {
;;;1996       /*!< Card is not V2.0 complient or card does not support the set voltage range */
;;;1997       errorstatus = SD_CMD_RSP_TIMEOUT;
000a02  f04f0603          MOV      r6,#3
;;;1998       SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
000a06  f04f0004          MOV      r0,#4
000a0a  f7fffffe          BL       SDIO_ClearFlag
;;;1999       return(errorstatus);
000a0e  4630              MOV      r0,r6
                  |L1.2576|
;;;2000     }
;;;2001   
;;;2002     if (status & SDIO_FLAG_CMDREND)
;;;2003     {
;;;2004       /*!< Card is SD V2.0 compliant */
;;;2005       errorstatus = SD_OK;
;;;2006       SDIO_ClearFlag(SDIO_FLAG_CMDREND);
;;;2007       return(errorstatus);
;;;2008     }
;;;2009     return(errorstatus);
;;;2010   }
000a10  bd70              POP      {r4-r6,pc}
                  |L1.2578|
000a12  f0140f40          TST      r4,#0x40              ;2002
000a16  d007              BEQ      |L1.2600|
000a18  f04f0600          MOV      r6,#0                 ;2005
000a1c  f04f0040          MOV      r0,#0x40              ;2006
000a20  f7fffffe          BL       SDIO_ClearFlag
000a24  4630              MOV      r0,r6                 ;2007
000a26  e7f3              B        |L1.2576|
                  |L1.2600|
000a28  4630              MOV      r0,r6                 ;2009
000a2a  e7f1              B        |L1.2576|
;;;2011   
                          ENDP

                  CmdError PROC
;;;1950     */
;;;1951   static SD_Error CmdError(void)
000a2c  b570              PUSH     {r4-r6,lr}
;;;1952   {
;;;1953     SD_Error errorstatus = SD_OK;
000a2e  f04f0500          MOV      r5,#0
;;;1954     uint32_t timeout;
;;;1955   
;;;1956     timeout = SDIO_CMD0TIMEOUT; /*!< 10000 */
000a32  f44f3480          MOV      r4,#0x10000
;;;1957   
;;;1958     while ((timeout > 0) && (SDIO_GetFlagStatus(SDIO_FLAG_CMDSENT) == RESET))
000a36  e001              B        |L1.2620|
                  |L1.2616|
;;;1959     {
;;;1960       timeout--;
000a38  f1a40401          SUB      r4,r4,#1
                  |L1.2620|
000a3c  b124              CBZ      r4,|L1.2632|
000a3e  2080              MOVS     r0,#0x80              ;1958
000a40  f7fffffe          BL       SDIO_GetFlagStatus
000a44  2800              CMP      r0,#0                 ;1958
000a46  d0f7              BEQ      |L1.2616|
                  |L1.2632|
;;;1961     }
;;;1962   
;;;1963     if (timeout == 0)
000a48  b91c              CBNZ     r4,|L1.2642|
;;;1964     {
;;;1965       errorstatus = SD_CMD_RSP_TIMEOUT;
000a4a  f04f0503          MOV      r5,#3
;;;1966       return(errorstatus);
000a4e  4628              MOV      r0,r5
                  |L1.2640|
;;;1967     }
;;;1968   
;;;1969     /*!< Clear all the static flags */
;;;1970     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;1971   
;;;1972     return(errorstatus);
;;;1973   }
000a50  bd70              POP      {r4-r6,pc}
                  |L1.2642|
000a52  f24050ff          MOV      r0,#0x5ff             ;1970
000a56  f7fffffe          BL       SDIO_ClearFlag
000a5a  4628              MOV      r0,r5                 ;1972
000a5c  e7f8              B        |L1.2640|
;;;1974   
                          ENDP

                  SD_PowerON PROC
;;;529      */
;;;530    SD_Error SD_PowerON(void)
000a5e  e92d41f0          PUSH     {r4-r8,lr}
;;;531    {
;;;532      __IO SD_Error errorstatus = SD_OK;
000a62  f04f0400          MOV      r4,#0
;;;533      uint32_t response = 0, count = 0, validvoltage = 0;
000a66  4626              MOV      r6,r4
000a68  4625              MOV      r5,r4
000a6a  4627              MOV      r7,r4
;;;534      uint32_t SDType = SD_STD_CAPACITY;
000a6c  46a0              MOV      r8,r4
;;;535    
;;;536      /*!< Power ON Sequence -----------------------------------------------------*/
;;;537      /*!< Configure the SDIO peripheral */
;;;538      /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_INIT_CLK_DIV) */
;;;539      /*!< on STM32F2xx devices, SDIOCLK is fixed to 48MHz */
;;;540      /*!< SDIO_CK for initialization should not exceed 400 KHz */  
;;;541      SDIO_InitStructure.SDIO_ClockDiv = SDIO_INIT_CLK_DIV;
000a6e  f04f0076          MOV      r0,#0x76
000a72  4985              LDR      r1,|L1.3208|
000a74  7508              STRB     r0,[r1,#0x14]
;;;542      SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
000a76  f04f0000          MOV      r0,#0
000a7a  6008              STR      r0,[r1,#0]  ; SDIO_InitStructure
;;;543      SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
000a7c  6048              STR      r0,[r1,#4]  ; SDIO_InitStructure
;;;544      SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
000a7e  6088              STR      r0,[r1,#8]  ; SDIO_InitStructure
;;;545      SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
000a80  60c8              STR      r0,[r1,#0xc]  ; SDIO_InitStructure
;;;546      SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
000a82  6108              STR      r0,[r1,#0x10]  ; SDIO_InitStructure
;;;547      SDIO_Init(&SDIO_InitStructure);
000a84  4608              MOV      r0,r1
000a86  f7fffffe          BL       SDIO_Init
;;;548    
;;;549      /*!< Set Power State to ON */
;;;550      SDIO_SetPowerState(SDIO_PowerState_ON);
000a8a  2003              MOVS     r0,#3
000a8c  f7fffffe          BL       SDIO_SetPowerState
;;;551    
;;;552      /*!< Enable SDIO Clock */
;;;553      SDIO_ClockCmd(ENABLE);
000a90  2001              MOVS     r0,#1
000a92  f7fffffe          BL       SDIO_ClockCmd
;;;554    
;;;555      /*!< CMD0: GO_IDLE_STATE ---------------------------------------------------*/
;;;556      /*!< No CMD response required */
;;;557      SDIO_CmdInitStructure.SDIO_Argument = 0x0;
000a96  4620              MOV      r0,r4
000a98  4976              LDR      r1,|L1.3188|
000a9a  6008              STR      r0,[r1,#0]  ; SDIO_CmdInitStructure
;;;558      SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_GO_IDLE_STATE;
000a9c  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;559      SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_No;
000a9e  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;560      SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
000aa0  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;561      SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
000aa2  f44f6080          MOV      r0,#0x400
000aa6  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;562      SDIO_SendCommand(&SDIO_CmdInitStructure);
000aa8  4608              MOV      r0,r1
000aaa  f7fffffe          BL       SDIO_SendCommand
;;;563    
;;;564      errorstatus = CmdError();
000aae  f7fffffe          BL       CmdError
000ab2  4604              MOV      r4,r0
;;;565    
;;;566      if (errorstatus != SD_OK)
000ab4  b114              CBZ      r4,|L1.2748|
;;;567      {
;;;568        /*!< CMD Response TimeOut (wait for CMDSENT flag) */
;;;569        return(errorstatus);
000ab6  4620              MOV      r0,r4
                  |L1.2744|
;;;570      }
;;;571    
;;;572      /*!< CMD8: SEND_IF_COND ----------------------------------------------------*/
;;;573      /*!< Send CMD8 to verify SD card interface operating condition */
;;;574      /*!< Argument: - [31:12]: Reserved (shall be set to '0')
;;;575                   - [11:8]: Supply Voltage (VHS) 0x1 (Range: 2.7-3.6 V)
;;;576                   - [7:0]: Check Pattern (recommended 0xAA) */
;;;577      /*!< CMD Response: R7 */
;;;578      SDIO_CmdInitStructure.SDIO_Argument = SD_CHECK_PATTERN;
;;;579      SDIO_CmdInitStructure.SDIO_CmdIndex = SDIO_SEND_IF_COND;
;;;580      SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;581      SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;582      SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;583      SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;584    
;;;585      errorstatus = CmdResp7Error();
;;;586    
;;;587      if (errorstatus == SD_OK)
;;;588      {
;;;589        CardType = SDIO_STD_CAPACITY_SD_CARD_V2_0; /*!< SD Card 2.0 */
;;;590        SDType = SD_HIGH_CAPACITY;
;;;591      }
;;;592      else
;;;593      {
;;;594        /*!< CMD55 */
;;;595        SDIO_CmdInitStructure.SDIO_Argument = 0x00;
;;;596        SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;597        SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;598        SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;599        SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;600        SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;601        errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;602      }
;;;603      /*!< CMD55 */
;;;604      SDIO_CmdInitStructure.SDIO_Argument = 0x00;
;;;605      SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;606      SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;607      SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;608      SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;609      SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;610      errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;611    
;;;612      /*!< If errorstatus is Command TimeOut, it is a MMC card */
;;;613      /*!< If errorstatus is SD_OK it is a SD card: SD card 2.0 (voltage range mismatch)
;;;614         or SD card 1.x */
;;;615      if (errorstatus == SD_OK)
;;;616      {
;;;617        /*!< SD CARD */
;;;618        /*!< Send ACMD41 SD_APP_OP_COND with Argument 0x80100000 */
;;;619        while ((!validvoltage) && (count < SD_MAX_VOLT_TRIAL))
;;;620        {
;;;621    
;;;622          /*!< SEND CMD55 APP_CMD with RCA as 0 */
;;;623          SDIO_CmdInitStructure.SDIO_Argument = 0x00;
;;;624          SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;625          SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;626          SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;627          SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;628          SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;629    
;;;630          errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;631    
;;;632          if (errorstatus != SD_OK)
;;;633          {
;;;634            return(errorstatus);
;;;635          }
;;;636          SDIO_CmdInitStructure.SDIO_Argument = SD_VOLTAGE_WINDOW_SD | SDType;
;;;637          SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_OP_COND;
;;;638          SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;639          SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;640          SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;641          SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;642    
;;;643          errorstatus = CmdResp3Error();
;;;644          if (errorstatus != SD_OK)
;;;645          {
;;;646            return(errorstatus);
;;;647          }
;;;648    
;;;649          response = SDIO_GetResponse(SDIO_RESP1);
;;;650          validvoltage = (((response >> 31) == 1) ? 1 : 0);
;;;651          count++;
;;;652        }
;;;653        if (count >= SD_MAX_VOLT_TRIAL)
;;;654        {
;;;655          errorstatus = SD_INVALID_VOLTRANGE;
;;;656          return(errorstatus);
;;;657        }
;;;658    
;;;659        if (response &= SD_HIGH_CAPACITY)
;;;660        {
;;;661          CardType = SDIO_HIGH_CAPACITY_SD_CARD;
;;;662        }
;;;663    
;;;664      }/*!< else MMC Card */
;;;665    
;;;666      return(errorstatus);
;;;667    }
000ab8  e8bd81f0          POP      {r4-r8,pc}
                  |L1.2748|
000abc  f44f70d5          MOV      r0,#0x1aa             ;578
000ac0  496c              LDR      r1,|L1.3188|
000ac2  6008              STR      r0,[r1,#0]            ;578  ; SDIO_CmdInitStructure
000ac4  f04f0008          MOV      r0,#8                 ;579
000ac8  6048              STR      r0,[r1,#4]            ;579  ; SDIO_CmdInitStructure
000aca  f04f0040          MOV      r0,#0x40              ;580
000ace  6088              STR      r0,[r1,#8]            ;580  ; SDIO_CmdInitStructure
000ad0  f04f0000          MOV      r0,#0                 ;581
000ad4  60c8              STR      r0,[r1,#0xc]          ;581  ; SDIO_CmdInitStructure
000ad6  f44f6080          MOV      r0,#0x400             ;582
000ada  6108              STR      r0,[r1,#0x10]         ;582  ; SDIO_CmdInitStructure
000adc  4608              MOV      r0,r1                 ;583
000ade  f7fffffe          BL       SDIO_SendCommand
000ae2  f7fffffe          BL       CmdResp7Error
000ae6  4604              MOV      r4,r0                 ;585
000ae8  b934              CBNZ     r4,|L1.2808|
000aea  f04f0001          MOV      r0,#1                 ;589
000aee  4960              LDR      r1,|L1.3184|
000af0  6008              STR      r0,[r1,#0]            ;589  ; CardType
000af2  f04f4880          MOV      r8,#0x40000000        ;590
000af6  e016              B        |L1.2854|
                  |L1.2808|
000af8  f04f0000          MOV      r0,#0                 ;595
000afc  495d              LDR      r1,|L1.3188|
000afe  6008              STR      r0,[r1,#0]            ;595  ; SDIO_CmdInitStructure
000b00  f04f0037          MOV      r0,#0x37              ;596
000b04  6048              STR      r0,[r1,#4]            ;596  ; SDIO_CmdInitStructure
000b06  f04f0040          MOV      r0,#0x40              ;597
000b0a  6088              STR      r0,[r1,#8]            ;597  ; SDIO_CmdInitStructure
000b0c  f04f0000          MOV      r0,#0                 ;598
000b10  60c8              STR      r0,[r1,#0xc]          ;598  ; SDIO_CmdInitStructure
000b12  f44f6080          MOV      r0,#0x400             ;599
000b16  6108              STR      r0,[r1,#0x10]         ;599  ; SDIO_CmdInitStructure
000b18  4608              MOV      r0,r1                 ;600
000b1a  f7fffffe          BL       SDIO_SendCommand
000b1e  2037              MOVS     r0,#0x37              ;601
000b20  f7fffffe          BL       CmdResp1Error
000b24  4604              MOV      r4,r0                 ;601
                  |L1.2854|
000b26  f04f0000          MOV      r0,#0                 ;604
000b2a  4952              LDR      r1,|L1.3188|
000b2c  6008              STR      r0,[r1,#0]            ;604  ; SDIO_CmdInitStructure
000b2e  f04f0037          MOV      r0,#0x37              ;605
000b32  6048              STR      r0,[r1,#4]            ;605  ; SDIO_CmdInitStructure
000b34  f04f0040          MOV      r0,#0x40              ;606
000b38  6088              STR      r0,[r1,#8]            ;606  ; SDIO_CmdInitStructure
000b3a  f04f0000          MOV      r0,#0                 ;607
000b3e  60c8              STR      r0,[r1,#0xc]          ;607  ; SDIO_CmdInitStructure
000b40  f44f6080          MOV      r0,#0x400             ;608
000b44  6108              STR      r0,[r1,#0x10]         ;608  ; SDIO_CmdInitStructure
000b46  4608              MOV      r0,r1                 ;609
000b48  f7fffffe          BL       SDIO_SendCommand
000b4c  2037              MOVS     r0,#0x37              ;610
000b4e  f7fffffe          BL       CmdResp1Error
000b52  4604              MOV      r4,r0                 ;610
000b54  2c00              CMP      r4,#0                 ;615
000b56  d155              BNE      |L1.3076|
000b58  e03f              B        |L1.3034|
                  |L1.2906|
000b5a  f04f0000          MOV      r0,#0                 ;623
000b5e  4945              LDR      r1,|L1.3188|
000b60  6008              STR      r0,[r1,#0]            ;623  ; SDIO_CmdInitStructure
000b62  f04f0037          MOV      r0,#0x37              ;624
000b66  6048              STR      r0,[r1,#4]            ;624  ; SDIO_CmdInitStructure
000b68  f04f0040          MOV      r0,#0x40              ;625
000b6c  6088              STR      r0,[r1,#8]            ;625  ; SDIO_CmdInitStructure
000b6e  f04f0000          MOV      r0,#0                 ;626
000b72  60c8              STR      r0,[r1,#0xc]          ;626  ; SDIO_CmdInitStructure
000b74  f44f6080          MOV      r0,#0x400             ;627
000b78  6108              STR      r0,[r1,#0x10]         ;627  ; SDIO_CmdInitStructure
000b7a  4608              MOV      r0,r1                 ;628
000b7c  f7fffffe          BL       SDIO_SendCommand
000b80  2037              MOVS     r0,#0x37              ;630
000b82  f7fffffe          BL       CmdResp1Error
000b86  4604              MOV      r4,r0                 ;630
000b88  b10c              CBZ      r4,|L1.2958|
000b8a  4620              MOV      r0,r4                 ;634
000b8c  e794              B        |L1.2744|
                  |L1.2958|
000b8e  483f              LDR      r0,|L1.3212|
000b90  ea480000          ORR      r0,r8,r0              ;636
000b94  4937              LDR      r1,|L1.3188|
000b96  6008              STR      r0,[r1,#0]            ;636  ; SDIO_CmdInitStructure
000b98  f04f0029          MOV      r0,#0x29              ;637
000b9c  6048              STR      r0,[r1,#4]            ;637  ; SDIO_CmdInitStructure
000b9e  f04f0040          MOV      r0,#0x40              ;638
000ba2  6088              STR      r0,[r1,#8]            ;638  ; SDIO_CmdInitStructure
000ba4  f04f0000          MOV      r0,#0                 ;639
000ba8  60c8              STR      r0,[r1,#0xc]          ;639  ; SDIO_CmdInitStructure
000baa  f44f6080          MOV      r0,#0x400             ;640
000bae  6108              STR      r0,[r1,#0x10]         ;640  ; SDIO_CmdInitStructure
000bb0  4608              MOV      r0,r1                 ;641
000bb2  f7fffffe          BL       SDIO_SendCommand
000bb6  f7fffffe          BL       CmdResp3Error
000bba  4604              MOV      r4,r0                 ;643
000bbc  b10c              CBZ      r4,|L1.3010|
000bbe  4620              MOV      r0,r4                 ;646
000bc0  e77a              B        |L1.2744|
                  |L1.3010|
000bc2  2000              MOVS     r0,#0                 ;649
000bc4  f7fffffe          BL       SDIO_GetResponse
000bc8  4606              MOV      r6,r0                 ;649
000bca  f04f0001          MOV      r0,#1                 ;650
000bce  ea8070d6          EOR      r0,r0,r6,LSR #31      ;650
000bd2  f0800701          EOR      r7,r0,#1              ;650
000bd6  f1050501          ADD      r5,r5,#1              ;651
                  |L1.3034|
000bda  b91f              CBNZ     r7,|L1.3044|
000bdc  f64f70ff          MOV      r0,#0xffff            ;619
000be0  4285              CMP      r5,r0                 ;619
000be2  d3ba              BCC      |L1.2906|
                  |L1.3044|
000be4  f64f70ff          MOV      r0,#0xffff            ;653
000be8  4285              CMP      r5,r0                 ;653
000bea  d303              BCC      |L1.3060|
000bec  f04f041b          MOV      r4,#0x1b              ;655
000bf0  4620              MOV      r0,r4                 ;656
000bf2  e761              B        |L1.2744|
                  |L1.3060|
000bf4  f0064080          AND      r0,r6,#0x40000000     ;659
000bf8  0006              MOVS     r6,r0                 ;659
000bfa  d003              BEQ      |L1.3076|
000bfc  f04f0002          MOV      r0,#2                 ;661
000c00  491b              LDR      r1,|L1.3184|
000c02  6008              STR      r0,[r1,#0]            ;661  ; CardType
                  |L1.3076|
000c04  4620              MOV      r0,r4                 ;666
000c06  e757              B        |L1.2744|
;;;668    
                          ENDP

                  SD_Init PROC
;;;399      */
;;;400    SD_Error SD_Init(void)
000c08  b510              PUSH     {r4,lr}
;;;401    {
;;;402      __IO SD_Error errorstatus = SD_OK;
000c0a  f04f0400          MOV      r4,#0
;;;403      
;;;404      /* SDIO Peripheral Low Level Init */
;;;405      SD_LowLevel_Init();
000c0e  f7fffffe          BL       SD_LowLevel_Init
;;;406    
;;;407      SDIO_DeInit();
000c12  f7fffffe          BL       SDIO_DeInit
;;;408    
;;;409      errorstatus = SD_PowerON();
000c16  f7fffffe          BL       SD_PowerON
000c1a  4604              MOV      r4,r0
;;;410    
;;;411      if (errorstatus != SD_OK)
000c1c  b10c              CBZ      r4,|L1.3106|
;;;412      {
;;;413        /*!< CMD Response TimeOut (wait for CMDSENT flag) */
;;;414        return(errorstatus);
000c1e  4620              MOV      r0,r4
                  |L1.3104|
;;;415      }
;;;416    
;;;417      errorstatus = SD_InitializeCards();
;;;418    
;;;419      if (errorstatus != SD_OK)
;;;420      {
;;;421        /*!< CMD Response TimeOut (wait for CMDSENT flag) */
;;;422        return(errorstatus);
;;;423      }
;;;424    
;;;425      /*!< Configure the SDIO peripheral */
;;;426      /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_TRANSFER_CLK_DIV) */
;;;427      /*!< on STM32F2xx devices, SDIOCLK is fixed to 48MHz */  
;;;428      SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
;;;429      SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
;;;430      SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
;;;431      SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
;;;432      SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
;;;433      SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
;;;434      SDIO_Init(&SDIO_InitStructure);
;;;435      
;;;436      /*----------------- Read CSD/CID MSD registers ------------------*/
;;;437      errorstatus = SD_GetCardInfo(&SDCardInfo);
;;;438    
;;;439      if (errorstatus == SD_OK)
;;;440      {
;;;441        /*----------------- Select Card --------------------------------*/
;;;442        errorstatus = SD_SelectDeselect((uint32_t) (SDCardInfo.RCA << 16));
;;;443      }
;;;444    
;;;445      if (errorstatus == SD_OK)
;;;446      {
;;;447        errorstatus = SD_EnableWideBusOperation(SDIO_BusWide_4b);
;;;448      }  
;;;449    
;;;450      return(errorstatus);
;;;451    }
000c20  bd10              POP      {r4,pc}
                  |L1.3106|
000c22  f7fffffe          BL       SD_InitializeCards
000c26  4604              MOV      r4,r0                 ;417
000c28  b10c              CBZ      r4,|L1.3118|
000c2a  4620              MOV      r0,r4                 ;422
000c2c  e7f8              B        |L1.3104|
                  |L1.3118|
000c2e  f04f0000          MOV      r0,#0                 ;428
000c32  4915              LDR      r1,|L1.3208|
000c34  7508              STRB     r0,[r1,#0x14]         ;428
000c36  6008              STR      r0,[r1,#0]            ;429  ; SDIO_InitStructure
000c38  6048              STR      r0,[r1,#4]            ;430  ; SDIO_InitStructure
000c3a  6088              STR      r0,[r1,#8]            ;431  ; SDIO_InitStructure
000c3c  60c8              STR      r0,[r1,#0xc]          ;432  ; SDIO_InitStructure
000c3e  6108              STR      r0,[r1,#0x10]         ;433  ; SDIO_InitStructure
000c40  4608              MOV      r0,r1                 ;434
000c42  f7fffffe          BL       SDIO_Init
000c46  4812              LDR      r0,|L1.3216|
000c48  f7fffffe          BL       SD_GetCardInfo
000c4c  4604              MOV      r4,r0                 ;437
000c4e  b934              CBNZ     r4,|L1.3166|
000c50  490f              LDR      r1,|L1.3216|
000c52  f8b1104c          LDRH     r1,[r1,#0x4c]         ;442  ; SDCardInfo
000c56  0408              LSLS     r0,r1,#16             ;442
000c58  f7fffffe          BL       SD_SelectDeselect
000c5c  4604              MOV      r4,r0                 ;442
                  |L1.3166|
000c5e  b924              CBNZ     r4,|L1.3178|
000c60  f44f6000          MOV      r0,#0x800             ;447
000c64  f7fffffe          BL       SD_EnableWideBusOperation
000c68  4604              MOV      r4,r0                 ;447
                  |L1.3178|
000c6a  4620              MOV      r0,r4                 ;450
000c6c  e7d8              B        |L1.3104|
000c6e  0000              DCW      0x0000
                  |L1.3184|
                          DCD      CardType
                  |L1.3188|
                          DCD      SDIO_CmdInitStructure
                  |L1.3192|
                          DCD      CID_Tab
                  |L1.3196|
                          DCD      ||RCA||
                  |L1.3200|
                          DCD      CSD_Tab
                  |L1.3204|
                          DCD      0x40012c34
                  |L1.3208|
                          DCD      SDIO_InitStructure
                  |L1.3212|
                          DCD      0x80100000
                  |L1.3216|
                          DCD      SDCardInfo
                          ENDP

                  SD_SendStatus PROC
;;;1787     */
;;;1788   SD_Error SD_SendStatus(uint32_t *pcardstatus)
000c94  b510              PUSH     {r4,lr}
;;;1789   {
000c96  4603              MOV      r3,r0
;;;1790     SD_Error errorstatus = SD_OK;
000c98  f04f0400          MOV      r4,#0
;;;1791   
;;;1792     SDIO->ARG = (uint32_t) RCA << 16;
000c9c  48fd              LDR      r0,|L1.4244|
000c9e  6800              LDR      r0,[r0,#0]  ; RCA
000ca0  ea4f4000          LSL      r0,r0,#16
000ca4  49fc              LDR      r1,|L1.4248|
000ca6  6008              STR      r0,[r1,#0]
;;;1793     SDIO->CMD = 0x44D;
000ca8  f240404d          MOV      r0,#0x44d
000cac  f1010104          ADD      r1,r1,#4
000cb0  6008              STR      r0,[r1,#0]
;;;1794     
;;;1795     errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
000cb2  f04f000d          MOV      r0,#0xd
000cb6  f7fffffe          BL       CmdResp1Error
000cba  4604              MOV      r4,r0
;;;1796   
;;;1797     if (errorstatus != SD_OK)
000cbc  b10c              CBZ      r4,|L1.3266|
;;;1798     {
;;;1799       return(errorstatus);
000cbe  4620              MOV      r0,r4
                  |L1.3264|
;;;1800     }
;;;1801   
;;;1802     *pcardstatus = SDIO->RESP1;
;;;1803     return(errorstatus);
;;;1804   }
000cc0  bd10              POP      {r4,pc}
                  |L1.3266|
000cc2  48f6              LDR      r0,|L1.4252|
000cc4  6800              LDR      r0,[r0,#0]            ;1802
000cc6  6018              STR      r0,[r3,#0]            ;1802
000cc8  4620              MOV      r0,r4                 ;1803
000cca  e7f9              B        |L1.3264|
;;;1805   
                          ENDP

                  SD_Detect PROC
;;;511     */
;;;512    uint8_t SD_Detect(void)
000ccc  b510              PUSH     {r4,lr}
;;;513    {
;;;514      __IO uint8_t status = SD_PRESENT;
000cce  f04f0401          MOV      r4,#1
;;;515    
;;;516      /*!< Check GPIO to detect SD */
;;;517      if (GPIO_ReadInputDataBit(SD_DETECT_GPIO_PORT, SD_DETECT_PIN) != Bit_RESET)
000cd2  f44f4100          MOV      r1,#0x8000
000cd6  48f2              LDR      r0,|L1.4256|
000cd8  f7fffffe          BL       GPIO_ReadInputDataBit
000cdc  b108              CBZ      r0,|L1.3298|
;;;518      {
;;;519        status = SD_NOT_PRESENT;
000cde  f04f0400          MOV      r4,#0
                  |L1.3298|
;;;520      }
;;;521      return status;
000ce2  4620              MOV      r0,r4
;;;522    }
000ce4  bd10              POP      {r4,pc}
;;;523    
                          ENDP

                  SD_GetState PROC
;;;485      */
;;;486    SDCardState SD_GetState(void)
000ce6  b508              PUSH     {r3,lr}
;;;487    {
;;;488      uint32_t resp1 = 0;
000ce8  f04f0000          MOV      r0,#0
000cec  9000              STR      r0,[sp,#0]
;;;489      
;;;490      if(SD_Detect()== SD_PRESENT)
000cee  f7fffffe          BL       SD_Detect
000cf2  2801              CMP      r0,#1
000cf4  d109              BNE      |L1.3338|
;;;491      {
;;;492        if (SD_SendStatus(&resp1) != SD_OK)
000cf6  4668              MOV      r0,sp
000cf8  f7fffffe          BL       SD_SendStatus
000cfc  b108              CBZ      r0,|L1.3330|
;;;493        {
;;;494          return SD_CARD_ERROR;
000cfe  20ff              MOVS     r0,#0xff
                  |L1.3328|
;;;495        }
;;;496        else
;;;497        {
;;;498          return (SDCardState)((resp1 >> 9) & 0x0F);
;;;499        }
;;;500      }
;;;501      else
;;;502      {
;;;503        return SD_CARD_ERROR;
;;;504      }
;;;505    }
000d00  bd08              POP      {r3,pc}
                  |L1.3330|
000d02  9800              LDR      r0,[sp,#0]            ;498
000d04  f3c02043          UBFX     r0,r0,#9,#4           ;498
000d08  e7fa              B        |L1.3328|
                  |L1.3338|
000d0a  20ff              MOVS     r0,#0xff              ;503
000d0c  e7f8              B        |L1.3328|
;;;506    
                          ENDP

                  SD_GetStatus PROC
;;;460      */
;;;461    SDTransferState SD_GetStatus(void)
000d0e  b510              PUSH     {r4,lr}
;;;462    {
;;;463      SDCardState cardstate =  SD_CARD_TRANSFER;
000d10  f04f0404          MOV      r4,#4
;;;464    
;;;465      cardstate = SD_GetState();
000d14  f7fffffe          BL       SD_GetState
000d18  4604              MOV      r4,r0
;;;466      
;;;467      if (cardstate == SD_CARD_TRANSFER)
000d1a  2c04              CMP      r4,#4
000d1c  d101              BNE      |L1.3362|
;;;468      {
;;;469        return(SD_TRANSFER_OK);
000d1e  2000              MOVS     r0,#0
                  |L1.3360|
;;;470      }
;;;471      else if(cardstate == SD_CARD_ERROR)
;;;472      {
;;;473        return (SD_TRANSFER_ERROR);
;;;474      }
;;;475      else
;;;476      {
;;;477        return(SD_TRANSFER_BUSY);
;;;478      }
;;;479    }
000d20  bd10              POP      {r4,pc}
                  |L1.3362|
000d22  2cff              CMP      r4,#0xff              ;471
000d24  d101              BNE      |L1.3370|
000d26  2002              MOVS     r0,#2                 ;473
000d28  e7fa              B        |L1.3360|
                  |L1.3370|
000d2a  2001              MOVS     r0,#1                 ;477
000d2c  e7f8              B        |L1.3360|
;;;480    
                          ENDP

                  SD_PowerOFF PROC
;;;673      */
;;;674    SD_Error SD_PowerOFF(void)
000d2e  b510              PUSH     {r4,lr}
;;;675    {
;;;676      SD_Error errorstatus = SD_OK;
000d30  f04f0400          MOV      r4,#0
;;;677    
;;;678      /*!< Set Power State to OFF */
;;;679      SDIO_SetPowerState(SDIO_PowerState_OFF);
000d34  4620              MOV      r0,r4
000d36  f7fffffe          BL       SDIO_SetPowerState
;;;680    
;;;681      return(errorstatus);
000d3a  4620              MOV      r0,r4
;;;682    }
000d3c  bd10              POP      {r4,pc}
;;;683    
                          ENDP

                  SD_SendSDStatus PROC
;;;1811     */
;;;1812   SD_Error SD_SendSDStatus(uint32_t *psdstatus)
000d3e  b570              PUSH     {r4-r6,lr}
;;;1813   {
000d40  4604              MOV      r4,r0
;;;1814     SD_Error errorstatus = SD_OK;
000d42  f04f0500          MOV      r5,#0
;;;1815     uint32_t count = 0;
000d46  462e              MOV      r6,r5
;;;1816   
;;;1817     if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
000d48  4628              MOV      r0,r5
000d4a  f7fffffe          BL       SDIO_GetResponse
000d4e  f0107f00          TST      r0,#0x2000000
000d52  d003              BEQ      |L1.3420|
;;;1818     {
;;;1819       errorstatus = SD_LOCK_UNLOCK_FAILED;
000d54  f04f050e          MOV      r5,#0xe
;;;1820       return(errorstatus);
000d58  4628              MOV      r0,r5
                  |L1.3418|
;;;1821     }
;;;1822   
;;;1823     /*!< Set block size for card if it is not equal to current block size for card. */
;;;1824     SDIO_CmdInitStructure.SDIO_Argument = 64;
;;;1825     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
;;;1826     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1827     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1828     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1829     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1830   
;;;1831     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
;;;1832   
;;;1833     if (errorstatus != SD_OK)
;;;1834     {
;;;1835       return(errorstatus);
;;;1836     }
;;;1837   
;;;1838     /*!< CMD55 */
;;;1839     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
;;;1840     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
;;;1841     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1842     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1843     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1844     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1845     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
;;;1846   
;;;1847     if (errorstatus != SD_OK)
;;;1848     {
;;;1849       return(errorstatus);
;;;1850     }
;;;1851   
;;;1852     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
;;;1853     SDIO_DataInitStructure.SDIO_DataLength = 64;
;;;1854     SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_64b;
;;;1855     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
;;;1856     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
;;;1857     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
;;;1858     SDIO_DataConfig(&SDIO_DataInitStructure);
;;;1859   
;;;1860     /*!< Send ACMD13 SD_APP_STAUS  with argument as card's RCA.*/
;;;1861     SDIO_CmdInitStructure.SDIO_Argument = 0;
;;;1862     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_STAUS;
;;;1863     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1864     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1865     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1866     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1867     errorstatus = CmdResp1Error(SD_CMD_SD_APP_STAUS);
;;;1868   
;;;1869     if (errorstatus != SD_OK)
;;;1870     {
;;;1871       return(errorstatus);
;;;1872     }
;;;1873   
;;;1874     while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCKEND | SDIO_FLAG_STBITERR)))
;;;1875     {
;;;1876       if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
;;;1877       {
;;;1878         for (count = 0; count < 8; count++)
;;;1879         {
;;;1880           *(psdstatus + count) = SDIO_ReadData();
;;;1881         }
;;;1882         psdstatus += 8;
;;;1883       }
;;;1884     }
;;;1885   
;;;1886     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
;;;1887     {
;;;1888       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
;;;1889       errorstatus = SD_DATA_TIMEOUT;
;;;1890       return(errorstatus);
;;;1891     }
;;;1892     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
;;;1893     {
;;;1894       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
;;;1895       errorstatus = SD_DATA_CRC_FAIL;
;;;1896       return(errorstatus);
;;;1897     }
;;;1898     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
;;;1899     {
;;;1900       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
;;;1901       errorstatus = SD_RX_OVERRUN;
;;;1902       return(errorstatus);
;;;1903     }
;;;1904     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
;;;1905     {
;;;1906       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
;;;1907       errorstatus = SD_START_BIT_ERR;
;;;1908       return(errorstatus);
;;;1909     }
;;;1910   
;;;1911     while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
;;;1912     {
;;;1913       *psdstatus = SDIO_ReadData();
;;;1914       psdstatus++;
;;;1915     }
;;;1916   
;;;1917     /*!< Clear all the static status flags*/
;;;1918     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;1919   
;;;1920     return(errorstatus);
;;;1921   }
000d5a  bd70              POP      {r4-r6,pc}
                  |L1.3420|
000d5c  f04f0040          MOV      r0,#0x40              ;1824
000d60  49d0              LDR      r1,|L1.4260|
000d62  6008              STR      r0,[r1,#0]            ;1824  ; SDIO_CmdInitStructure
000d64  f04f0010          MOV      r0,#0x10              ;1825
000d68  6048              STR      r0,[r1,#4]            ;1825  ; SDIO_CmdInitStructure
000d6a  f04f0040          MOV      r0,#0x40              ;1826
000d6e  6088              STR      r0,[r1,#8]            ;1826  ; SDIO_CmdInitStructure
000d70  f04f0000          MOV      r0,#0                 ;1827
000d74  60c8              STR      r0,[r1,#0xc]          ;1827  ; SDIO_CmdInitStructure
000d76  f44f6080          MOV      r0,#0x400             ;1828
000d7a  6108              STR      r0,[r1,#0x10]         ;1828  ; SDIO_CmdInitStructure
000d7c  4608              MOV      r0,r1                 ;1829
000d7e  f7fffffe          BL       SDIO_SendCommand
000d82  2010              MOVS     r0,#0x10              ;1831
000d84  f7fffffe          BL       CmdResp1Error
000d88  4605              MOV      r5,r0                 ;1831
000d8a  b10d              CBZ      r5,|L1.3472|
000d8c  4628              MOV      r0,r5                 ;1835
000d8e  e7e4              B        |L1.3418|
                  |L1.3472|
000d90  48c0              LDR      r0,|L1.4244|
000d92  6800              LDR      r0,[r0,#0]            ;1839  ; RCA
000d94  ea4f4000          LSL      r0,r0,#16             ;1839
000d98  49c2              LDR      r1,|L1.4260|
000d9a  6008              STR      r0,[r1,#0]            ;1839  ; SDIO_CmdInitStructure
000d9c  f04f0037          MOV      r0,#0x37              ;1840
000da0  6048              STR      r0,[r1,#4]            ;1840  ; SDIO_CmdInitStructure
000da2  f04f0040          MOV      r0,#0x40              ;1841
000da6  6088              STR      r0,[r1,#8]            ;1841  ; SDIO_CmdInitStructure
000da8  f04f0000          MOV      r0,#0                 ;1842
000dac  60c8              STR      r0,[r1,#0xc]          ;1842  ; SDIO_CmdInitStructure
000dae  f44f6080          MOV      r0,#0x400             ;1843
000db2  6108              STR      r0,[r1,#0x10]         ;1843  ; SDIO_CmdInitStructure
000db4  4608              MOV      r0,r1                 ;1844
000db6  f7fffffe          BL       SDIO_SendCommand
000dba  2037              MOVS     r0,#0x37              ;1845
000dbc  f7fffffe          BL       CmdResp1Error
000dc0  4605              MOV      r5,r0                 ;1845
000dc2  b10d              CBZ      r5,|L1.3528|
000dc4  4628              MOV      r0,r5                 ;1849
000dc6  e7c8              B        |L1.3418|
                  |L1.3528|
000dc8  f04f30ff          MOV      r0,#0xffffffff        ;1852
000dcc  49b6              LDR      r1,|L1.4264|
000dce  6008              STR      r0,[r1,#0]            ;1852  ; SDIO_DataInitStructure
000dd0  f04f0040          MOV      r0,#0x40              ;1853
000dd4  6048              STR      r0,[r1,#4]            ;1853  ; SDIO_DataInitStructure
000dd6  f04f0060          MOV      r0,#0x60              ;1854
000dda  6088              STR      r0,[r1,#8]            ;1854  ; SDIO_DataInitStructure
000ddc  f04f0002          MOV      r0,#2                 ;1855
000de0  60c8              STR      r0,[r1,#0xc]          ;1855  ; SDIO_DataInitStructure
000de2  f04f0000          MOV      r0,#0                 ;1856
000de6  6108              STR      r0,[r1,#0x10]         ;1856  ; SDIO_DataInitStructure
000de8  f04f0001          MOV      r0,#1                 ;1857
000dec  6148              STR      r0,[r1,#0x14]         ;1857  ; SDIO_DataInitStructure
000dee  4608              MOV      r0,r1                 ;1858
000df0  f7fffffe          BL       SDIO_DataConfig
000df4  f04f0000          MOV      r0,#0                 ;1861
000df8  49aa              LDR      r1,|L1.4260|
000dfa  6008              STR      r0,[r1,#0]            ;1861  ; SDIO_CmdInitStructure
000dfc  f04f000d          MOV      r0,#0xd               ;1862
000e00  6048              STR      r0,[r1,#4]            ;1862  ; SDIO_CmdInitStructure
000e02  f04f0040          MOV      r0,#0x40              ;1863
000e06  6088              STR      r0,[r1,#8]            ;1863  ; SDIO_CmdInitStructure
000e08  f04f0000          MOV      r0,#0                 ;1864
000e0c  60c8              STR      r0,[r1,#0xc]          ;1864  ; SDIO_CmdInitStructure
000e0e  f44f6080          MOV      r0,#0x400             ;1865
000e12  6108              STR      r0,[r1,#0x10]         ;1865  ; SDIO_CmdInitStructure
000e14  4608              MOV      r0,r1                 ;1866
000e16  f7fffffe          BL       SDIO_SendCommand
000e1a  200d              MOVS     r0,#0xd               ;1867
000e1c  f7fffffe          BL       CmdResp1Error
000e20  4605              MOV      r5,r0                 ;1867
000e22  b10d              CBZ      r5,|L1.3624|
000e24  4628              MOV      r0,r5                 ;1871
000e26  e798              B        |L1.3418|
                  |L1.3624|
000e28  e011              B        |L1.3662|
                  |L1.3626|
000e2a  f44f4000          MOV      r0,#0x8000            ;1876
000e2e  f7fffffe          BL       SDIO_GetFlagStatus
000e32  b160              CBZ      r0,|L1.3662|
000e34  f04f0600          MOV      r6,#0                 ;1878
000e38  e005              B        |L1.3654|
                  |L1.3642|
000e3a  f7fffffe          BL       SDIO_ReadData
000e3e  f8440026          STR      r0,[r4,r6,LSL #2]     ;1880
000e42  f1060601          ADD      r6,r6,#1              ;1878
                  |L1.3654|
000e46  2e08              CMP      r6,#8                 ;1878
000e48  d3f7              BCC      |L1.3642|
000e4a  f1040420          ADD      r4,r4,#0x20           ;1882
                  |L1.3662|
000e4e  4893              LDR      r0,|L1.4252|
000e50  3020              ADDS     r0,r0,#0x20           ;1874
000e52  6800              LDR      r0,[r0,#0]            ;1874
000e54  f240612a          MOV      r1,#0x62a             ;1874
000e58  4208              TST      r0,r1                 ;1874
000e5a  d0e6              BEQ      |L1.3626|
000e5c  2008              MOVS     r0,#8                 ;1886
000e5e  f7fffffe          BL       SDIO_GetFlagStatus
000e62  b130              CBZ      r0,|L1.3698|
000e64  2008              MOVS     r0,#8                 ;1888
000e66  f7fffffe          BL       SDIO_ClearFlag
000e6a  f04f0504          MOV      r5,#4                 ;1889
000e6e  4628              MOV      r0,r5                 ;1890
000e70  e773              B        |L1.3418|
                  |L1.3698|
000e72  2002              MOVS     r0,#2                 ;1892
000e74  f7fffffe          BL       SDIO_GetFlagStatus
000e78  b130              CBZ      r0,|L1.3720|
000e7a  2002              MOVS     r0,#2                 ;1894
000e7c  f7fffffe          BL       SDIO_ClearFlag
000e80  f04f0502          MOV      r5,#2                 ;1895
000e84  4628              MOV      r0,r5                 ;1896
000e86  e768              B        |L1.3418|
                  |L1.3720|
000e88  2020              MOVS     r0,#0x20              ;1898
000e8a  f7fffffe          BL       SDIO_GetFlagStatus
000e8e  b130              CBZ      r0,|L1.3742|
000e90  2020              MOVS     r0,#0x20              ;1900
000e92  f7fffffe          BL       SDIO_ClearFlag
000e96  f04f0506          MOV      r5,#6                 ;1901
000e9a  4628              MOV      r0,r5                 ;1902
000e9c  e75d              B        |L1.3418|
                  |L1.3742|
000e9e  f44f7000          MOV      r0,#0x200             ;1904
000ea2  f7fffffe          BL       SDIO_GetFlagStatus
000ea6  b138              CBZ      r0,|L1.3768|
000ea8  f44f7000          MOV      r0,#0x200             ;1906
000eac  f7fffffe          BL       SDIO_ClearFlag
000eb0  f04f0507          MOV      r5,#7                 ;1907
000eb4  4628              MOV      r0,r5                 ;1908
000eb6  e750              B        |L1.3418|
                  |L1.3768|
000eb8  e004              B        |L1.3780|
                  |L1.3770|
000eba  f7fffffe          BL       SDIO_ReadData
000ebe  6020              STR      r0,[r4,#0]            ;1913
000ec0  f1040404          ADD      r4,r4,#4              ;1914
                  |L1.3780|
000ec4  f44f1000          MOV      r0,#0x200000          ;1911
000ec8  f7fffffe          BL       SDIO_GetFlagStatus
000ecc  2800              CMP      r0,#0                 ;1911
000ece  d1f4              BNE      |L1.3770|
000ed0  f24050ff          MOV      r0,#0x5ff             ;1918
000ed4  f7fffffe          BL       SDIO_ClearFlag
000ed8  4628              MOV      r0,r5                 ;1920
000eda  e73e              B        |L1.3418|
;;;1922   
                          ENDP

                  SD_GetCardStatus PROC
;;;993      */
;;;994    SD_Error SD_GetCardStatus(SD_CardStatus *cardstatus)
000edc  b570              PUSH     {r4-r6,lr}
;;;995    {
000ede  4604              MOV      r4,r0
;;;996      SD_Error errorstatus = SD_OK;
000ee0  f04f0600          MOV      r6,#0
;;;997      uint8_t tmp = 0;
000ee4  4635              MOV      r5,r6
;;;998    
;;;999      errorstatus = SD_SendSDStatus((uint32_t *)SDSTATUS_Tab);
000ee6  4871              LDR      r0,|L1.4268|
000ee8  f7fffffe          BL       SD_SendSDStatus
000eec  4606              MOV      r6,r0
;;;1000   
;;;1001     if (errorstatus  != SD_OK)
000eee  b10e              CBZ      r6,|L1.3828|
;;;1002     {
;;;1003       return(errorstatus);
000ef0  4630              MOV      r0,r6
                  |L1.3826|
;;;1004     }
;;;1005   
;;;1006     /*!< Byte 0 */
;;;1007     tmp = (uint8_t)((SDSTATUS_Tab[0] & 0xC0) >> 6);
;;;1008     cardstatus->DAT_BUS_WIDTH = tmp;
;;;1009   
;;;1010     /*!< Byte 0 */
;;;1011     tmp = (uint8_t)((SDSTATUS_Tab[0] & 0x20) >> 5);
;;;1012     cardstatus->SECURED_MODE = tmp;
;;;1013   
;;;1014     /*!< Byte 2 */
;;;1015     tmp = (uint8_t)((SDSTATUS_Tab[2] & 0xFF));
;;;1016     cardstatus->SD_CARD_TYPE = tmp << 8;
;;;1017   
;;;1018     /*!< Byte 3 */
;;;1019     tmp = (uint8_t)((SDSTATUS_Tab[3] & 0xFF));
;;;1020     cardstatus->SD_CARD_TYPE |= tmp;
;;;1021   
;;;1022     /*!< Byte 4 */
;;;1023     tmp = (uint8_t)(SDSTATUS_Tab[4] & 0xFF);
;;;1024     cardstatus->SIZE_OF_PROTECTED_AREA = tmp << 24;
;;;1025   
;;;1026     /*!< Byte 5 */
;;;1027     tmp = (uint8_t)(SDSTATUS_Tab[5] & 0xFF);
;;;1028     cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 16;
;;;1029   
;;;1030     /*!< Byte 6 */
;;;1031     tmp = (uint8_t)(SDSTATUS_Tab[6] & 0xFF);
;;;1032     cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 8;
;;;1033   
;;;1034     /*!< Byte 7 */
;;;1035     tmp = (uint8_t)(SDSTATUS_Tab[7] & 0xFF);
;;;1036     cardstatus->SIZE_OF_PROTECTED_AREA |= tmp;
;;;1037   
;;;1038     /*!< Byte 8 */
;;;1039     tmp = (uint8_t)((SDSTATUS_Tab[8] & 0xFF));
;;;1040     cardstatus->SPEED_CLASS = tmp;
;;;1041   
;;;1042     /*!< Byte 9 */
;;;1043     tmp = (uint8_t)((SDSTATUS_Tab[9] & 0xFF));
;;;1044     cardstatus->PERFORMANCE_MOVE = tmp;
;;;1045   
;;;1046     /*!< Byte 10 */
;;;1047     tmp = (uint8_t)((SDSTATUS_Tab[10] & 0xF0) >> 4);
;;;1048     cardstatus->AU_SIZE = tmp;
;;;1049   
;;;1050     /*!< Byte 11 */
;;;1051     tmp = (uint8_t)(SDSTATUS_Tab[11] & 0xFF);
;;;1052     cardstatus->ERASE_SIZE = tmp << 8;
;;;1053   
;;;1054     /*!< Byte 12 */
;;;1055     tmp = (uint8_t)(SDSTATUS_Tab[12] & 0xFF);
;;;1056     cardstatus->ERASE_SIZE |= tmp;
;;;1057   
;;;1058     /*!< Byte 13 */
;;;1059     tmp = (uint8_t)((SDSTATUS_Tab[13] & 0xFC) >> 2);
;;;1060     cardstatus->ERASE_TIMEOUT = tmp;
;;;1061   
;;;1062     /*!< Byte 13 */
;;;1063     tmp = (uint8_t)((SDSTATUS_Tab[13] & 0x3));
;;;1064     cardstatus->ERASE_OFFSET = tmp;
;;;1065    
;;;1066     return(errorstatus);
;;;1067   }
000ef2  bd70              POP      {r4-r6,pc}
                  |L1.3828|
000ef4  486d              LDR      r0,|L1.4268|
000ef6  7800              LDRB     r0,[r0,#0]            ;1007  ; SDSTATUS_Tab
000ef8  ea4f1590          LSR      r5,r0,#6              ;1007
000efc  7025              STRB     r5,[r4,#0]            ;1008
000efe  486b              LDR      r0,|L1.4268|
000f00  7800              LDRB     r0,[r0,#0]            ;1011  ; SDSTATUS_Tab
000f02  f3c01540          UBFX     r5,r0,#5,#1           ;1011
000f06  7065              STRB     r5,[r4,#1]            ;1012
000f08  4868              LDR      r0,|L1.4268|
000f0a  7885              LDRB     r5,[r0,#2]            ;1015  ; SDSTATUS_Tab
000f0c  ea4f2005          LSL      r0,r5,#8              ;1016
000f10  8060              STRH     r0,[r4,#2]            ;1016
000f12  4866              LDR      r0,|L1.4268|
000f14  78c5              LDRB     r5,[r0,#3]            ;1019  ; SDSTATUS_Tab
000f16  8860              LDRH     r0,[r4,#2]            ;1020
000f18  ea400005          ORR      r0,r0,r5              ;1020
000f1c  8060              STRH     r0,[r4,#2]            ;1020
000f1e  4863              LDR      r0,|L1.4268|
000f20  7905              LDRB     r5,[r0,#4]            ;1023  ; SDSTATUS_Tab
000f22  ea4f6005          LSL      r0,r5,#24             ;1024
000f26  6060              STR      r0,[r4,#4]            ;1024
000f28  4860              LDR      r0,|L1.4268|
000f2a  7945              LDRB     r5,[r0,#5]            ;1027  ; SDSTATUS_Tab
000f2c  6860              LDR      r0,[r4,#4]            ;1028
000f2e  ea404005          ORR      r0,r0,r5,LSL #16      ;1028
000f32  6060              STR      r0,[r4,#4]            ;1028
000f34  485d              LDR      r0,|L1.4268|
000f36  7985              LDRB     r5,[r0,#6]            ;1031  ; SDSTATUS_Tab
000f38  6860              LDR      r0,[r4,#4]            ;1032
000f3a  ea402005          ORR      r0,r0,r5,LSL #8       ;1032
000f3e  6060              STR      r0,[r4,#4]            ;1032
000f40  485a              LDR      r0,|L1.4268|
000f42  79c5              LDRB     r5,[r0,#7]            ;1035  ; SDSTATUS_Tab
000f44  6860              LDR      r0,[r4,#4]            ;1036
000f46  ea400005          ORR      r0,r0,r5              ;1036
000f4a  6060              STR      r0,[r4,#4]            ;1036
000f4c  4857              LDR      r0,|L1.4268|
000f4e  7a05              LDRB     r5,[r0,#8]            ;1039  ; SDSTATUS_Tab
000f50  7225              STRB     r5,[r4,#8]            ;1040
000f52  7a45              LDRB     r5,[r0,#9]            ;1043  ; SDSTATUS_Tab
000f54  7265              STRB     r5,[r4,#9]            ;1044
000f56  7a80              LDRB     r0,[r0,#0xa]          ;1047  ; SDSTATUS_Tab
000f58  ea4f1510          LSR      r5,r0,#4              ;1047
000f5c  72a5              STRB     r5,[r4,#0xa]          ;1048
000f5e  4853              LDR      r0,|L1.4268|
000f60  7ac5              LDRB     r5,[r0,#0xb]          ;1051  ; SDSTATUS_Tab
000f62  ea4f2005          LSL      r0,r5,#8              ;1052
000f66  81a0              STRH     r0,[r4,#0xc]          ;1052
000f68  4850              LDR      r0,|L1.4268|
000f6a  7b05              LDRB     r5,[r0,#0xc]          ;1055  ; SDSTATUS_Tab
000f6c  89a0              LDRH     r0,[r4,#0xc]          ;1056
000f6e  ea400005          ORR      r0,r0,r5              ;1056
000f72  81a0              STRH     r0,[r4,#0xc]          ;1056
000f74  484d              LDR      r0,|L1.4268|
000f76  7b40              LDRB     r0,[r0,#0xd]          ;1059  ; SDSTATUS_Tab
000f78  ea4f0590          LSR      r5,r0,#2              ;1059
000f7c  73a5              STRB     r5,[r4,#0xe]          ;1060
000f7e  484b              LDR      r0,|L1.4268|
000f80  7b40              LDRB     r0,[r0,#0xd]          ;1063  ; SDSTATUS_Tab
000f82  f0000503          AND      r5,r0,#3              ;1063
000f86  73e5              STRB     r5,[r4,#0xf]          ;1064
000f88  4630              MOV      r0,r6                 ;1066
000f8a  e7b2              B        |L1.3826|
;;;1068   
                          ENDP

                  SD_ReadBlock PROC
;;;1176     */
;;;1177   SD_Error SD_ReadBlock(uint8_t *readbuff, uint32_t ReadAddr, uint16_t BlockSize)
000f8c  e92d41f0          PUSH     {r4-r8,lr}
;;;1178   {
000f90  4607              MOV      r7,r0
000f92  460c              MOV      r4,r1
000f94  4615              MOV      r5,r2
;;;1179     SD_Error errorstatus = SD_OK;
000f96  f04f0600          MOV      r6,#0
;;;1180   #if defined (SD_POLLING_MODE) 
;;;1181     uint32_t count = 0, *tempbuff = (uint32_t *)readbuff;
;;;1182   #endif
;;;1183   
;;;1184     TransferError = SD_OK;
000f9a  4630              MOV      r0,r6
000f9c  4944              LDR      r1,|L1.4272|
000f9e  7008              STRB     r0,[r1,#0]
;;;1185     TransferEnd = 0;
000fa0  4944              LDR      r1,|L1.4276|
000fa2  6008              STR      r0,[r1,#0]  ; TransferEnd
;;;1186     StopCondition = 0;
000fa4  4944              LDR      r1,|L1.4280|
000fa6  6008              STR      r0,[r1,#0]  ; StopCondition
;;;1187     
;;;1188     SDIO->DCTRL = 0x0;
000fa8  4944              LDR      r1,|L1.4284|
000faa  6008              STR      r0,[r1,#0]
;;;1189   
;;;1190     
;;;1191     if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
000fac  4844              LDR      r0,|L1.4288|
000fae  6800              LDR      r0,[r0,#0]  ; CardType
000fb0  2802              CMP      r0,#2
000fb2  d102              BNE      |L1.4026|
;;;1192     {
;;;1193       BlockSize = 512;
000fb4  f44f7500          MOV      r5,#0x200
;;;1194   #if SD_USE_SECTOR_ADDRESS
;;;1195   	ReadAddr = ReadAddr;
000fb8  bf00              NOP      
                  |L1.4026|
;;;1196   #else
;;;1197       ReadAddr /= 512;
;;;1198   #endif
;;;1199     }
;;;1200   
;;;1201     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
000fba  f04f30ff          MOV      r0,#0xffffffff
000fbe  493a              LDR      r1,|L1.4264|
000fc0  6008              STR      r0,[r1,#0]  ; SDIO_DataInitStructure
;;;1202     SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
000fc2  4608              MOV      r0,r1
000fc4  6045              STR      r5,[r0,#4]  ; SDIO_DataInitStructure
;;;1203     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) 9 << 4;
000fc6  f04f0090          MOV      r0,#0x90
000fca  6088              STR      r0,[r1,#8]  ; SDIO_DataInitStructure
;;;1204     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
000fcc  f04f0002          MOV      r0,#2
000fd0  60c8              STR      r0,[r1,#0xc]  ; SDIO_DataInitStructure
;;;1205     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
000fd2  f04f0000          MOV      r0,#0
000fd6  6108              STR      r0,[r1,#0x10]  ; SDIO_DataInitStructure
;;;1206     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
000fd8  f04f0001          MOV      r0,#1
000fdc  6148              STR      r0,[r1,#0x14]  ; SDIO_DataInitStructure
;;;1207     SDIO_DataConfig(&SDIO_DataInitStructure);
000fde  4608              MOV      r0,r1
000fe0  f7fffffe          BL       SDIO_DataConfig
;;;1208   
;;;1209     /*!< Send CMD17 READ_SINGLE_BLOCK */
;;;1210     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
000fe4  482f              LDR      r0,|L1.4260|
000fe6  6004              STR      r4,[r0,#0]  ; SDIO_CmdInitStructure
;;;1211     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_SINGLE_BLOCK;
000fe8  f04f0011          MOV      r0,#0x11
000fec  492d              LDR      r1,|L1.4260|
000fee  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;1212     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
000ff0  f04f0040          MOV      r0,#0x40
000ff4  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;1213     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
000ff6  f04f0000          MOV      r0,#0
000ffa  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;1214     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
000ffc  f44f6080          MOV      r0,#0x400
001000  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;1215     SDIO_SendCommand(&SDIO_CmdInitStructure);
001002  4608              MOV      r0,r1
001004  f7fffffe          BL       SDIO_SendCommand
;;;1216   
;;;1217     errorstatus = CmdResp1Error(SD_CMD_READ_SINGLE_BLOCK);
001008  2011              MOVS     r0,#0x11
00100a  f7fffffe          BL       CmdResp1Error
00100e  4606              MOV      r6,r0
;;;1218   
;;;1219     if (errorstatus != SD_OK)
001010  b116              CBZ      r6,|L1.4120|
;;;1220     {
;;;1221       return(errorstatus);
001012  4630              MOV      r0,r6
                  |L1.4116|
;;;1222     }
;;;1223   
;;;1224   #if defined (SD_POLLING_MODE)  
;;;1225     /*!< In case of single block transfer, no need of stop transfer at all.*/
;;;1226     /*!< Polling mode */
;;;1227     while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCKEND | SDIO_FLAG_STBITERR)))
;;;1228     {
;;;1229       if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
;;;1230       {
;;;1231         for (count = 0; count < 8; count++)
;;;1232         {
;;;1233           *(tempbuff + count) = SDIO_ReadData();
;;;1234         }
;;;1235         tempbuff += 8;
;;;1236       }
;;;1237     }
;;;1238   
;;;1239     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
;;;1240     {
;;;1241       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
;;;1242       errorstatus = SD_DATA_TIMEOUT;
;;;1243       return(errorstatus);
;;;1244     }
;;;1245     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
;;;1246     {
;;;1247       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
;;;1248       errorstatus = SD_DATA_CRC_FAIL;
;;;1249       return(errorstatus);
;;;1250     }
;;;1251     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
;;;1252     {
;;;1253       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
;;;1254       errorstatus = SD_RX_OVERRUN;
;;;1255       return(errorstatus);
;;;1256     }
;;;1257     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
;;;1258     {
;;;1259       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
;;;1260       errorstatus = SD_START_BIT_ERR;
;;;1261       return(errorstatus);
;;;1262     }
;;;1263     while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
;;;1264     {
;;;1265       *tempbuff = SDIO_ReadData();
;;;1266       tempbuff++;
;;;1267     }
;;;1268     
;;;1269     /*!< Clear all the static flags */
;;;1270     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;1271   
;;;1272   #elif defined (SD_DMA_MODE)
;;;1273   	#if SD_USE_INTERRUPT_ONCE
;;;1274   		BSP_EnableXferDMA((uint32_t *)readbuff, BlockSize, 0);
;;;1275   	#else
;;;1276   		SDIO_ITConfig(SDIO_IT_DATAEND, ENABLE);
;;;1277   		SDIO_DMACmd(ENABLE);
;;;1278   		SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, BlockSize);
;;;1279   	#endif
;;;1280   #endif
;;;1281   
;;;1282     return(errorstatus);
;;;1283   }
001014  e8bd81f0          POP      {r4-r8,pc}
                  |L1.4120|
001018  2200              MOVS     r2,#0                 ;1274
00101a  4629              MOV      r1,r5                 ;1274
00101c  4638              MOV      r0,r7                 ;1274
00101e  f7fffffe          BL       BSP_EnableXferDMA
001022  4630              MOV      r0,r6                 ;1282
001024  e7f6              B        |L1.4116|
;;;1284   
                          ENDP

                  SD_ReadMultiBlocks PROC
;;;1299     */
;;;1300   SD_Error SD_ReadMultiBlocks(uint8_t *readbuff, uint32_t ReadAddr, uint16_t BlockSize, uint32_t NumberOfBlocks)
001026  e92d41f0          PUSH     {r4-r8,lr}
;;;1301   {
00102a  4680              MOV      r8,r0
00102c  460d              MOV      r5,r1
00102e  4614              MOV      r4,r2
001030  461e              MOV      r6,r3
;;;1302     SD_Error errorstatus = SD_OK;
001032  f04f0700          MOV      r7,#0
;;;1303     TransferError = SD_OK;
001036  4638              MOV      r0,r7
001038  491d              LDR      r1,|L1.4272|
00103a  7008              STRB     r0,[r1,#0]
;;;1304     TransferEnd = 0;
00103c  491d              LDR      r1,|L1.4276|
00103e  6008              STR      r0,[r1,#0]  ; TransferEnd
;;;1305     StopCondition = 1;
001040  f04f0001          MOV      r0,#1
001044  491c              LDR      r1,|L1.4280|
001046  6008              STR      r0,[r1,#0]  ; StopCondition
;;;1306   	
;;;1307     SDIO->DCTRL = 0x0;
001048  f04f0000          MOV      r0,#0
00104c  491b              LDR      r1,|L1.4284|
00104e  6008              STR      r0,[r1,#0]
;;;1308   
;;;1309     if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
001050  481b              LDR      r0,|L1.4288|
001052  6800              LDR      r0,[r0,#0]  ; CardType
001054  2802              CMP      r0,#2
001056  d102              BNE      |L1.4190|
;;;1310     {
;;;1311       BlockSize = 512;
001058  f44f7400          MOV      r4,#0x200
;;;1312   #if SD_USE_SECTOR_ADDRESS
;;;1313   	ReadAddr = ReadAddr;
00105c  bf00              NOP      
                  |L1.4190|
;;;1314   #else
;;;1315       ReadAddr /= 512;
;;;1316   #endif
;;;1317     }
;;;1318   
;;;1319     /*!< Set Block Size for Card */
;;;1320     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
00105e  4811              LDR      r0,|L1.4260|
001060  6004              STR      r4,[r0,#0]  ; SDIO_CmdInitStructure
;;;1321     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
001062  f04f0010          MOV      r0,#0x10
001066  490f              LDR      r1,|L1.4260|
001068  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;1322     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
00106a  f04f0040          MOV      r0,#0x40
00106e  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;1323     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
001070  f04f0000          MOV      r0,#0
001074  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;1324     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
001076  f44f6080          MOV      r0,#0x400
00107a  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;1325     SDIO_SendCommand(&SDIO_CmdInitStructure);
00107c  4608              MOV      r0,r1
00107e  f7fffffe          BL       SDIO_SendCommand
;;;1326   
;;;1327     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
001082  2010              MOVS     r0,#0x10
001084  f7fffffe          BL       CmdResp1Error
001088  4607              MOV      r7,r0
;;;1328   
;;;1329     if (SD_OK != errorstatus)
00108a  b1df              CBZ      r7,|L1.4292|
;;;1330     {
;;;1331       return(errorstatus);
00108c  4638              MOV      r0,r7
;;;1332     }
;;;1333       
;;;1334     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
;;;1335     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
;;;1336     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) 9 << 4;
;;;1337     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
;;;1338     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
;;;1339     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
;;;1340     SDIO_DataConfig(&SDIO_DataInitStructure);
;;;1341   
;;;1342     /*!< Send CMD18 READ_MULT_BLOCK with argument data address */
;;;1343     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
;;;1344     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_MULT_BLOCK;
;;;1345     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1346     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1347     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1348     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1349   
;;;1350     errorstatus = CmdResp1Error(SD_CMD_READ_MULT_BLOCK);
;;;1351   
;;;1352     if (errorstatus != SD_OK)
;;;1353     {
;;;1354       return(errorstatus);
;;;1355     }
;;;1356   
;;;1357   	#if SD_USE_INTERRUPT_ONCE
;;;1358   		BSP_EnableXferDMA((uint32_t *)readbuff, (NumberOfBlocks * BlockSize), 0);
;;;1359   	#else
;;;1360   		SDIO_ITConfig(SDIO_IT_DATAEND, ENABLE);
;;;1361   		SDIO_DMACmd(ENABLE);
;;;1362   		SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, (NumberOfBlocks * BlockSize));
;;;1363   	#endif
;;;1364   
;;;1365     return(errorstatus);
;;;1366   }
00108e  e8bd81f0          POP      {r4-r8,pc}
001092  0000              DCW      0x0000
                  |L1.4244|
                          DCD      ||RCA||
                  |L1.4248|
                          DCD      0x40012c08
                  |L1.4252|
                          DCD      0x40012c14
                  |L1.4256|
                          DCD      0x40020400
                  |L1.4260|
                          DCD      SDIO_CmdInitStructure
                  |L1.4264|
                          DCD      SDIO_DataInitStructure
                  |L1.4268|
                          DCD      SDSTATUS_Tab
                  |L1.4272|
                          DCD      TransferError
                  |L1.4276|
                          DCD      TransferEnd
                  |L1.4280|
                          DCD      StopCondition
                  |L1.4284|
                          DCD      0x40012c2c
                  |L1.4288|
                          DCD      CardType
                  |L1.4292|
0010c4  f04f30ff          MOV      r0,#0xffffffff        ;1334
0010c8  49f8              LDR      r1,|L1.5292|
0010ca  6008              STR      r0,[r1,#0]            ;1334  ; SDIO_DataInitStructure
0010cc  fb06f004          MUL      r0,r6,r4              ;1335
0010d0  6048              STR      r0,[r1,#4]            ;1335  ; SDIO_DataInitStructure
0010d2  f04f0090          MOV      r0,#0x90              ;1336
0010d6  6088              STR      r0,[r1,#8]            ;1336  ; SDIO_DataInitStructure
0010d8  f04f0002          MOV      r0,#2                 ;1337
0010dc  60c8              STR      r0,[r1,#0xc]          ;1337  ; SDIO_DataInitStructure
0010de  f04f0000          MOV      r0,#0                 ;1338
0010e2  6108              STR      r0,[r1,#0x10]         ;1338  ; SDIO_DataInitStructure
0010e4  f04f0001          MOV      r0,#1                 ;1339
0010e8  6148              STR      r0,[r1,#0x14]         ;1339  ; SDIO_DataInitStructure
0010ea  4608              MOV      r0,r1                 ;1340
0010ec  f7fffffe          BL       SDIO_DataConfig
0010f0  48ef              LDR      r0,|L1.5296|
0010f2  6005              STR      r5,[r0,#0]            ;1343  ; SDIO_CmdInitStructure
0010f4  f04f0012          MOV      r0,#0x12              ;1344
0010f8  49ed              LDR      r1,|L1.5296|
0010fa  6048              STR      r0,[r1,#4]            ;1344  ; SDIO_CmdInitStructure
0010fc  f04f0040          MOV      r0,#0x40              ;1345
001100  6088              STR      r0,[r1,#8]            ;1345  ; SDIO_CmdInitStructure
001102  f04f0000          MOV      r0,#0                 ;1346
001106  60c8              STR      r0,[r1,#0xc]          ;1346  ; SDIO_CmdInitStructure
001108  f44f6080          MOV      r0,#0x400             ;1347
00110c  6108              STR      r0,[r1,#0x10]         ;1347  ; SDIO_CmdInitStructure
00110e  4608              MOV      r0,r1                 ;1348
001110  f7fffffe          BL       SDIO_SendCommand
001114  2012              MOVS     r0,#0x12              ;1350
001116  f7fffffe          BL       CmdResp1Error
00111a  4607              MOV      r7,r0                 ;1350
00111c  b117              CBZ      r7,|L1.4388|
00111e  4638              MOV      r0,r7                 ;1354
                  |L1.4384|
001120  e8bd81f0          POP      {r4-r8,pc}
                  |L1.4388|
001124  fb06f104          MUL      r1,r6,r4              ;1358
001128  2200              MOVS     r2,#0                 ;1358
00112a  4640              MOV      r0,r8                 ;1358
00112c  f7fffffe          BL       BSP_EnableXferDMA
001130  4638              MOV      r0,r7                 ;1365
001132  e7f5              B        |L1.4384|
;;;1367   
                          ENDP

                  SD_WaitReadOperation PROC
;;;1375     */
;;;1376   SD_Error SD_WaitReadOperation(void)
001134  b510              PUSH     {r4,lr}
;;;1377   {
;;;1378     SD_Error errorstatus = SD_OK;
001136  f04f0400          MOV      r4,#0
;;;1379   
;;;1380     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK))
00113a  bf00              NOP      
                  |L1.4412|
00113c  f7fffffe          BL       SD_DMAEndOfTransferStatus
001140  b930              CBNZ     r0,|L1.4432|
001142  48dc              LDR      r0,|L1.5300|
001144  6800              LDR      r0,[r0,#0]  ; TransferEnd
001146  b918              CBNZ     r0,|L1.4432|
001148  48db              LDR      r0,|L1.5304|
00114a  7800              LDRB     r0,[r0,#0]  ; TransferError
00114c  2800              CMP      r0,#0
00114e  d0f5              BEQ      |L1.4412|
                  |L1.4432|
;;;1381     {}
;;;1382   
;;;1383     if (TransferError != SD_OK)
001150  48d9              LDR      r0,|L1.5304|
001152  7800              LDRB     r0,[r0,#0]  ; TransferError
001154  b110              CBZ      r0,|L1.4444|
;;;1384     {
;;;1385       return(TransferError);
001156  48d8              LDR      r0,|L1.5304|
001158  7800              LDRB     r0,[r0,#0]  ; TransferError
                  |L1.4442|
;;;1386     }
;;;1387   
;;;1388     return(errorstatus);
;;;1389   }
00115a  bd10              POP      {r4,pc}
                  |L1.4444|
00115c  4620              MOV      r0,r4                 ;1388
00115e  e7fc              B        |L1.4442|
;;;1390   
                          ENDP

                  SD_WriteBlock PROC
;;;1405     */
;;;1406   SD_Error SD_WriteBlock(uint8_t *writebuff, uint32_t WriteAddr, uint16_t BlockSize)
001160  e92d41f0          PUSH     {r4-r8,lr}
;;;1407   {
001164  4607              MOV      r7,r0
001166  460c              MOV      r4,r1
001168  4615              MOV      r5,r2
;;;1408     SD_Error errorstatus = SD_OK;
00116a  f04f0600          MOV      r6,#0
;;;1409   
;;;1410   #if defined (SD_POLLING_MODE)
;;;1411     uint32_t bytestransferred = 0, count = 0, restwords = 0;
;;;1412     uint32_t *tempbuff = (uint32_t *)writebuff;
;;;1413   #endif
;;;1414   
;;;1415     TransferError = SD_OK;
00116e  4630              MOV      r0,r6
001170  49d1              LDR      r1,|L1.5304|
001172  7008              STRB     r0,[r1,#0]
;;;1416     TransferEnd = 0;
001174  49cf              LDR      r1,|L1.5300|
001176  6008              STR      r0,[r1,#0]  ; TransferEnd
;;;1417     StopCondition = 0;
001178  49d0              LDR      r1,|L1.5308|
00117a  6008              STR      r0,[r1,#0]  ; StopCondition
;;;1418     
;;;1419     SDIO->DCTRL = 0x0;
00117c  49d0              LDR      r1,|L1.5312|
00117e  6008              STR      r0,[r1,#0]
;;;1420   
;;;1421   
;;;1422     if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
001180  48d0              LDR      r0,|L1.5316|
001182  6800              LDR      r0,[r0,#0]  ; CardType
001184  2802              CMP      r0,#2
001186  d102              BNE      |L1.4494|
;;;1423     {
;;;1424       BlockSize = 512;
001188  f44f7500          MOV      r5,#0x200
;;;1425   #if SD_USE_SECTOR_ADDRESS
;;;1426   	WriteAddr = WriteAddr;
00118c  bf00              NOP      
                  |L1.4494|
;;;1427   #else
;;;1428       WriteAddr /= 512;
;;;1429   #endif
;;;1430     }
;;;1431     
;;;1432     /*!< Send CMD24 WRITE_SINGLE_BLOCK */
;;;1433     SDIO_CmdInitStructure.SDIO_Argument = WriteAddr;
00118e  48c8              LDR      r0,|L1.5296|
001190  6004              STR      r4,[r0,#0]  ; SDIO_CmdInitStructure
;;;1434     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_SINGLE_BLOCK;
001192  f04f0018          MOV      r0,#0x18
001196  49c6              LDR      r1,|L1.5296|
001198  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;1435     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
00119a  f04f0040          MOV      r0,#0x40
00119e  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;1436     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
0011a0  f04f0000          MOV      r0,#0
0011a4  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;1437     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
0011a6  f44f6080          MOV      r0,#0x400
0011aa  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;1438     SDIO_SendCommand(&SDIO_CmdInitStructure);
0011ac  4608              MOV      r0,r1
0011ae  f7fffffe          BL       SDIO_SendCommand
;;;1439   
;;;1440     errorstatus = CmdResp1Error(SD_CMD_WRITE_SINGLE_BLOCK);
0011b2  2018              MOVS     r0,#0x18
0011b4  f7fffffe          BL       CmdResp1Error
0011b8  4606              MOV      r6,r0
;;;1441   
;;;1442     if (errorstatus != SD_OK)
0011ba  b116              CBZ      r6,|L1.4546|
;;;1443     {
;;;1444       return(errorstatus);
0011bc  4630              MOV      r0,r6
                  |L1.4542|
;;;1445     }
;;;1446   
;;;1447     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
;;;1448     SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
;;;1449     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) 9 << 4;
;;;1450     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
;;;1451     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
;;;1452     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
;;;1453     SDIO_DataConfig(&SDIO_DataInitStructure);
;;;1454   
;;;1455     /*!< In case of single data block transfer no need of stop command at all */
;;;1456   #if defined (SD_POLLING_MODE) 
;;;1457     while (!(SDIO->STA & (SDIO_FLAG_DBCKEND | SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_STBITERR)))
;;;1458     {
;;;1459       if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
;;;1460       {
;;;1461         if ((512 - bytestransferred) < 32)
;;;1462         {
;;;1463           restwords = ((512 - bytestransferred) % 4 == 0) ? ((512 - bytestransferred) / 4) : (( 512 -  bytestransferred) / 4 + 1);
;;;1464           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
;;;1465           {
;;;1466             SDIO_WriteData(*tempbuff);
;;;1467           }
;;;1468         }
;;;1469         else
;;;1470         {
;;;1471           for (count = 0; count < 8; count++)
;;;1472           {
;;;1473             SDIO_WriteData(*(tempbuff + count));
;;;1474           }
;;;1475           tempbuff += 8;
;;;1476           bytestransferred += 32;
;;;1477         }
;;;1478       }
;;;1479     }
;;;1480     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
;;;1481     {
;;;1482       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
;;;1483       errorstatus = SD_DATA_TIMEOUT;
;;;1484       return(errorstatus);
;;;1485     }
;;;1486     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
;;;1487     {
;;;1488       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
;;;1489       errorstatus = SD_DATA_CRC_FAIL;
;;;1490       return(errorstatus);
;;;1491     }
;;;1492     else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
;;;1493     {
;;;1494       SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
;;;1495       errorstatus = SD_TX_UNDERRUN;
;;;1496       return(errorstatus);
;;;1497     }
;;;1498     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
;;;1499     {
;;;1500       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
;;;1501       errorstatus = SD_START_BIT_ERR;
;;;1502       return(errorstatus);
;;;1503     }
;;;1504   #elif defined (SD_DMA_MODE)
;;;1505   	#if SD_USE_INTERRUPT_ONCE
;;;1506   		BSP_EnableXferDMA((uint32_t *)writebuff, BlockSize, 1);
;;;1507   	#else
;;;1508   		SDIO_ITConfig(SDIO_IT_DATAEND, ENABLE);
;;;1509   		SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, BlockSize);
;;;1510   		SDIO_DMACmd(ENABLE);
;;;1511   	#endif
;;;1512   #endif
;;;1513   
;;;1514     return(errorstatus);
;;;1515   }
0011be  e8bd81f0          POP      {r4-r8,pc}
                  |L1.4546|
0011c2  f04f30ff          MOV      r0,#0xffffffff        ;1447
0011c6  49b9              LDR      r1,|L1.5292|
0011c8  6008              STR      r0,[r1,#0]            ;1447  ; SDIO_DataInitStructure
0011ca  4608              MOV      r0,r1                 ;1448
0011cc  6045              STR      r5,[r0,#4]            ;1448  ; SDIO_DataInitStructure
0011ce  f04f0090          MOV      r0,#0x90              ;1449
0011d2  6088              STR      r0,[r1,#8]            ;1449  ; SDIO_DataInitStructure
0011d4  f04f0000          MOV      r0,#0                 ;1450
0011d8  60c8              STR      r0,[r1,#0xc]          ;1450  ; SDIO_DataInitStructure
0011da  6108              STR      r0,[r1,#0x10]         ;1451  ; SDIO_DataInitStructure
0011dc  f04f0001          MOV      r0,#1                 ;1452
0011e0  6148              STR      r0,[r1,#0x14]         ;1452  ; SDIO_DataInitStructure
0011e2  4608              MOV      r0,r1                 ;1453
0011e4  f7fffffe          BL       SDIO_DataConfig
0011e8  2201              MOVS     r2,#1                 ;1506
0011ea  4629              MOV      r1,r5                 ;1506
0011ec  4638              MOV      r0,r7                 ;1506
0011ee  f7fffffe          BL       BSP_EnableXferDMA
0011f2  4630              MOV      r0,r6                 ;1514
0011f4  e7e3              B        |L1.4542|
;;;1516   
                          ENDP

                  SD_WriteMultiBlocks PROC
;;;1531     */
;;;1532   SD_Error SD_WriteMultiBlocks(uint8_t *writebuff, uint32_t WriteAddr, uint16_t BlockSize, uint32_t NumberOfBlocks)
0011f6  e92d41f0          PUSH     {r4-r8,lr}
;;;1533   {
0011fa  4680              MOV      r8,r0
0011fc  460e              MOV      r6,r1
0011fe  4617              MOV      r7,r2
001200  461c              MOV      r4,r3
;;;1534     SD_Error errorstatus = SD_OK;
001202  f04f0500          MOV      r5,#0
;;;1535   
;;;1536     TransferError = SD_OK;
001206  4628              MOV      r0,r5
001208  49ab              LDR      r1,|L1.5304|
00120a  7008              STRB     r0,[r1,#0]
;;;1537     TransferEnd = 0;
00120c  49a9              LDR      r1,|L1.5300|
00120e  6008              STR      r0,[r1,#0]  ; TransferEnd
;;;1538     StopCondition = 1;
001210  f04f0001          MOV      r0,#1
001214  49a9              LDR      r1,|L1.5308|
001216  6008              STR      r0,[r1,#0]  ; StopCondition
;;;1539     
;;;1540     SDIO->DCTRL = 0x0;
001218  f04f0000          MOV      r0,#0
00121c  49a8              LDR      r1,|L1.5312|
00121e  6008              STR      r0,[r1,#0]
;;;1541   
;;;1542     if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
001220  48a8              LDR      r0,|L1.5316|
001222  6800              LDR      r0,[r0,#0]  ; CardType
001224  2802              CMP      r0,#2
001226  d102              BNE      |L1.4654|
;;;1543     {
;;;1544       BlockSize = 512;
001228  f44f7700          MOV      r7,#0x200
;;;1545   #if SD_USE_SECTOR_ADDRESS
;;;1546   	WriteAddr = WriteAddr;
00122c  bf00              NOP      
                  |L1.4654|
;;;1547   #else
;;;1548       WriteAddr /= 512;
;;;1549   #endif
;;;1550     }
;;;1551   
;;;1552     /*!< To improve performance */
;;;1553     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
00122e  48a6              LDR      r0,|L1.5320|
001230  6800              LDR      r0,[r0,#0]  ; RCA
001232  ea4f4000          LSL      r0,r0,#16
001236  499e              LDR      r1,|L1.5296|
001238  6008              STR      r0,[r1,#0]  ; SDIO_CmdInitStructure
;;;1554     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
00123a  f04f0037          MOV      r0,#0x37
00123e  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;1555     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
001240  f04f0040          MOV      r0,#0x40
001244  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;1556     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
001246  f04f0000          MOV      r0,#0
00124a  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;1557     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
00124c  f44f6080          MOV      r0,#0x400
001250  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;1558     SDIO_SendCommand(&SDIO_CmdInitStructure);
001252  4608              MOV      r0,r1
001254  f7fffffe          BL       SDIO_SendCommand
;;;1559   
;;;1560   
;;;1561     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
001258  2037              MOVS     r0,#0x37
00125a  f7fffffe          BL       CmdResp1Error
00125e  4605              MOV      r5,r0
;;;1562   
;;;1563     if (errorstatus != SD_OK)
001260  b115              CBZ      r5,|L1.4712|
;;;1564     {
;;;1565       return(errorstatus);
001262  4628              MOV      r0,r5
                  |L1.4708|
;;;1566     }
;;;1567     /*!< To improve performance */
;;;1568     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)NumberOfBlocks;
;;;1569     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCK_COUNT;
;;;1570     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1571     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1572     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1573     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1574   
;;;1575     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCK_COUNT);
;;;1576   
;;;1577     if (errorstatus != SD_OK)
;;;1578     {
;;;1579       return(errorstatus);
;;;1580     }
;;;1581   
;;;1582   
;;;1583     /*!< Send CMD25 WRITE_MULT_BLOCK with argument data address */
;;;1584     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)WriteAddr;
;;;1585     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_MULT_BLOCK;
;;;1586     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1587     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1588     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1589     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1590   
;;;1591     errorstatus = CmdResp1Error(SD_CMD_WRITE_MULT_BLOCK);
;;;1592   
;;;1593     if (SD_OK != errorstatus)
;;;1594     {
;;;1595       return(errorstatus);
;;;1596     }
;;;1597   
;;;1598     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
;;;1599     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
;;;1600     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) 9 << 4;
;;;1601     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
;;;1602     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
;;;1603     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
;;;1604     SDIO_DataConfig(&SDIO_DataInitStructure);
;;;1605   
;;;1606   	#if SD_USE_INTERRUPT_ONCE
;;;1607   		BSP_EnableXferDMA((uint32_t *)writebuff, (NumberOfBlocks * BlockSize), 1);
;;;1608   	#else
;;;1609   		SDIO_ITConfig(SDIO_IT_DATAEND, ENABLE);
;;;1610   		SDIO_DMACmd(ENABLE);    
;;;1611   		SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, (NumberOfBlocks * BlockSize));
;;;1612   	#endif
;;;1613   
;;;1614     return(errorstatus);
;;;1615   }
001264  e8bd81f0          POP      {r4-r8,pc}
                  |L1.4712|
001268  4891              LDR      r0,|L1.5296|
00126a  6004              STR      r4,[r0,#0]            ;1568  ; SDIO_CmdInitStructure
00126c  f04f0017          MOV      r0,#0x17              ;1569
001270  498f              LDR      r1,|L1.5296|
001272  6048              STR      r0,[r1,#4]            ;1569  ; SDIO_CmdInitStructure
001274  f04f0040          MOV      r0,#0x40              ;1570
001278  6088              STR      r0,[r1,#8]            ;1570  ; SDIO_CmdInitStructure
00127a  f04f0000          MOV      r0,#0                 ;1571
00127e  60c8              STR      r0,[r1,#0xc]          ;1571  ; SDIO_CmdInitStructure
001280  f44f6080          MOV      r0,#0x400             ;1572
001284  6108              STR      r0,[r1,#0x10]         ;1572  ; SDIO_CmdInitStructure
001286  4608              MOV      r0,r1                 ;1573
001288  f7fffffe          BL       SDIO_SendCommand
00128c  2017              MOVS     r0,#0x17              ;1575
00128e  f7fffffe          BL       CmdResp1Error
001292  4605              MOV      r5,r0                 ;1575
001294  b10d              CBZ      r5,|L1.4762|
001296  4628              MOV      r0,r5                 ;1579
001298  e7e4              B        |L1.4708|
                  |L1.4762|
00129a  4885              LDR      r0,|L1.5296|
00129c  6006              STR      r6,[r0,#0]            ;1584  ; SDIO_CmdInitStructure
00129e  f04f0019          MOV      r0,#0x19              ;1585
0012a2  4983              LDR      r1,|L1.5296|
0012a4  6048              STR      r0,[r1,#4]            ;1585  ; SDIO_CmdInitStructure
0012a6  f04f0040          MOV      r0,#0x40              ;1586
0012aa  6088              STR      r0,[r1,#8]            ;1586  ; SDIO_CmdInitStructure
0012ac  f04f0000          MOV      r0,#0                 ;1587
0012b0  60c8              STR      r0,[r1,#0xc]          ;1587  ; SDIO_CmdInitStructure
0012b2  f44f6080          MOV      r0,#0x400             ;1588
0012b6  6108              STR      r0,[r1,#0x10]         ;1588  ; SDIO_CmdInitStructure
0012b8  4608              MOV      r0,r1                 ;1589
0012ba  f7fffffe          BL       SDIO_SendCommand
0012be  2019              MOVS     r0,#0x19              ;1591
0012c0  f7fffffe          BL       CmdResp1Error
0012c4  4605              MOV      r5,r0                 ;1591
0012c6  b10d              CBZ      r5,|L1.4812|
0012c8  4628              MOV      r0,r5                 ;1595
0012ca  e7cb              B        |L1.4708|
                  |L1.4812|
0012cc  f04f30ff          MOV      r0,#0xffffffff        ;1598
0012d0  4976              LDR      r1,|L1.5292|
0012d2  6008              STR      r0,[r1,#0]            ;1598  ; SDIO_DataInitStructure
0012d4  fb04f007          MUL      r0,r4,r7              ;1599
0012d8  6048              STR      r0,[r1,#4]            ;1599  ; SDIO_DataInitStructure
0012da  f04f0090          MOV      r0,#0x90              ;1600
0012de  6088              STR      r0,[r1,#8]            ;1600  ; SDIO_DataInitStructure
0012e0  f04f0000          MOV      r0,#0                 ;1601
0012e4  60c8              STR      r0,[r1,#0xc]          ;1601  ; SDIO_DataInitStructure
0012e6  6108              STR      r0,[r1,#0x10]         ;1602  ; SDIO_DataInitStructure
0012e8  f04f0001          MOV      r0,#1                 ;1603
0012ec  6148              STR      r0,[r1,#0x14]         ;1603  ; SDIO_DataInitStructure
0012ee  4608              MOV      r0,r1                 ;1604
0012f0  f7fffffe          BL       SDIO_DataConfig
0012f4  fb04f107          MUL      r1,r4,r7              ;1607
0012f8  2201              MOVS     r2,#1                 ;1607
0012fa  4640              MOV      r0,r8                 ;1607
0012fc  f7fffffe          BL       BSP_EnableXferDMA
001300  4628              MOV      r0,r5                 ;1614
001302  e7af              B        |L1.4708|
;;;1616   
                          ENDP

                  SD_WaitWriteOperation PROC
;;;1624     */
;;;1625   SD_Error SD_WaitWriteOperation(void)
001304  b510              PUSH     {r4,lr}
;;;1626   {
;;;1627     SD_Error errorstatus = SD_OK;
001306  f04f0400          MOV      r4,#0
;;;1628   
;;;1629     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK))
00130a  bf00              NOP      
                  |L1.4876|
00130c  f7fffffe          BL       SD_DMAEndOfTransferStatus
001310  b930              CBNZ     r0,|L1.4896|
001312  4868              LDR      r0,|L1.5300|
001314  6800              LDR      r0,[r0,#0]  ; TransferEnd
001316  b918              CBNZ     r0,|L1.4896|
001318  4867              LDR      r0,|L1.5304|
00131a  7800              LDRB     r0,[r0,#0]  ; TransferError
00131c  2800              CMP      r0,#0
00131e  d0f5              BEQ      |L1.4876|
                  |L1.4896|
;;;1630     {}
;;;1631   
;;;1632     if (TransferError != SD_OK)
001320  4865              LDR      r0,|L1.5304|
001322  7800              LDRB     r0,[r0,#0]  ; TransferError
001324  b110              CBZ      r0,|L1.4908|
;;;1633     {
;;;1634       return(TransferError);
001326  4864              LDR      r0,|L1.5304|
001328  7800              LDRB     r0,[r0,#0]  ; TransferError
                  |L1.4906|
;;;1635     }
;;;1636   
;;;1637     /*!< Clear all the static flags */
;;;1638     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;1639   
;;;1640     return(errorstatus);
;;;1641   }
00132a  bd10              POP      {r4,pc}
                  |L1.4908|
00132c  f24050ff          MOV      r0,#0x5ff             ;1638
001330  f7fffffe          BL       SDIO_ClearFlag
001334  4620              MOV      r0,r4                 ;1640
001336  e7f8              B        |L1.4906|
;;;1642   
                          ENDP

                  SD_GetTransferState PROC
;;;1651     */
;;;1652   SDTransferState SD_GetTransferState(void)
001338  4861              LDR      r0,|L1.5312|
;;;1653   {
;;;1654     if (SDIO->STA & (SDIO_FLAG_TXACT | SDIO_FLAG_RXACT))
00133a  3008              ADDS     r0,r0,#8
00133c  6800              LDR      r0,[r0,#0]
00133e  f4105f40          TST      r0,#0x3000
001342  d001              BEQ      |L1.4936|
;;;1655     {
;;;1656       return(SD_TRANSFER_BUSY);
001344  2001              MOVS     r0,#1
                  |L1.4934|
;;;1657     }
;;;1658     else
;;;1659     {
;;;1660       return(SD_TRANSFER_OK);
;;;1661     }
;;;1662   }
001346  4770              BX       lr
                  |L1.4936|
001348  2000              MOVS     r0,#0                 ;1660
00134a  e7fc              B        |L1.4934|
;;;1663   
                          ENDP

                  SD_StopTransfer PROC
;;;1668     */
;;;1669   SD_Error SD_StopTransfer(void)
00134c  b500              PUSH     {lr}
;;;1670   {
;;;1671     SD_Error errorstatus = SD_OK;
00134e  f04f0300          MOV      r3,#0
;;;1672   
;;;1673     /*!< Send CMD12 STOP_TRANSMISSION  */
;;;1674     SDIO->ARG = 0x0;
001352  4618              MOV      r0,r3
001354  495d              LDR      r1,|L1.5324|
001356  6008              STR      r0,[r1,#0]
;;;1675     SDIO->CMD = 0x44C;
001358  f240404c          MOV      r0,#0x44c
00135c  f1010104          ADD      r1,r1,#4
001360  6008              STR      r0,[r1,#0]
;;;1676     errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
001362  f04f000c          MOV      r0,#0xc
001366  f7fffffe          BL       CmdResp1Error
00136a  4603              MOV      r3,r0
;;;1677   
;;;1678     return(errorstatus);
00136c  4618              MOV      r0,r3
;;;1679   }
00136e  bd00              POP      {pc}
;;;1680   
                          ENDP

                  IsCardProgramming PROC
;;;2281     */
;;;2282   static SD_Error IsCardProgramming(uint8_t *pstatus)
001370  e92d41f0          PUSH     {r4-r8,lr}
;;;2283   {
001374  4606              MOV      r6,r0
;;;2284     SD_Error errorstatus = SD_OK;
001376  f04f0700          MOV      r7,#0
;;;2285     __IO uint32_t respR1 = 0, status = 0;
00137a  463c              MOV      r4,r7
00137c  4625              MOV      r5,r4
;;;2286   
;;;2287     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
00137e  4852              LDR      r0,|L1.5320|
001380  6800              LDR      r0,[r0,#0]  ; RCA
001382  ea4f4000          LSL      r0,r0,#16
001386  494a              LDR      r1,|L1.5296|
001388  6008              STR      r0,[r1,#0]  ; SDIO_CmdInitStructure
;;;2288     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
00138a  f04f000d          MOV      r0,#0xd
00138e  6048              STR      r0,[r1,#4]  ; SDIO_CmdInitStructure
;;;2289     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
001390  f04f0040          MOV      r0,#0x40
001394  6088              STR      r0,[r1,#8]  ; SDIO_CmdInitStructure
;;;2290     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
001396  f04f0000          MOV      r0,#0
00139a  60c8              STR      r0,[r1,#0xc]  ; SDIO_CmdInitStructure
;;;2291     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
00139c  f44f6080          MOV      r0,#0x400
0013a0  6108              STR      r0,[r1,#0x10]  ; SDIO_CmdInitStructure
;;;2292     SDIO_SendCommand(&SDIO_CmdInitStructure);
0013a2  4608              MOV      r0,r1
0013a4  f7fffffe          BL       SDIO_SendCommand
;;;2293   
;;;2294     status = SDIO->STA;
0013a8  4849              LDR      r0,|L1.5328|
0013aa  6805              LDR      r5,[r0,#0]
;;;2295     while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
0013ac  e001              B        |L1.5042|
                  |L1.5038|
;;;2296     {
;;;2297       status = SDIO->STA;
0013ae  4848              LDR      r0,|L1.5328|
0013b0  6805              LDR      r5,[r0,#0]
                  |L1.5042|
0013b2  f0150f45          TST      r5,#0x45              ;2295
0013b6  d0fa              BEQ      |L1.5038|
;;;2298     }
;;;2299   
;;;2300     if (status & SDIO_FLAG_CTIMEOUT)
0013b8  f0150f04          TST      r5,#4
0013bc  d008              BEQ      |L1.5072|
;;;2301     {
;;;2302       errorstatus = SD_CMD_RSP_TIMEOUT;
0013be  f04f0703          MOV      r7,#3
;;;2303       SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
0013c2  f04f0004          MOV      r0,#4
0013c6  f7fffffe          BL       SDIO_ClearFlag
;;;2304       return(errorstatus);
0013ca  4638              MOV      r0,r7
                  |L1.5068|
;;;2305     }
;;;2306     else if (status & SDIO_FLAG_CCRCFAIL)
;;;2307     {
;;;2308       errorstatus = SD_CMD_CRC_FAIL;
;;;2309       SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
;;;2310       return(errorstatus);
;;;2311     }
;;;2312   
;;;2313     status = (uint32_t)SDIO_GetCommandResponse();
;;;2314   
;;;2315     /*!< Check response received is of desired command */
;;;2316     if (status != SD_CMD_SEND_STATUS)
;;;2317     {
;;;2318       errorstatus = SD_ILLEGAL_CMD;
;;;2319       return(errorstatus);
;;;2320     }
;;;2321   
;;;2322     /*!< Clear all the static flags */
;;;2323     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
;;;2324   
;;;2325   
;;;2326     /*!< We have received response, retrieve it for analysis  */
;;;2327     respR1 = SDIO_GetResponse(SDIO_RESP1);
;;;2328   
;;;2329     /*!< Find out card status */
;;;2330     *pstatus = (uint8_t) ((respR1 >> 9) & 0x0000000F);
;;;2331   
;;;2332     if ((respR1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
;;;2333     {
;;;2334       return(errorstatus);
;;;2335     }
;;;2336   
;;;2337     if (respR1 & SD_OCR_ADDR_OUT_OF_RANGE)
;;;2338     {
;;;2339       return(SD_ADDR_OUT_OF_RANGE);
;;;2340     }
;;;2341   
;;;2342     if (respR1 & SD_OCR_ADDR_MISALIGNED)
;;;2343     {
;;;2344       return(SD_ADDR_MISALIGNED);
;;;2345     }
;;;2346   
;;;2347     if (respR1 & SD_OCR_BLOCK_LEN_ERR)
;;;2348     {
;;;2349       return(SD_BLOCK_LEN_ERR);
;;;2350     }
;;;2351   
;;;2352     if (respR1 & SD_OCR_ERASE_SEQ_ERR)
;;;2353     {
;;;2354       return(SD_ERASE_SEQ_ERR);
;;;2355     }
;;;2356   
;;;2357     if (respR1 & SD_OCR_BAD_ERASE_PARAM)
;;;2358     {
;;;2359       return(SD_BAD_ERASE_PARAM);
;;;2360     }
;;;2361   
;;;2362     if (respR1 & SD_OCR_WRITE_PROT_VIOLATION)
;;;2363     {
;;;2364       return(SD_WRITE_PROT_VIOLATION);
;;;2365     }
;;;2366   
;;;2367     if (respR1 & SD_OCR_LOCK_UNLOCK_FAILED)
;;;2368     {
;;;2369       return(SD_LOCK_UNLOCK_FAILED);
;;;2370     }
;;;2371   
;;;2372     if (respR1 & SD_OCR_COM_CRC_FAILED)
;;;2373     {
;;;2374       return(SD_COM_CRC_FAILED);
;;;2375     }
;;;2376   
;;;2377     if (respR1 & SD_OCR_ILLEGAL_CMD)
;;;2378     {
;;;2379       return(SD_ILLEGAL_CMD);
;;;2380     }
;;;2381   
;;;2382     if (respR1 & SD_OCR_CARD_ECC_FAILED)
;;;2383     {
;;;2384       return(SD_CARD_ECC_FAILED);
;;;2385     }
;;;2386   
;;;2387     if (respR1 & SD_OCR_CC_ERROR)
;;;2388     {
;;;2389       return(SD_CC_ERROR);
;;;2390     }
;;;2391   
;;;2392     if (respR1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
;;;2393     {
;;;2394       return(SD_GENERAL_UNKNOWN_ERROR);
;;;2395     }
;;;2396   
;;;2397     if (respR1 & SD_OCR_STREAM_READ_UNDERRUN)
;;;2398     {
;;;2399       return(SD_STREAM_READ_UNDERRUN);
;;;2400     }
;;;2401   
;;;2402     if (respR1 & SD_OCR_STREAM_WRITE_OVERRUN)
;;;2403     {
;;;2404       return(SD_STREAM_WRITE_OVERRUN);
;;;2405     }
;;;2406   
;;;2407     if (respR1 & SD_OCR_CID_CSD_OVERWRIETE)
;;;2408     {
;;;2409       return(SD_CID_CSD_OVERWRITE);
;;;2410     }
;;;2411   
;;;2412     if (respR1 & SD_OCR_WP_ERASE_SKIP)
;;;2413     {
;;;2414       return(SD_WP_ERASE_SKIP);
;;;2415     }
;;;2416   
;;;2417     if (respR1 & SD_OCR_CARD_ECC_DISABLED)
;;;2418     {
;;;2419       return(SD_CARD_ECC_DISABLED);
;;;2420     }
;;;2421   
;;;2422     if (respR1 & SD_OCR_ERASE_RESET)
;;;2423     {
;;;2424       return(SD_ERASE_RESET);
;;;2425     }
;;;2426   
;;;2427     if (respR1 & SD_OCR_AKE_SEQ_ERROR)
;;;2428     {
;;;2429       return(SD_AKE_SEQ_ERROR);
;;;2430     }
;;;2431   
;;;2432     return(errorstatus);
;;;2433   }
0013cc  e8bd81f0          POP      {r4-r8,pc}
                  |L1.5072|
0013d0  f0150f01          TST      r5,#1                 ;2306
0013d4  d006              BEQ      |L1.5092|
0013d6  f04f0701          MOV      r7,#1                 ;2308
0013da  4638              MOV      r0,r7                 ;2309
0013dc  f7fffffe          BL       SDIO_ClearFlag
0013e0  4638              MOV      r0,r7                 ;2310
0013e2  e7f3              B        |L1.5068|
                  |L1.5092|
0013e4  f7fffffe          BL       SDIO_GetCommandResponse
0013e8  4605              MOV      r5,r0                 ;2313
0013ea  2d0d              CMP      r5,#0xd               ;2316
0013ec  d003              BEQ      |L1.5110|
0013ee  f04f0710          MOV      r7,#0x10              ;2318
0013f2  4638              MOV      r0,r7                 ;2319
0013f4  e7ea              B        |L1.5068|
                  |L1.5110|
0013f6  f24050ff          MOV      r0,#0x5ff             ;2323
0013fa  f7fffffe          BL       SDIO_ClearFlag
0013fe  2000              MOVS     r0,#0                 ;2327
001400  f7fffffe          BL       SDIO_GetResponse
001404  4604              MOV      r4,r0                 ;2327
001406  f3c42043          UBFX     r0,r4,#9,#4           ;2330
00140a  7030              STRB     r0,[r6,#0]            ;2330
00140c  4831              LDR      r0,|L1.5332|
00140e  4204              TST      r4,r0                 ;2332
001410  d101              BNE      |L1.5142|
001412  4638              MOV      r0,r7                 ;2334
001414  e7da              B        |L1.5068|
                  |L1.5142|
001416  f0144f00          TST      r4,#0x80000000        ;2337
00141a  d001              BEQ      |L1.5152|
00141c  201c              MOVS     r0,#0x1c              ;2339
00141e  e7d5              B        |L1.5068|
                  |L1.5152|
001420  f0144f80          TST      r4,#0x40000000        ;2342
001424  d001              BEQ      |L1.5162|
001426  2009              MOVS     r0,#9                 ;2344
001428  e7d0              B        |L1.5068|
                  |L1.5162|
00142a  f0145f00          TST      r4,#0x20000000        ;2347
00142e  d001              BEQ      |L1.5172|
001430  200a              MOVS     r0,#0xa               ;2349
001432  e7cb              B        |L1.5068|
                  |L1.5172|
001434  f0145f80          TST      r4,#0x10000000        ;2352
001438  d001              BEQ      |L1.5182|
00143a  200b              MOVS     r0,#0xb               ;2354
00143c  e7c6              B        |L1.5068|
                  |L1.5182|
00143e  f0146f00          TST      r4,#0x8000000         ;2357
001442  d001              BEQ      |L1.5192|
001444  200c              MOVS     r0,#0xc               ;2359
001446  e7c1              B        |L1.5068|
                  |L1.5192|
001448  f0146f80          TST      r4,#0x4000000         ;2362
00144c  d001              BEQ      |L1.5202|
00144e  200d              MOVS     r0,#0xd               ;2364
001450  e7bc              B        |L1.5068|
                  |L1.5202|
001452  f0147f80          TST      r4,#0x1000000         ;2367
001456  d001              BEQ      |L1.5212|
001458  200e              MOVS     r0,#0xe               ;2369
00145a  e7b7              B        |L1.5068|
                  |L1.5212|
00145c  f4140f00          TST      r4,#0x800000          ;2372
001460  d001              BEQ      |L1.5222|
001462  200f              MOVS     r0,#0xf               ;2374
001464  e7b2              B        |L1.5068|
                  |L1.5222|
001466  f4140f80          TST      r4,#0x400000          ;2377
00146a  d001              BEQ      |L1.5232|
00146c  2010              MOVS     r0,#0x10              ;2379
00146e  e7ad              B        |L1.5068|
                  |L1.5232|
001470  f4141f00          TST      r4,#0x200000          ;2382
001474  d001              BEQ      |L1.5242|
001476  2011              MOVS     r0,#0x11              ;2384
001478  e7a8              B        |L1.5068|
                  |L1.5242|
00147a  f4141f80          TST      r4,#0x100000          ;2387
00147e  d001              BEQ      |L1.5252|
001480  2012              MOVS     r0,#0x12              ;2389
001482  e7a3              B        |L1.5068|
                  |L1.5252|
001484  f4142f00          TST      r4,#0x80000           ;2392
001488  d001              BEQ      |L1.5262|
00148a  2013              MOVS     r0,#0x13              ;2394
00148c  e79e              B        |L1.5068|
                  |L1.5262|
00148e  f4142f80          TST      r4,#0x40000           ;2397
001492  d001              BEQ      |L1.5272|
001494  2014              MOVS     r0,#0x14              ;2399
001496  e799              B        |L1.5068|
                  |L1.5272|
001498  f4143f00          TST      r4,#0x20000           ;2402
00149c  d001              BEQ      |L1.5282|
00149e  2015              MOVS     r0,#0x15              ;2404
0014a0  e794              B        |L1.5068|
                  |L1.5282|
0014a2  f4143f80          TST      r4,#0x10000           ;2407
0014a6  d017              BEQ      |L1.5336|
0014a8  2016              MOVS     r0,#0x16              ;2409
0014aa  e78f              B        |L1.5068|
                  |L1.5292|
                          DCD      SDIO_DataInitStructure
                  |L1.5296|
                          DCD      SDIO_CmdInitStructure
                  |L1.5300|
                          DCD      TransferEnd
                  |L1.5304|
                          DCD      TransferError
                  |L1.5308|
                          DCD      StopCondition
                  |L1.5312|
                          DCD      0x40012c2c
                  |L1.5316|
                          DCD      CardType
                  |L1.5320|
                          DCD      ||RCA||
                  |L1.5324|
                          DCD      0x40012c08
                  |L1.5328|
                          DCD      0x40012c34
                  |L1.5332|
                          DCD      0xfdffe008
                  |L1.5336|
0014d8  f4144f00          TST      r4,#0x8000            ;2412
0014dc  d001              BEQ      |L1.5346|
0014de  2017              MOVS     r0,#0x17              ;2414
0014e0  e774              B        |L1.5068|
                  |L1.5346|
0014e2  f4144f80          TST      r4,#0x4000            ;2417
0014e6  d001              BEQ      |L1.5356|
0014e8  2018              MOVS     r0,#0x18              ;2419
0014ea  e76f              B        |L1.5068|
                  |L1.5356|
0014ec  f4145f00          TST      r4,#0x2000            ;2422
0014f0  d001              BEQ      |L1.5366|
0014f2  2019              MOVS     r0,#0x19              ;2424
0014f4  e76a              B        |L1.5068|
                  |L1.5366|
0014f6  f0140f08          TST      r4,#8                 ;2427
0014fa  d001              BEQ      |L1.5376|
0014fc  201a              MOVS     r0,#0x1a              ;2429
0014fe  e765              B        |L1.5068|
                  |L1.5376|
001500  4638              MOV      r0,r7                 ;2432
001502  e763              B        |L1.5068|
;;;2434   
                          ENDP

                  SD_Erase PROC
;;;1686     */
;;;1687   SD_Error SD_Erase(uint32_t startaddr, uint32_t endaddr)
001504  e92d43f8          PUSH     {r3-r9,lr}
;;;1688   {
001508  4605              MOV      r5,r0
00150a  460e              MOV      r6,r1
;;;1689     SD_Error errorstatus = SD_OK;
00150c  f04f0400          MOV      r4,#0
;;;1690     uint32_t delay = 0;
001510  4627              MOV      r7,r4
;;;1691     __IO uint32_t maxdelay = 0;
001512  46a0              MOV      r8,r4
;;;1692     uint8_t cardstate = 0;
001514  4620              MOV      r0,r4
001516  9000              STR      r0,[sp,#0]
;;;1693   
;;;1694     /*!< Check if the card coomnd class supports erase command */
;;;1695     if (((CSD_Tab[1] >> 20) & SD_CCCC_ERASE) == 0)
001518  4865              LDR      r0,|L1.5808|
00151a  6840              LDR      r0,[r0,#4]  ; CSD_Tab
00151c  f04f0120          MOV      r1,#0x20
001520  ea115f10          TST      r1,r0,LSR #20
001524  d104              BNE      |L1.5424|
;;;1696     {
;;;1697       errorstatus = SD_REQUEST_NOT_APPLICABLE;
001526  f04f0425          MOV      r4,#0x25
;;;1698       return(errorstatus);
00152a  4620              MOV      r0,r4
                  |L1.5420|
;;;1699     }
;;;1700   
;;;1701     maxdelay = 120000 / ((SDIO->CLKCR & 0xFF) + 2);
;;;1702   
;;;1703     if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
;;;1704     {
;;;1705       errorstatus = SD_LOCK_UNLOCK_FAILED;
;;;1706       return(errorstatus);
;;;1707     }
;;;1708   
;;;1709     if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
;;;1710     {
;;;1711   #if SD_USE_SECTOR_ADDRESS
;;;1712   	startaddr /= 1;
;;;1713       endaddr /= 1;
;;;1714   #else
;;;1715       startaddr /= 512;
;;;1716       endaddr /= 512;
;;;1717   #endif
;;;1718       
;;;1719     }
;;;1720     
;;;1721     /*!< According to sd-card spec 1.0 ERASE_GROUP_START (CMD32) and erase_group_end(CMD33) */
;;;1722     if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
;;;1723     {
;;;1724       /*!< Send CMD32 SD_ERASE_GRP_START with argument as addr  */
;;;1725       SDIO_CmdInitStructure.SDIO_Argument = startaddr;
;;;1726       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_START;
;;;1727       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1728       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1729       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1730       SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1731   
;;;1732       errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_START);
;;;1733       if (errorstatus != SD_OK)
;;;1734       {
;;;1735         return(errorstatus);
;;;1736       }
;;;1737   
;;;1738       /*!< Send CMD33 SD_ERASE_GRP_END with argument as addr  */
;;;1739       SDIO_CmdInitStructure.SDIO_Argument = endaddr;
;;;1740       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_END;
;;;1741       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1742       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1743       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1744       SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1745   
;;;1746       errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_END);
;;;1747       if (errorstatus != SD_OK)
;;;1748       {
;;;1749         return(errorstatus);
;;;1750       }
;;;1751     }
;;;1752   
;;;1753     /*!< Send CMD38 ERASE */
;;;1754     SDIO_CmdInitStructure.SDIO_Argument = 0;
;;;1755     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ERASE;
;;;1756     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
;;;1757     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
;;;1758     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
;;;1759     SDIO_SendCommand(&SDIO_CmdInitStructure);
;;;1760   
;;;1761     errorstatus = CmdResp1Error(SD_CMD_ERASE);
;;;1762   
;;;1763     if (errorstatus != SD_OK)
;;;1764     {
;;;1765       return(errorstatus);
;;;1766     }
;;;1767   
;;;1768     for (delay = 0; delay < maxdelay; delay++)
;;;1769     {}
;;;1770   
;;;1771     /*!< Wait till the card is in programming state */
;;;1772     errorstatus = IsCardProgramming(&cardstate);
;;;1773   
;;;1774     while ((errorstatus == SD_OK) && ((SD_CARD_PROGRAMMING == cardstate) || (SD_CARD_RECEIVING == cardstate)))
;;;1775     {
;;;1776       errorstatus = IsCardProgramming(&cardstate);
;;;1777     }
;;;1778   
;;;1779     return(errorstatus);
;;;1780   }
00152c  e8bd83f8          POP      {r3-r9,pc}
                  |L1.5424|
001530  4860              LDR      r0,|L1.5812|
001532  6800              LDR      r0,[r0,#0]            ;1701
001534  b2c0              UXTB     r0,r0                 ;1701
001536  f1000002          ADD      r0,r0,#2              ;1701
00153a  495f              LDR      r1,|L1.5816|
00153c  fbb1f8f0          UDIV     r8,r1,r0              ;1701
001540  f04f0000          MOV      r0,#0                 ;1703
001544  f7fffffe          BL       SDIO_GetResponse
001548  f0107f00          TST      r0,#0x2000000         ;1703
00154c  d003              BEQ      |L1.5462|
00154e  f04f040e          MOV      r4,#0xe               ;1705
001552  4620              MOV      r0,r4                 ;1706
001554  e7ea              B        |L1.5420|
                  |L1.5462|
001556  4859              LDR      r0,|L1.5820|
001558  6800              LDR      r0,[r0,#0]            ;1709  ; CardType
00155a  2802              CMP      r0,#2                 ;1709
00155c  d101              BNE      |L1.5474|
00155e  bf00              NOP                            ;1712
001560  bf00              NOP                            ;1713
                  |L1.5474|
001562  4856              LDR      r0,|L1.5820|
001564  6800              LDR      r0,[r0,#0]            ;1722  ; CardType
001566  b138              CBZ      r0,|L1.5496|
001568  4854              LDR      r0,|L1.5820|
00156a  6800              LDR      r0,[r0,#0]            ;1722  ; CardType
00156c  2801              CMP      r0,#1                 ;1722
00156e  d003              BEQ      |L1.5496|
001570  4852              LDR      r0,|L1.5820|
001572  6800              LDR      r0,[r0,#0]            ;1722  ; CardType
001574  2802              CMP      r0,#2                 ;1722
001576  d131              BNE      |L1.5596|
                  |L1.5496|
001578  4851              LDR      r0,|L1.5824|
00157a  6005              STR      r5,[r0,#0]            ;1725  ; SDIO_CmdInitStructure
00157c  f04f0020          MOV      r0,#0x20              ;1726
001580  494f              LDR      r1,|L1.5824|
001582  6048              STR      r0,[r1,#4]            ;1726  ; SDIO_CmdInitStructure
001584  f04f0040          MOV      r0,#0x40              ;1727
001588  6088              STR      r0,[r1,#8]            ;1727  ; SDIO_CmdInitStructure
00158a  f04f0000          MOV      r0,#0                 ;1728
00158e  60c8              STR      r0,[r1,#0xc]          ;1728  ; SDIO_CmdInitStructure
001590  f44f6080          MOV      r0,#0x400             ;1729
001594  6108              STR      r0,[r1,#0x10]         ;1729  ; SDIO_CmdInitStructure
001596  4608              MOV      r0,r1                 ;1730
001598  f7fffffe          BL       SDIO_SendCommand
00159c  2020              MOVS     r0,#0x20              ;1732
00159e  f7fffffe          BL       CmdResp1Error
0015a2  4604              MOV      r4,r0                 ;1732
0015a4  b10c              CBZ      r4,|L1.5546|
0015a6  4620              MOV      r0,r4                 ;1735
0015a8  e7c0              B        |L1.5420|
                  |L1.5546|
0015aa  4845              LDR      r0,|L1.5824|
0015ac  6006              STR      r6,[r0,#0]            ;1739  ; SDIO_CmdInitStructure
0015ae  f04f0021          MOV      r0,#0x21              ;1740
0015b2  4943              LDR      r1,|L1.5824|
0015b4  6048              STR      r0,[r1,#4]            ;1740  ; SDIO_CmdInitStructure
0015b6  f04f0040          MOV      r0,#0x40              ;1741
0015ba  6088              STR      r0,[r1,#8]            ;1741  ; SDIO_CmdInitStructure
0015bc  f04f0000          MOV      r0,#0                 ;1742
0015c0  60c8              STR      r0,[r1,#0xc]          ;1742  ; SDIO_CmdInitStructure
0015c2  f44f6080          MOV      r0,#0x400             ;1743
0015c6  6108              STR      r0,[r1,#0x10]         ;1743  ; SDIO_CmdInitStructure
0015c8  4608              MOV      r0,r1                 ;1744
0015ca  f7fffffe          BL       SDIO_SendCommand
0015ce  2021              MOVS     r0,#0x21              ;1746
0015d0  f7fffffe          BL       CmdResp1Error
0015d4  4604              MOV      r4,r0                 ;1746
0015d6  b10c              CBZ      r4,|L1.5596|
0015d8  4620              MOV      r0,r4                 ;1749
0015da  e7a7              B        |L1.5420|
                  |L1.5596|
0015dc  f04f0000          MOV      r0,#0                 ;1754
0015e0  4937              LDR      r1,|L1.5824|
0015e2  6008              STR      r0,[r1,#0]            ;1754  ; SDIO_CmdInitStructure
0015e4  f04f0026          MOV      r0,#0x26              ;1755
0015e8  6048              STR      r0,[r1,#4]            ;1755  ; SDIO_CmdInitStructure
0015ea  f04f0040          MOV      r0,#0x40              ;1756
0015ee  6088              STR      r0,[r1,#8]            ;1756  ; SDIO_CmdInitStructure
0015f0  f04f0000          MOV      r0,#0                 ;1757
0015f4  60c8              STR      r0,[r1,#0xc]          ;1757  ; SDIO_CmdInitStructure
0015f6  f44f6080          MOV      r0,#0x400             ;1758
0015fa  6108              STR      r0,[r1,#0x10]         ;1758  ; SDIO_CmdInitStructure
0015fc  4608              MOV      r0,r1                 ;1759
0015fe  f7fffffe          BL       SDIO_SendCommand
001602  2026              MOVS     r0,#0x26              ;1761
001604  f7fffffe          BL       CmdResp1Error
001608  4604              MOV      r4,r0                 ;1761
00160a  b10c              CBZ      r4,|L1.5648|
00160c  4620              MOV      r0,r4                 ;1765
00160e  e78d              B        |L1.5420|
                  |L1.5648|
001610  f04f0700          MOV      r7,#0                 ;1768
001614  e001              B        |L1.5658|
                  |L1.5654|
001616  f1070701          ADD      r7,r7,#1              ;1768
                  |L1.5658|
00161a  4547              CMP      r7,r8                 ;1768
00161c  d3fb              BCC      |L1.5654|
00161e  4668              MOV      r0,sp                 ;1772
001620  f7fffffe          BL       IsCardProgramming
001624  4604              MOV      r4,r0                 ;1772
001626  e003              B        |L1.5680|
                  |L1.5672|
001628  4668              MOV      r0,sp                 ;1776
00162a  f7fffffe          BL       IsCardProgramming
00162e  4604              MOV      r4,r0                 ;1776
                  |L1.5680|
001630  b93c              CBNZ     r4,|L1.5698|
001632  f89d0000          LDRB     r0,[sp,#0]            ;1774
001636  2807              CMP      r0,#7                 ;1774
001638  d0f6              BEQ      |L1.5672|
00163a  f89d0000          LDRB     r0,[sp,#0]            ;1774
00163e  2806              CMP      r0,#6                 ;1774
001640  d0f2              BEQ      |L1.5672|
                  |L1.5698|
001642  4620              MOV      r0,r4                 ;1779
001644  e772              B        |L1.5420|
;;;1781   
                          ENDP

                  SD_ProcessIRQSrc PROC
;;;1927     */
;;;1928   SD_Error SD_ProcessIRQSrc(void)
001646  b510              PUSH     {r4,lr}
;;;1929   {
;;;1930     if (StopCondition == 1)
001648  481e              LDR      r0,|L1.5828|
00164a  6800              LDR      r0,[r0,#0]  ; StopCondition
00164c  2801              CMP      r0,#1
00164e  d10f              BNE      |L1.5744|
;;;1931     {
;;;1932       SDIO->ARG = 0x0;
001650  f04f0000          MOV      r0,#0
001654  491c              LDR      r1,|L1.5832|
001656  6008              STR      r0,[r1,#0]
;;;1933       SDIO->CMD = 0x44C;
001658  f240404c          MOV      r0,#0x44c
00165c  f1010104          ADD      r1,r1,#4
001660  6008              STR      r0,[r1,#0]
;;;1934       TransferError = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
001662  f04f000c          MOV      r0,#0xc
001666  f7fffffe          BL       CmdResp1Error
00166a  4918              LDR      r1,|L1.5836|
00166c  7008              STRB     r0,[r1,#0]
00166e  e003              B        |L1.5752|
                  |L1.5744|
;;;1935     }
;;;1936     else
;;;1937     {
;;;1938       TransferError = SD_OK;
001670  f04f0000          MOV      r0,#0
001674  4915              LDR      r1,|L1.5836|
001676  7008              STRB     r0,[r1,#0]
                  |L1.5752|
;;;1939     }
;;;1940     SDIO_ClearITPendingBit(SDIO_IT_DATAEND);
001678  f44f7080          MOV      r0,#0x100
00167c  f7fffffe          BL       SDIO_ClearITPendingBit
;;;1941     SDIO_ITConfig(SDIO_IT_DATAEND, DISABLE);
001680  2100              MOVS     r1,#0
001682  f44f7080          MOV      r0,#0x100
001686  f7fffffe          BL       SDIO_ITConfig
;;;1942     TransferEnd = 1;
00168a  f04f0001          MOV      r0,#1
00168e  4910              LDR      r1,|L1.5840|
001690  6008              STR      r0,[r1,#0]  ; TransferEnd
;;;1943     return(TransferError);
001692  480e              LDR      r0,|L1.5836|
001694  7800              LDRB     r0,[r0,#0]  ; TransferError
;;;1944   }
001696  bd10              POP      {r4,pc}
;;;1945   
                          ENDP

                  convert_from_bytes_to_power_of_two PROC
;;;2549     */
;;;2550   uint8_t convert_from_bytes_to_power_of_two(uint16_t NumberOfBytes)
001698  4601              MOV      r1,r0
;;;2551   {
;;;2552     uint8_t count = 0;
00169a  f04f0000          MOV      r0,#0
;;;2553   
;;;2554     while (NumberOfBytes != 1)
00169e  e004              B        |L1.5802|
                  |L1.5792|
;;;2555     {
;;;2556       NumberOfBytes >>= 1;
0016a0  ea4f0161          ASR      r1,r1,#1
;;;2557       count++;
0016a4  f1000201          ADD      r2,r0,#1
0016a8  b2d0              UXTB     r0,r2
                  |L1.5802|
0016aa  2901              CMP      r1,#1                 ;2554
0016ac  d1f8              BNE      |L1.5792|
;;;2558     }
;;;2559     return(count);
;;;2560   }
0016ae  4770              BX       lr
;;;2561   
                          ENDP

                  |L1.5808|
                          DCD      CSD_Tab
                  |L1.5812|
                          DCD      0x40012c04
                  |L1.5816|
                          DCD      0x0001d4c0
                  |L1.5820|
                          DCD      CardType
                  |L1.5824|
                          DCD      SDIO_CmdInitStructure
                  |L1.5828|
                          DCD      StopCondition
                  |L1.5832|
                          DCD      0x40012c08
                  |L1.5836|
                          DCD      TransferError
                  |L1.5840|
                          DCD      TransferEnd

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  CSD_Tab
                          %        16
                  CID_Tab
                          %        16
                  SDSTATUS_Tab
                          %        16
                  SDCardInfo
                          %        80
                  SDIO_InitStructure
                          %        24
                  SDIO_CmdInitStructure
                          %        20
                  SDIO_DataInitStructure
                          %        24

                          AREA ||.data||, DATA, ALIGN=2

                  CardType
                          DCD      0x00000000
                  ||RCA||
                          DCD      0x00000000
                  StopCondition
                          DCD      0x00000000
                  TransferError
00000c  00000000          DCB      0x00,0x00,0x00,0x00
                  TransferEnd
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\BSP\\bsp_sd.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___8_bsp_sd_c_70335e9e____REV16|
#line 112 "..\\BSP\\CMSIS\\core_cmInstr.h"
|__asm___8_bsp_sd_c_70335e9e____REV16| PROC
#line 113

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___8_bsp_sd_c_70335e9e____REVSH|
#line 130
|__asm___8_bsp_sd_c_70335e9e____REVSH| PROC
#line 131

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
